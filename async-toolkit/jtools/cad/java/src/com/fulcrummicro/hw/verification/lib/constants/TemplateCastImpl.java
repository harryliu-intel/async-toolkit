// Autogenerated Jamon implementation
// /nfs/site/disks/wdisk.53/kedunckl/p4wd/reg-main-1/shared/java/src/./com/fulcrummicro/hw/verification/lib/constants/TemplateCast.jamon

package com.fulcrummicro.hw.verification.lib.constants;

// 2, 1
import java.util.Collection;
// 3, 1
import com.fulcrummicro.util.misc.Utility;
// 4, 1
import com.fulcrummicro.hw.verification.lib.constants.*;
// 5, 1
import com.fulcrummicro.hw.verification.lib.constants.ConstantsChannelField.ConstantsChannelFieldType;

public class TemplateCastImpl
  extends org.jamon.AbstractTemplateImpl
  implements com.fulcrummicro.hw.verification.lib.constants.TemplateCast.Intf

{
  private final Constants constants;
  protected static com.fulcrummicro.hw.verification.lib.constants.TemplateCast.ImplData __jamon_setOptionalArguments(com.fulcrummicro.hw.verification.lib.constants.TemplateCast.ImplData p_implData)
  {
    return p_implData;
  }
  public TemplateCastImpl(org.jamon.TemplateManager p_templateManager, com.fulcrummicro.hw.verification.lib.constants.TemplateCast.ImplData p_implData)
  {
    super(p_templateManager, __jamon_setOptionalArguments(p_implData));
    constants = p_implData.getConstants();
  }
  
  public void renderNoFlush(final java.io.Writer jamonWriter)
    throws java.io.IOException
  {
    // 11, 1
    Collection<ConstantsCell> cells = constants.cells.values(); 
    // 11, 70
    jamonWriter.write("/* INTEL TOP SECRET\n * Copyright ");
    // 13, 14
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(java.util.Calendar.getInstance().get(java.util.Calendar.YEAR)), jamonWriter);
    // 13, 81
    jamonWriter.write(" Intel Corporation. All Rights Reserved.\n * $Id:  $\n * DO NOT EDIT! Automatically generated from constant xml.  */\nmodule ");
    // 16, 8
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(constants.getModule()), jamonWriter);
    // 16, 35
    jamonWriter.write(";\n\n");
    // 18, 1
    for (Constants c : constants.getImports() )
    {
      // 18, 46
      jamonWriter.write("import ");
      // 19, 8
      org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(c.getModule()), jamonWriter);
      // 19, 27
      jamonWriter.write(".*;\n");
    }
    // 20, 8
    jamonWriter.write("\n");
    // 22, 1
    for (ConstantsCell cell : cells )
    {
      // 22, 36
      jamonWriter.write("define ");
      // 23, 8
      org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(cell.name,true)), jamonWriter);
      // 23, 59
      jamonWriter.write("()() attributes {");
      // 23, 76
      org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(cell.getCastDescription()), jamonWriter);
      // 23, 107
      jamonWriter.write("\n");
      // 24, 1
      for (ConstantsConstant c : cell.constants )
      {
        // 24, 46
        jamonWriter.write("  int ");
        // 25, 7
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-21s", c.getName())), jamonWriter);
        // 25, 48
        jamonWriter.write(" = ");
        // 25, 51
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%5d", c.getValue())), jamonWriter);
        // 25, 91
        jamonWriter.write(";");
        // 25, 92
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(c.getCastDescription()), jamonWriter);
        // 25, 120
        jamonWriter.write("\n");
      }
      // 26, 8
      jamonWriter.write("\n");
      // 28, 1
      for (ConstantsEnum e : cell.enums )
      {
        // 28, 38
        jamonWriter.write("  // Enum ");
        // 29, 11
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(e.getName()), jamonWriter);
        // 29, 28
        jamonWriter.write(": ");
        // 29, 30
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(e.getDescription()), jamonWriter);
        // 29, 54
        jamonWriter.write("\n");
        // 30, 1
        for (ConstantsEnumValue c : e.values )
        {
          // 30, 41
          jamonWriter.write("  int ");
          // 31, 7
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-20s", c.getFullName())), jamonWriter);
          // 31, 52
          jamonWriter.write(" = ");
          // 31, 55
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%5d", c.getEncoding())), jamonWriter);
          // 31, 98
          jamonWriter.write(";");
          // 31, 99
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(c.getCastDescription()), jamonWriter);
          // 31, 127
          jamonWriter.write("\n");
        }
      }
      // 35, 1
      for (ConstantsChannel channel : cell.channels )
      {
        // 35, 50
        jamonWriter.write("  int ");
        // 36, 7
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format(" W_%-18s", channel.getName())), jamonWriter);
        // 36, 57
        jamonWriter.write(" = ");
        // 36, 60
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%5d", channel.getWidth())), jamonWriter);
        // 36, 106
        jamonWriter.write(";\n  int ");
        // 37, 7
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("WD_%-18s", channel.getName())), jamonWriter);
        // 37, 57
        jamonWriter.write(" = ");
        // 37, 60
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%5d", (int)Math.ceil(channel.getWidth()/2.0))), jamonWriter);
        // 37, 126
        jamonWriter.write(";\n");
      }
      // 39, 1
      if (!cell.channels.isEmpty() )
      {
        // 39, 33
        jamonWriter.write("  csp {\n");
        // 41, 1
        for (ConstantsChannel channel : cell.channels )
        {
          // 41, 50
          jamonWriter.write("    structure ");
          // 42, 15
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(channel.getName(),true)), jamonWriter);
          // 42, 74
          jamonWriter.write(" = (\n");
          // 43, 1
          for (ConstantsChannelField f : channel.fields.descendingSet() )
          {
            // 43, 66
            jamonWriter.write("      ");
            // 44, 7
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastFullTypeString()), jamonWriter);
            // 44, 38
            jamonWriter.write(" ");
            // 45, 1
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-15s", f.getName().toLowerCase() + (f.getArray()>1 ?  String.format("[%d];", f.getArray()) : ";"))), jamonWriter);
            // 46, 1
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastDescription()), jamonWriter);
            // 46, 29
            jamonWriter.write("\n");
          }
          // 47, 8
          jamonWriter.write("    );");
          // 48, 7
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(channel.getCastDescription()), jamonWriter);
          // 48, 41
          jamonWriter.write("\n\n");
        }
        // 50, 8
        jamonWriter.write("  }\n");
      }
      // 52, 7
      jamonWriter.write("}\n");
    }
    // 55, 25
    jamonWriter.write("\n");
    // 57, 1
    for (ConstantsCell cell : cells )
    {
      // 57, 36
      for (ConstantsChannel channel : cell.channels )
      {
        // 58, 1
        if (channel.getType() == null )
        {
          // 58, 34
          jamonWriter.write("defchan ");
          // 59, 9
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(channel.getName(),true)), jamonWriter);
          // 59, 68
          jamonWriter.write("()(\n");
          // 60, 1
          for (ConstantsChannelField f : channel.fields.descendingSet() )
          {
            // 60, 66
            jamonWriter.write("  ");
            // 61, 3
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastDefchanTypeString()), jamonWriter);
            // 61, 37
            jamonWriter.write(" ");
            // 62, 1
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-15s", f.getDirection() + f.getName() + (f.getArray()>1 ?  String.format("[0..%d];", f.getArray()-1) : ";"))), jamonWriter);
            // 63, 1
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastDescription()), jamonWriter);
            // 63, 29
            jamonWriter.write("\n");
          }
          // 64, 8
          jamonWriter.write(") {}\n");
        }
      }
    }
    // 67, 32
    jamonWriter.write("\n");
    // 69, 1
    for (ConstantsCell cell : cells )
    {
      // 69, 36
      for (ConstantsChannel channel : cell.channels )
      {
        // 70, 1
        if ((channel.getType() == null) && channel.isSingleDirection() )
        {
          // 71, 1
          {
            // 71, 1
            __jamon_innerUnit__source_sink(jamonWriter, channel, "rsource", "+" );
          }
          // 72, 1
          {
            // 72, 1
            __jamon_innerUnit__source_sink(jamonWriter, channel, "bitbucket", "-" );
          }
        }
      }
    }
  }
  
  
  // 76, 1
  private void __jamon_innerUnit__source_sink(final java.io.Writer jamonWriter, final ConstantsChannel channel, final String name, final String dir)
    throws java.io.IOException
  {
    // 77, 66
    jamonWriter.write("define ");
    // 78, 8
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(name), jamonWriter);
    // 78, 18
    jamonWriter.write("_");
    // 78, 19
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(channel.getName(),true)), jamonWriter);
    // 78, 78
    jamonWriter.write("()(");
    // 78, 81
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(channel.getName(),true)), jamonWriter);
    // 78, 140
    jamonWriter.write(" ");
    // 78, 141
    org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(dir), jamonWriter);
    // 78, 150
    jamonWriter.write("X) {\n  subcells {\n");
    // 80, 1
    for (ConstantsChannelField f : channel.fields.descendingSet() )
    {
      // 81, 1
      if (f.getType() != ConstantsChannelFieldType.NODE )
      {
        // 81, 54
        jamonWriter.write("    ");
        // 82, 5
        if (f.getArray()>1 )
        {
          // 82, 27
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf("<i:"), jamonWriter);
          // 82, 38
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getArray()), jamonWriter);
          // 82, 56
          jamonWriter.write(": ");
        }
        // 83, 1
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(name), jamonWriter);
        // 83, 11
        jamonWriter.write("_");
        // 83, 12
        if (f.getCastDefchanNumChannels() >1 )
        {
          // 83, 52
          jamonWriter.write("N_");
        }
        // 83, 60
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastDefchanTypeString().replace('[','(').replace(']',')')), jamonWriter);
        // 83, 128
        jamonWriter.write(" _(X.");
        // 83, 133
        org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getName()), jamonWriter);
        // 84, 1
        if (f.getArray()>1 )
        {
          // 84, 23
          jamonWriter.write("[i");
          // 84, 25
          if (f.getCastDefchanNumChannels() >1 )
          {
            // 84, 65
            jamonWriter.write(",0..");
            // 84, 69
            org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(f.getCastDefchanNumChannels()-1), jamonWriter);
          }
          // 84, 112
          jamonWriter.write("]");
        }
        // 84, 119
        jamonWriter.write(");");
        // 86, 1
        if (f.getArray()>1 )
        {
          // 86, 23
          org.jamon.escaping.Escaping.NONE.write(org.jamon.emit.StandardEmitter.valueOf(">"), jamonWriter);
        }
        // 86, 38
        jamonWriter.write("\n");
      }
    }
    // 88, 8
    jamonWriter.write("  }\n}\n");
  }
  
  
}

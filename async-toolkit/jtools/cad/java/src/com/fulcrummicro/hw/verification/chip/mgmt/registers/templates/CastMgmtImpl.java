// Autogenerated Jamon implementation
// C:/Users/mhesseli/Documents/Perforce/rrc-4/reg-main/shared/java/src/./com/fulcrummicro/hw/verification/chip/mgmt/registers/templates/CastMgmt.jamon

package com.fulcrummicro.hw.verification.chip.mgmt.registers.templates;

// 3, 1
import java.util.Collection;
// 4, 1
import com.fulcrummicro.util.misc.Utility;
// 5, 1
import com.fulcrummicro.hw.verification.chip.mgmt.registers.*;

public class CastMgmtImpl
  extends com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl
  implements com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmt.Intf

{
  private final Collection<RegisterBase> bases;
  private final Collection<Register> regs;
  private final String chip;
  protected static com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmt.ImplData __jamon_setOptionalArguments(com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmt.ImplData p_implData)
  {
    com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl.__jamon_setOptionalArguments(p_implData);
    return p_implData;
  }
  public CastMgmtImpl(org.jamon.TemplateManager p_templateManager, com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmt.ImplData p_implData)
  {
    super(p_templateManager, __jamon_setOptionalArguments(p_implData));
    bases = p_implData.getBases();
    regs = p_implData.getRegs();
    chip = p_implData.getChip();
  }
  
  @Override protected void child_render_2(final java.io.Writer jamonWriter)
    throws java.io.IOException
  {
    // 11, 9
    jamonWriter.write("module chip.");
    // 12, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 12, 23
    jamonWriter.write(".base.register_mgmt;\n\nimport chip.");
    // 14, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 14, 23
    jamonWriter.write(".base.functions.*;\nimport chip.");
    // 15, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 15, 23
    jamonWriter.write(".base.registers.*;\nimport chip.");
    // 16, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 16, 23
    jamonWriter.write(".mgmt.base.MgmtIfCell;\n\n");
    // 18, 1
    for (RegisterBase base : bases )
    {
      // 18, 35
      jamonWriter.write("\n");
      // 19, 1
      String camelCaseBaseName = Utility.underscoreToCamelCase(base.getName(), true);
Collection<Register> registers = base.getRegisters(); 
      // 21, 1
      jamonWriter.write("define ");
      // 21, 8
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
      // 21, 31
      jamonWriter.write("Management() attributes\n  <+ ");
      // 22, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
      // 22, 29
      jamonWriter.write("RegisterFields\n  <+ AddressSpace <+ MgmtIfCell <+ RegisterFunctions {\n  csp {\n");
      // 26, 1
      {
        // 26, 1
        __jamon_innerUnit__registerStructure(jamonWriter, registers, camelCaseBaseName );
      }
      // 26, 82
      jamonWriter.write("\n\n");
      // 30, 1
      {
        com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam __jamon__var_0 = new com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam(this.getTemplateManager());
        __jamon__var_0.renderNoFlush(jamonWriter, base, registers, camelCaseBaseName );
      }
      // 30, 91
      jamonWriter.write("\n    function rw");
      // 33, 16
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
      // 33, 39
      jamonWriter.write("Registers(int(1) -rw; int -addr; int -+data;\n                               ");
      // 34, 32
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
      // 34, 55
      jamonWriter.write("Registers -+s) = (\n      int reg;              // packed register value\n      int(32) i, i0, i1, i2, word, offset;  // indices\n      #[regRange(addr, ");
      // 37, 24
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getFullName()), jamonWriter);
      // 37, 48
      jamonWriter.write(", ");
      // 37, 50
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getName()), jamonWriter);
      // 37, 70
      jamonWriter.write("_SIZE, offset) ->\n        #[");
      // 39, 1
      boolean first = true; 
      // 40, 14
      for (Register reg : base.getRegisters() )
      {
        // 40, 57
        if (reg.getAlias() == null )
        {
          // 41, 1
          String index; 
          // 42, 1
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(first ? "" : "        []"), jamonWriter);
          // 42, 32
          first=false; 
          // 43, 18
          if (reg.getNumEntries() == 1 )
          {
            // 43, 75
            jamonWriter.write("addrMatch(offset,\n              ");
            // 45, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 45, 34
            jamonWriter.write("_ADDR,\n              ");
            // 46, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 46, 34
            jamonWriter.write("_BITS,\n              word) ->\n");
            // 48, 1
            index = ""; 
          }
          // 49, 18
          else if (reg.getNumEntries1() == 1 )
          {
            // 49, 55
            jamonWriter.write("addrMatch1D(offset,\n              ");
            // 51, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 51, 34
            jamonWriter.write("_BASE,\n              ");
            // 52, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 52, 34
            jamonWriter.write("_ENTRIES,\n              ");
            // 53, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 53, 34
            jamonWriter.write("_STRIDE,\n              ");
            // 54, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 54, 34
            jamonWriter.write("_BITS,\n              i, word) ->\n");
            // 56, 1
            index = "[i]"; 
          }
          // 57, 18
          else if (reg.getNumEntries2() == 1 )
          {
            // 57, 55
            jamonWriter.write("addrMatch2D(offset,\n              ");
            // 59, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 59, 34
            jamonWriter.write("_BASE,\n              ");
            // 60, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 60, 34
            jamonWriter.write("_ENTRIES_0,\n              ");
            // 61, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 61, 34
            jamonWriter.write("_ENTRIES_1,\n              ");
            // 62, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 62, 34
            jamonWriter.write("_STRIDE_0,\n              ");
            // 63, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 63, 34
            jamonWriter.write("_STRIDE_1,\n              ");
            // 64, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 64, 34
            jamonWriter.write("_BITS,\n              i0, i1, word) ->\n");
            // 66, 1
            index = "[i1, i0]"; 
          }
          // 67, 18
          else
          {
            // 67, 25
            jamonWriter.write("addrMatch3D(offset,\n              ");
            // 69, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 69, 34
            jamonWriter.write("_BASE,\n              ");
            // 70, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 70, 34
            jamonWriter.write("_ENTRIES_0,\n              ");
            // 71, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 71, 34
            jamonWriter.write("_ENTRIES_1,\n              ");
            // 72, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 72, 34
            jamonWriter.write("_ENTRIES_2,\n              ");
            // 73, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 73, 34
            jamonWriter.write("_STRIDE_0,\n              ");
            // 74, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 74, 34
            jamonWriter.write("_STRIDE_1,\n              ");
            // 75, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 75, 34
            jamonWriter.write("_STRIDE_2,\n              ");
            // 76, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 76, 34
            jamonWriter.write("_BITS,\n              i0, i1, i2, word) ->\n");
            // 78, 1
            index = "[i2, i1, i0]"; 
          }
          // 81, 18
          if (reg.isStructure() )
          {
            // 81, 43
            jamonWriter.write("            reg = pack(s::");
            // 82, 27
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
            // 82, 60
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
            // 82, 71
            jamonWriter.write(");\n");
          }
          // 83, 24
          jamonWriter.write("            regReadWrite(rw, word,\n              ");
          // 85, 15
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 85, 34
          jamonWriter.write("_ATOMIC_WIDTH,\n              ");
          // 86, 15
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 86, 34
          jamonWriter.write("_RW_MASK | ");
          // 86, 45
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 86, 64
          jamonWriter.write("_RV_MASK,\n              ");
          // 87, 15
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 87, 34
          jamonWriter.write("_RO_MASK,\n              ");
          // 88, 15
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 88, 34
          jamonWriter.write("_CW_MASK,\n              ");
          // 89, 15
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          // 89, 34
          jamonWriter.write("_CW1_MASK,\n              data, ");
          // 90, 21
          if (reg.isStructure() )
          {
            // 90, 46
            jamonWriter.write("reg");
          }
          // 90, 49
          else
          {
            // 90, 56
            jamonWriter.write("s::");
            // 90, 59
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
            // 90, 92
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
          }
          // 90, 109
          jamonWriter.write(");\n");
          // 91, 18
          if (reg.isStructure() )
          {
            // 91, 43
            jamonWriter.write("            unpack(s::");
            // 92, 23
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
            // 92, 56
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
            // 92, 67
            jamonWriter.write(", reg)\n");
          }
        }
      }
      // 94, 27
      jamonWriter.write("        ]\n      ]\n    );\n\n");
      // 100, 1
      {
        // 100, 1
        __jamon_innerUnit__registerInit(jamonWriter, registers, camelCaseBaseName );
      }
      // 100, 77
      jamonWriter.write("\n  }\n}\n");
    }
    // 104, 8
    jamonWriter.write("\n\n\n");
  }
  
  
}

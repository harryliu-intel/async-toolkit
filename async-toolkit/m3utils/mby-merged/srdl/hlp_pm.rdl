// INTEL TOP SECRET
// Copyright 2014 Intel Corporation. All Rights Reserved.
//
`include "hlp_udp.rdl"
<% use security; %>
<% my %Security_Props = security::GetSecurityInfo(); %>

`include "hlp_shell_ctl.rdl"

reg pm_mgmt_ctrl_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG3'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG3_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG3_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Management Access Control Register.";
  desc = "This register is used for backdoor mgmt access into the Packet Memory. Backdoor read or 
          write is launched by writing to this register. ";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RO/V";
    desc = "Indicates that the mgmt command has been executed. The hardware will clear this bit 
            when this register is written and will set it to 1 when the mgmt command has been executed.
            If this bit is set:
              On a write: The data stored in PM_MGMT_WRITE command will have 
              been written to the target memory bank.
              On a read: A read access will have been launched and the result 
              captured in the PM_MGMT_READ register. ";
    ValRandomize = false;
  } EXECUTED[21:21] = 1'h00;

  field {
    AccessType = "RW";
    desc = "Backdoor read/write command. (Read=0, Write=1)";
    ValRandomize = true;
  } RW[20:20] = 1'h00;

  field {
    AccessType = "RW";
    desc = "Which particular memory bank to access for a given address. The
            256 datapath is split into 32 8B chunks, where each chunk is 
            a separate memory core.";
    ValRandomize = true;
  } CHUNK[19:15] = 5'h00;

  field {
    AccessType = "RW";
    desc = "PM address to access (<24k).";
    ValRandomize = true;
  } ADDR[14:0] = 15'h00;
};

reg pm_mgmt_write_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG3'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG3_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG3_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Management Write Data Register.";
  desc = "This register is used for backdoor mgmt write into the Packet Memory. Data used
          for management writes.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RW";
    desc = "Data used for a PM mgmt write.";
    ValRandomize = true;
  } DATA[63:0] = 64'h00;
};

reg pm_mgmt_read_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG3'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG3_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG3_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Management Read Data Register.";
  desc = "This register is used for backdoor mgmt read from the Packet Memory. Data captured
          after PM read.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RO/V";
    desc = "Data captured after a PM mgmt read.";
    ValRandomize = true;
  } DATA[63:0] = 64'h00;
};

reg pm_err_write_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG1'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG1_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "For Debug Only, Reserved.";
  desc = "This register is used to inject correctable or uncorrectable errors into the PM
          sram banks. One pair of configuration bits for each sram chunk.  Once this 
          register has been written, the specified errors will be injected on every 
          subsequent write, whether from the functional write port or backdoor mgmt writes.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RW";
    desc = "Chunk 31 (bytes 248-255). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_31[63:62] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 30 (bytes 240-247). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_30[61:60] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 29 (bytes 232-239). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_29[59:58] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 28 (bytes 224-231). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_28[57:56] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 27 (bytes 216-223). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_27[55:54] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 26 (bytes 208-215). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_26[53:52] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 25 (bytes 200-207). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_25[51:50] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 24 (bytes 192-199). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_24[49:48] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 23 (bytes 184-191). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_23[47:46] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 22 (bytes 176-183). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_22[45:44] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 21 (bytes 168-175). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_21[43:42] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 20 (bytes 160-167). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_20[41:40] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 19 (bytes 152-159). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_19[39:38] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 18 (bytes 144-151). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_18[37:36] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 17 (bytes 136-143). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_17[35:34] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 16 (bytes 128-135). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_16[33:32] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 15 (bytes 120-127). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_15[31:30] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 14 (bytes 112-119). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_14[29:28] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 13 (bytes 104-111). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_13[27:26] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 12 (bytes 96-103). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_12[25:24] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 11 (bytes 88-95). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_11[23:22] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 10 (bytes 80-87). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_10[21:20] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 9 (bytes 72-79). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_9[19:18] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 8 (bytes 64-71). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_8[17:16] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 7 (bytes 56-63). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_7[15:14] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 6 (bytes 48-55). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_6[13:12] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 5 (bytes 40-47). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_5[11:10] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 4 (bytes 32-39). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_4[9:8] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 3 (bytes 24-31). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_3[7:6] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 2 (bytes 16-23). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_2[5:4] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 1 (bytes 8-15). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_1[3:2] = 2'h00;
  field {
    AccessType = "RW";
    desc = "Chunk 0 (bytes 0-7). 0x1=Cerr, 0x3=Uerr";
    ValRandomize = true;
  } CHUNK_0[1:0] = 2'h00;
};

reg pm_cerr_read_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG2'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG2_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG2_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Chunk Correctable ECC Error Status Register.";
  desc = "This register captures a record of the most recent correctable error to be read
          out of the PM.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RO/V";
    desc = "PM address where the most recent error was found.";
    ValRandomize = true;
  } ADDR[46:32] = 15'h00;

  field {
    AccessType = "RO/C/V";
    desc = "Chunks that had correctable errors.";
    ValRandomize = true;
  } CHUNK_MASK[31:0] = 32'h00;
};

reg pm_uerr_read_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG2'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG2_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG2_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Chunk Uncorrectable ECC Error Status Register.";
  desc = "This register captures a record of the most recent uncorrectable error to be read
          out of the PM.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RO/V";
    desc = "PM address where the most recent error was found.";
    ValRandomize = true;
  } ADDR[46:32] = 15'h0;

  field {
    AccessType = "RO/C/V";
    desc = "Chunks that had uncorrectable errors.";
    ValRandomize = true;
  } CHUNK_MASK[31:0] = 32'h0;
};

reg pm_ip_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG1'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG1_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Interrupt Pending Register.";
  desc = "This is interrupt pending register for Packet Memory.";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RW/1C/V";
    desc = "Bit 0 is for SRAM correctable(single bit) ECC error, 
            and Bit 1 is for SRAM uncorrectable(multiple bit) ECC error. ";
    ValRandomize = true;
  } SRAM_ERR[1:0] = 2'b00;
};

reg pm_im_r {
  Security_PolicyGroup     = <%=$Security_Props{'HLP_PG1'}%>;
  Security_ReadAccess_Str  = <%=$Security_Props{'HLP_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'HLP_PG1_WAC_AGENTS'}%>;
  shared;
  HandCoded = true;
  name = "Packet Memory Interrupt Mask Register.";
  desc = "This is interrupt mask register and controls if the corresponding interrupt
          source is presented to the interrupt hierarchy (bit is set to 0) or
          masked out (bit is set to 1).";

  regwidth    = 64;
  accesswidth = 64;

  field {
    AccessType = "RW";
    desc = "The bits correspond to PM_IP register. ";
    ValRandomize = true;
  } SRAM_ERR[1:0] = 2'b00;
};

addrmap hlp_PM_map {
  name = "HLP Packet Memory Control and Status Registers.";
  desc = "These are control and status registers in HLP Packet Memory block.";
  addressing = fullalign;
  Space = "MSG";
  Opcode = "MEM-SB";
  No_IOSF_Primary=true;
  AddressBits = 7;
  ResetDomains = "SWITCH,MGMT";

  pm_mgmt_ctrl_r            PM_MGMT_CTRL                  @0x000000;
  pm_mgmt_write_r           PM_MGMT_WRITE                 @0x000008;
  pm_err_write_r            PM_ERR_WRITE                  @0x000010;

  pm_mgmt_read_r            PM_MGMT_READ                  @0x000040;
  pm_cerr_read_r            PM_CERR_READ                  @0x000050;
  pm_uerr_read_r            PM_UERR_READ                  @0x000058;
  pm_ip_r                   PM_IP                         @0x000060;
  pm_im_r                   PM_IM                         @0x000068;
  shell_ctl_cerr_cnt_r      PM_ECC_COR_ERR                @0x000070;
  shell_ctl_uerr_cnt_r      PM_ECC_UNCOR_ERR              @0x000078;
};


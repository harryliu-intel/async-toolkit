<% use security; %>
<% my %Security_Props = security::GetSecurityInfo(); %>



// FWD_TABLE0[0..47][0..16383]

reg fwd_table0_r {
  shared;
  HandCoded = true;
  name = "Shared table for CGRP_A";
  desc = "
    Entry storage table for LPM and EM_A.
    [br][br]
    The first index is the bank number. Software should take care
    to allocate entries that could be accessed within a single cycle to different
    banks. The second index is sized to provide a total of 6MB.
           ";
  Security_PolicyGroup = <%=$Security_Props{'MBY_PG1'}%>;
  Security_ReadAccess_Str = <%=$Security_Props{'MBY_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'MBY_PG1_WAC_AGENTS'}%>;
  regwidth = 64;
  accesswidth = 64;
  field {
    AccessType = "RW";
    desc = "
        Entry data
           ";
    ValRandomize = true;
  } DATA[63:0] = 64'h0;
};
regfile fwd_table0_rf {
  fwd_table0_r FWD_TABLE0[16384] += 8;
};

// FWD_TABLE1[0..15][0..8191]

reg fwd_table1_r {
  shared;
  HandCoded = true;
  name = "Shared table for CGRP_B";
  desc = "
    Entry storage table for EM_B.
    [br][br]
    The first index is the bank number. Software should take care
    to allocate entries that could be accessed within a single cycle to different
    banks. The second index is sized to provide a total of 1MB.
           ";
  Security_PolicyGroup = <%=$Security_Props{'MBY_PG1'}%>;
  Security_ReadAccess_Str = <%=$Security_Props{'MBY_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'MBY_PG1_WAC_AGENTS'}%>;
  regwidth = 64;
  accesswidth = 64;
  field {
    AccessType = "RW";
    desc = "
        Entry data
           ";
    ValRandomize = true;
  } DATA[63:0] = 64'h0;
};
regfile fwd_table1_rf {
  fwd_table1_r FWD_TABLE1[8192] += 8;
};

// FWD_TABLE_MOD[0..9][0..16383]

reg fwd_table_mod_r {
  shared;
  HandCoded = true;
  name = "Shared table for packet modifier context memory";
  desc = "
    Entry storage table for modify content entries.
    [br][br]
    The first index is the bank number. Software should take care
    to allocate entries that could be accessed within a single cycle to different
    banks. The second index is sized to provide a total of 1280KB.
           ";
  Security_PolicyGroup = <%=$Security_Props{'MBY_PG1'}%>;
  Security_ReadAccess_Str = <%=$Security_Props{'MBY_PG1_RAC_AGENTS'}%>;
  Security_WriteAccess_Str = <%=$Security_Props{'MBY_PG1_WAC_AGENTS'}%>;
  regwidth = 64;
  accesswidth = 64;
  field {
    AccessType = "RW";
    desc = "
        Entry data
           ";
    ValRandomize = true;
  } DATA[63:0] = 64'h0;
};
regfile fwd_table_mod_rf {
  fwd_table_mod_r FWD_TABLE_MOD[16384] += 8;
};




addrmap mby_shm_map {
  name = "mby_shm";
  desc = "Shared Tables Register Set";
  Space = "MSG";
  Opcode = "MEM-SB";
  No_IOSF_Primary = true;
  addressing = fullalign;

  fwd_table0_rf       FWD_TABLE0[48];
  fwd_table1_rf       FWD_TABLE1[16];
  fwd_table_mod_rf    FWD_TABLE_MOD[10];
}; 

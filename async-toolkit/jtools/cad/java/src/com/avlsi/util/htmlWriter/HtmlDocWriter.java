/*
 * Copyright 2002 Fulcrum Microsystems.  All rights reserved.
 * $Id$
 * $DateTime$
 * $Author$
 */

package com.avlsi.util.htmlWriter;

import java.io.*;
import java.util.*;
import java.text.MessageFormat;

/**
 * Class for the Html Format Code Generation specific to Fulcrum HTML 
 * Documentation. This Class contains methods related to the Html Code 
 * Generation which are used by its sub-classes.
 *
 * @author Abe Ankumah
 */

public abstract class HtmlDocWriter extends HtmlWriter {
    
    /**
     * Constructor. Initialize filename. Just use default encoding.
     * @param filename String file name.
     */
    public HtmlDocWriter(String filename) throws IOException {
        super(filename, null);
    }

    /**
     * Print some part of the Html file header. Copyright Notice and
     * the invoking toolname, etc.
     * 
     * @param title    Title of this HTML document.
     */
    public void printPartialHeader(String title, String toolname, String headinfo) {
        println("<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 " + 
                "Transitional//EN\"" + 
                "\"http://www.w3.org/TR/REC-html40/loose.dtd>");
        println("<!--NewPage-->");
        html();
        head();
        println("<!-- Copyright " +year() 
		+". Fulcrum Microsystems. All Rights Reserved -->");
	print("<!-- Generated by " +toolname +" on ");
        print(today());
        println("-->");
	title();
        println(title +" " +today());
	titleEnd();
	if(headinfo != null)println(headinfo);
	headEnd();
    }

    /**
     * Print Fulcrum Microsystems copyright notice
     */
    public void FulcrumCopyright(){
	
	print(italicsText("Fulcrum Microsystems."));
	print("&copy copyright " +year() +". All Rights Reserved.");
	println("");
    }
    
    /**
     * Print Html Hyper Link.
     *
     * @param link String name of the file.
     * @param where Position of the link in the file. Character '#' is not
     * needed.
     * @param label Tag for the link.
     * @param bold  Boolean that sets label to bold.
     */
    public void printHyperLink(String link, String where,
                               String label, boolean bold) {
        print(getHyperLink(link, where, label, bold, ""));
    }

    /**
     * Print Html Hyper Link.
     *
     * @param link       String name of the file.
     * @param where      Position of the link in the file. Character '#' is not
     * needed.
     * @param label      Tag for the link.
     * @param bold       Boolean that sets label to bold.
     * @param stylename  String style of text defined in style sheet.
     */
    public void printHyperLink(String link, String where,
                               String label, boolean bold, 
                               String stylename) {
        print(getHyperLink(link, where, label, bold, stylename));
    }


    /**
     * Get Html Hyper Link string.
     *
     * @param link       String name of the file.
     * @param where      Position of the link in the file. Character '#' is not
     * needed.
     * @param label      Tag for the link.
     * @param bold       Boolean that sets label to bold.
     * @param stylename  String style of text defined in style sheet.
     * @return String    Hyper Link.
     */   
    public String getHyperLink(String link, String where, 
                               String label, boolean bold, 
                               String stylename) {
        StringBuffer retlink = new StringBuffer();
        retlink.append("<A HREF=\"");
        retlink.append(link);
        if (where.length() != 0) {
            retlink.append("#");
            retlink.append(where);
        }
        retlink.append("\">");
        if (stylename.length() != 0) {
            retlink.append("<FONT CLASS=\"");
            retlink.append(stylename);
            retlink.append("\">");
        }
        if (bold) {
            retlink.append("<B>");
        }
        retlink.append(label);
        if (bold) {
            retlink.append("</B>");
        }
        if (stylename.length() != 0) {
            retlink.append("</FONT>");
        }
        retlink.append("</A>");
        return retlink.toString();
    }

    /**
     * Print the closing &lt;/body&gt; and &lt;/html&gt; tags.
     */
    public void printBodyHtmlEnd() {
        println();
        bodyEnd();
        htmlEnd();
    }
    
    /**
     * Get the day and date information for today, depending upon user option.
     * 
     * @return String Today.
     * @see java.util.Calendar
     * @see java.util.GregorianCalendar 
     * @see java.util.TimeZone
     */
    public String today() {
        
        Calendar calendar = new GregorianCalendar(TimeZone.getDefault());
        return calendar.getTime().toString();
    }

    /**
     * Return a string for this year.
     * 
     * @see java.util.Calendar
     * @see java.util.GregorianCalendar 
     * @see java.util.TimeZone
     */
    public String year() {
	Calendar calendar = new GregorianCalendar(TimeZone.getDefault());
	return String.valueOf(calendar.get(Calendar.YEAR));
    }
}

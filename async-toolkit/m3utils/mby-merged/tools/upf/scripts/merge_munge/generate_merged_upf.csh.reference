#!/bin/csh
##--------------------------------------------------------------------------##
## Merges partition level UPF files which have load_upf commands to create a 
## flat partition level UPF file to be loaded into simulation and implementation
## NOTE: This script is very specific to LBG. This is not a generic script
## Author: shschmit
##--------------------------------------------------------------------------##

## Need to unalias cp as in some cases cp is being set to cp -ip
## This especially was seen in cases where gnome terminal was involved
## Below unaliasing would be the cleanest as it does not impact the shell
unalias cp
unalias rm
unalias mv
unalias grep

## All contents of the merge will be written into ${LOG_FILE_LOCATION}
set LOG_FILE_LOCATION = "${MODEL_ROOT}/source/gen/upf/log.merge"
if (-e ${LOG_FILE_LOCATION}) then
    set lastlog = `stat -c %y ${LOG_FILE_LOCATION} | sed -e 's/[-: ]//g' -e 's/..\..*//'`
    mv ${LOG_FILE_LOCATION} ${LOG_FILE_LOCATION}.$lastlog
    # rm -f ${LOG_FILE_LOCATION}
endif

touch ${LOG_FILE_LOCATION}

## Initial logistics to get the script going
cd ${COLLAGE_WORK}/upf/outputs
## psayyaga set MERGE_SCRIPT_ROOT = "/p/cse/asic/upf_tools/upf_tools/merge_upf"
## psayyaga set MUNGE_SCRIPT_ROOT = "/p/cse/asic/upf_tools/upf_tools/munge_upf"

set MERGE_SCRIPT_ROOT = "$MODEL_ROOT/tools/upf/upf_tools/tools/upf/merge_upf"
set MUNGE_SCRIPT_ROOT = "$MODEL_ROOT/tools/upf/upf_tools/tools/upf/munge_upf"
echo "Using $MERGE_SCRIPT_ROOT/merge_upf.tcl for merging" |& tee -a ${LOG_FILE_LOCATION}
echo "Using $MUNGE_SCRIPT_ROOT/munge_upf.tcl for munging" |& tee -a ${LOG_FILE_LOCATION}

setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs
echo "UPF_INSTALL_DIR: $UPF_INSTALL_DIR" |& tee -a ${LOG_FILE_LOCATION}

##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++##
## Removing isolation cells from collage that contain references to         ##
## UNKNOWN nets                                                             ##
#    opendir(my $dh, $some_dir) || die;
#    while(readdir $dh) {
#        print "$some_dir/$_\n";
#    }
#    closedir $dh;

##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++##
## Merging process starts from here
##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++##
cd $COLLAGE_WORK/upf/outputs

if ( $?UPF_DEBUG_PARTITION ) then
  echo ""
  echo '*** $UPF_DEBUG_PARTITION' "is set to '$UPF_DEBUG_PARTITION', merging $UPF_DEBUG_PARTITION only"
  echo ""
  if (! -d merge_results) then
      mkdir merge_results
  endif
  if (! -d $MODEL_ROOT/source/gen/upf/fc_par ) then
      mkdir -p $MODEL_ROOT/source/gen/upf/fc_par
  endif
  goto $UPF_DEBUG_PARTITION
endif

if (-d merge_results) then
    rm -rf merge_results
endif
mkdir merge_results

cd $MODEL_ROOT/source/gen/upf
if (-d fc_par) then
    rm -rf fc_par
endif
if (-d hip_io) then
    rm -rf hip_io
endif

mkdir fc_par
mkdir hip_io
cd fc_par 

##------------------------------------------------------------------##
##  LBGNS
##------------------------------------------------------------------##

cp -f -R $MODEL_ROOT/results/collage/upf/outputs/lbgns.upf .
cp -f -R $MODEL_ROOT/results/collage/upf/outputs/lbgns_set_voltage.tcl .
cp -f -R $MODEL_ROOT/results/collage/upf/outputs/upf_global_defs.tcl .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/lbgns_design_attributes.txt .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/lbgns_assertion_kill_cmd.tcl .
sed -i '/upf_global_defs/a \source $::env(MODEL_ROOT)/tools/upf/soc_upf.cfg' lbgns.upf
sed -i 's;upf -scope;sim.upf -scope;g' lbgns.upf

## RJS: remove vccrtcwell_1p5 port from port list
sed -i '/^  vccrtcwell_1p5/d' lbgns.upf

## RJS: restore parxgbe and hip_avrldo UPF to original name (remove .sim )
sed -i 's;sim.upf -scope parxgbe;upf -scope parxgbe;g' lbgns.upf
sed -i 's;sim.upf -scope hip_avrldo;upf -scope hip_avrldo;g' lbgns.upf

## RJS: change direction of LDO outputs from "in" to "out"
sed -i 's;create_supply_port -domain "lbgns_pd" -direction "in" "vccldo_1p24";create_supply_port -domain "lbgns_pd" -direction "out" "vccldo_1p24";g' lbgns.upf
sed -i 's;create_supply_port -domain "lbgns_pd" -direction "in" "vccldodsw_1p0";create_supply_port -domain "lbgns_pd" -direction "out" "vccldodsw_1p0";g' lbgns.upf
sed -i 's;create_supply_port -domain "lbgns_pd" -direction "in" "vccldodsw_1p8";create_supply_port -domain "lbgns_pd" -direction "out" "vccldodsw_1p8";g' lbgns.upf

## RJS: vccrtcwell_1p5 is not a port at the top, only an output from c73p4rtctop -> io wrapper, parrtc
sed -i 's;create_supply_port -domain "lbgns_pd" -direction "in" "vccrtcwell_1p5";###create_supply_port -domain "lbgns_pd" -direction "in" "vccrtcwell_1p5";g' lbgns.upf

## RJS: add IP_ENABLE_ALL to load_upfs for parxgbe and ldo upf's for NLP sims only....
sed -i '/# --- File: lbgns.upf; SOC UPF for top-module "lbgns"/a if { [info exists ::env(SPYGLASS_RUN)] || [info exists ::env(CONFORMAL_RUN)] || ([info exists synopsys_program_name] && ($synopsys_program_name == "dc_shell")) } {' lbgns.upf
sed -i '/if { \[info exists ::env(SPYGLASS_RUN)\] || \[info exists ::env(CONFORMAL_RUN)\] || (\[info exists synopsys_program_name\] && ($synopsys_program_name == "dc_shell")) } {/a  ; # DC will use .lib or .db for HIPs, SpyGlass will use .sglib, Conformal will use .lib for HIPs' lbgns.upf
sed -i '/; # DC will use .lib or .db for HIPs, SpyGlass will use .sglib, Conformal will use .lib for HIPs/a } else {' lbgns.upf  
sed -i '/} else {/a set ::IP_ENABLE_ALL 1' lbgns.upf
sed -i '/set ::IP_ENABLE_ALL 1/a }' lbgns.upf

##RJS: 10/10/14: add re-trigger for init blocks for NLP
sed -i '/set ::IP_ENABLE_ALL 1/a # Below causes the initial blocks of the behavioral models to re-trigger when power comes up after time 0.' lbgns.upf
sed -i '/# Below causes the initial blocks of the behavioral models to re-trigger when power comes up after time 0./a set_design_attributes -attribute SNPS_reinit TRUE' lbgns.upf
##RJS: 10/23/14: TEMP HACK: comment out non-mapped voltages for parxgbe kerem instances
## shschmit  sed -i 's;connect_supply_net "vcckr0lcpll_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr0lcpll_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr0a_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr0a_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr0_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr0_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr0_1_hv_1p8";#RJS:TEMP--connect_supply_net "vcckr0_1_hv_1p8";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr0_2_hv_1p8";#RJS:TEMP--connect_supply_net "vcckr0_2_hv_1p8";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vnnprim" -ports "parxgbe/vcc_lv_i0";#RJS:TEMP--connect_supply_net "vnnprim" -ports "parxgbe/vcc_lv_i0";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vss" -ports "parxgbe/vss0";#RJS:TEMP--connect_supply_net "vss" -ports "parxgbe/vss0";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr1lcpll_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr1lcpll_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr1a_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr1a_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr1_lv_1p05";#RJS:TEMP--connect_supply_net "vcckr1_lv_1p05";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr1_1_hv_1p8";#RJS:TEMP--connect_supply_net "vcckr1_1_hv_1p8";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vcckr1_2_hv_1p8";#RJS:TEMP--connect_supply_net "vcckr1_2_hv_1p8";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vnnprim" -ports "parxgbe/vcc_lv_i1";#RJS:TEMP--connect_supply_net "vnnprim" -ports "parxgbe/vcc_lv_i1";g' lbgns.upf
## shschmit  sed -i 's;connect_supply_net "vss" -ports "parxgbe/vss1";#RJS:TEMP--connect_supply_net "vss" -ports "parxgbe/vss1";g' lbgns.upf
##RJS: 10/24/14: add env variables for PARXGBE
sed -i '/if { \[info exists ::IP_ENABLE_ALL\] || \[info exists ::IP_ENABLE_PARXGBE\] } {/a setenv XGBE_RF_UPF_DIR $::env(MODEL_ROOT)/subIP/IP_BEL_LAN_SUPER_CLUSTER/tools/upf/rf_upf' lbgns.upf 
sed -i '/if { \[info exists ::IP_ENABLE_ALL\] || \[info exists ::IP_ENABLE_PARXGBE\] } {/a setenv XGBE_SRAM_UPF_DIR $::env(MODEL_ROOT)/subIP/IP_BEL_LAN_SUPER_CLUSTER/tools/upf/sram_upf' lbgns.upf
sed -i '/if { \[info exists ::IP_ENABLE_ALL\] || \[info exists ::IP_ENABLE_PARXGBE\] } {/a setenv XGBE_UPF_INSTALL_DIR $::env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper' lbgns.upf

##RJS: 10/18/14: add back in vccusbdsw_1p0 as a top level port only (and connect to parxhcib)
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccusbdsw_1p8"/a create_supply_port -domain "lbgns_pd" -direction "in" "vccusbdsw_1p0"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccusbdsw_1p8"/a create_supply_net -domain "lbgns_pd" "vccusbdsw_1p0"' lbgns.upf
sed -i '/parxhcib\/vccdsw_1p0/d' lbgns.upf
sed -i '/connect_supply_net "vccdsw_1p0" -ports ${VCCDSW_1P0_PORTS}/a connect_supply_net "vccusbdsw_1p0" -ports "vccusbdsw_1p0"' lbgns.upf
sed -i '/connect_supply_net "vccdsw_1p0" -ports ${VCCDSW_1P0_PORTS}/a connect_supply_net "vccusbdsw_1p0" -ports "parxhcib/vccdsw_1p0"' lbgns.upf
sed -i '/connect_supply_net "vccdsw_1p0" -ports ${VCCDSW_1P0_PORTS}/a # ---RJS: top level mapping for vccusbdsw_1p0' lbgns.upf


##RJS: 10/18/14: add back in vccauppcie2pll_1p05 and map to vccapcie2pll_1p05 in parfia20
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccapcie2pll_1p05"/a create_supply_port -domain "lbgns_pd" -direction "in" "vccauppcie2pll_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccapcie2pll_1p05"/a create_supply_net -domain "lbgns_pd" "vccauppcie2pll_1p05"' lbgns.upf
sed -i '/parfia20\/vccapcie2pll_1p05/d' lbgns.upf
sed -i '/connect_supply_net "vccapcie2pll_1p05" -ports ${VCCAPCIE2PLL_1P05_PORTS}/a connect_supply_net "vccauppcie2pll_1p05" -ports "vccauppcie2pll_1p05"' lbgns.upf
sed -i '/connect_supply_net "vccapcie2pll_1p05" -ports ${VCCAPCIE2PLL_1P05_PORTS}/a connect_supply_net "vccauppcie2pll_1p05" -ports "parfia20/vccapcie2pll_1p05"' lbgns.upf
sed -i '/connect_supply_net "vccapcie2pll_1p05" -ports ${VCCAPCIE2PLL_1P05_PORTS}/a # ---RJS: top level mapping for vccauppcie2pll_1p05' lbgns.upf

##RJS: 10/29/14: remove fuse ldo output voltages from top level:WIP
#sed -i '/\s*vccfldooem\s*/d' lbgns.upf

##RJS: 10/29/14: add par_ac_cpm_cluster voltages: vnnprim_cpm and vccsramcpm_1p05
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vnnprim"/a create_supply_port -domain "lbgns_pd" -direction "in" "vnnprim_cpm"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vnnprim"/a create_supply_net -domain "lbgns_pd" "vnnprim_cpm"' lbgns.upf
## shschmit 11/6/2014 vccsramcpm_1p05 is now inserted during collage. 
##sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccsramcsmea_1p05"/a create_supply_port -domain "lbgns_pd" -direction "in" "vccsramcpm_1p05"' lbgns.upf
##sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccsramcsmea_1p05"/a create_supply_net -domain "lbgns_pd" "vccsramcpm_1p05"' lbgns.upf

sed -i '/par_ac_cpm_cluster\/vnnprim'/d lbgns.upf

sed -i '/connect_supply_net "vnnprim" -ports ${VNNPRIM_PORTS}/a connect_supply_net "vnnprim_cpm" -ports "vnnprim_cpm"' lbgns.upf
sed -i '/connect_supply_net "vnnprim" -ports ${VNNPRIM_PORTS}/a connect_supply_net "vnnprim_cpm" -ports "par_ac_cpm_cluster/vnnprim_cpm"' lbgns.upf
sed -i '/connect_supply_net "vnnprim" -ports ${VNNPRIM_PORTS}/a # ---RJS: top level mapping for vnnprim_cpm' lbgns.upf

#sed -i '/connect_supply_net "vccsramcsmea_1p05" -ports ${VCCSRAMCSMEA_1P05_PORTS}/a connect_supply_net "vccsramcpm_1p05" -ports "vccsramcpm_1p05"' lbgns.upf
#sed -i '/connect_supply_net "vccsramcsmea_1p05" -ports ${VCCSRAMCSMEA_1P05_PORTS}/a connect_supply_net "vccsramcpm_1p05" -ports "par_ac_cpm_cluster/vccsramcpm_1p05"' lbgns.upf
#sed -i '/connect_supply_net "vccsramcsmea_1p05" -ports ${VCCSRAMCSMEA_1P05_PORTS}/a # ---RJS: top level mapping for vccsramcpm_1p05' lbgns.upf

#RJS: 01/09/15:  add in IO pins to lbgns_set_votage.tcl -- Collage does not add these to the set_voltage file
cat lbgns_set_voltage.tcl lbgns_design_attributes.txt > lbgns_set_voltage.tcl.temp
cp lbgns_set_voltage.tcl.temp lbgns_set_voltage.tcl

#RJS: 01/09/15: update lbgns_set_voltage.tcl to correct voltages for KR and fuse pins (collage error)
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "fpf0_mon"\];set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list [get_ports "fpf0_mon"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "fpf1_mon"\];set_related_supply_net -power "fuseldo1_vcc1p8_ehv" -ground "vss" -object_list [get_ports "fpf1_mon"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "itp_pmode"\];set_related_supply_net -power "vccpjtag_1p05" -ground "vss" -object_list [get_ports "itp_pmode"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_mon_dn"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_mon_dn"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_mon_dp"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_mon_dp"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_refclkout"\];set_related_supply_net -power "vcckr0lcpll_lv_1p05" -ground "vss" -object_list [get_ports "kr0_refclkout"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_tx_dn0"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_tx_dn0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_tx_dn1"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_tx_dn1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_tx_dp0"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_tx_dp0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_tx_dp1"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_tx_dp1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_mon_dn"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_mon_dn"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_mon_dp"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_mon_dp"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_refclkout"\];set_related_supply_net -power "vcckr1lcpll_lv_1p05" -ground "vss" -object_list [get_ports "kr1_refclkout"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_tx_dn0"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_tx_dn0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_tx_dn1"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_tx_dn1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_tx_dp0"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_tx_dp0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_tx_dp1"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_tx_dp1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "fpf0_vref"\];set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list [get_ports "fpf0_vref"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "fpf1_vref"\];set_related_supply_net -power "fuseldo1_vcc1p8_ehv" -ground "vss" -object_list [get_ports "fpf1_vref"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_refclkin"\];set_related_supply_net -power "vcckr0lcpll_lv_1p05" -ground "vss" -object_list [get_ports "kr0_refclkin"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_rx_dn0"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_rx_dn0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_rx_dn1"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_rx_dn1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_rx_dp0"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_rx_dp0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr0_rx_dp1"\];set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list [get_ports "kr0_rx_dp1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_refclkin"\];set_related_supply_net -power "vcckr1lcpll_lv_1p05" -ground "vss" -object_list [get_ports "kr1_refclkin"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_rx_dn0"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_rx_dn0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_rx_dn1"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_rx_dn1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_rx_dp0"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_rx_dp0"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "kr1_rx_dp1"\];set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list [get_ports "kr1_rx_dp1"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "fpf0_mon";set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list "fpf0_mon";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "fpf1_mon";set_related_supply_net -power "fuseldo1_vcc1p8_ehv" -ground "vss" -object_list "fpf1_mon";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "itp_pmode";set_related_supply_net -power "vccpjtag_1p05" -ground "vss" -object_list "itp_pmode";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_mon_dn";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_mon_dn";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_mon_dp";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_mon_dp";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_refclkout";set_related_supply_net -power "vcckr0lcpll_lv_1p05" -ground "vss" -object_list "kr0_refclkout";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_tx_dn0";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_tx_dn0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_tx_dn1";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_tx_dn1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_tx_dp0";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_tx_dp0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_tx_dp1";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_tx_dp1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_mon_dn";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_mon_dn";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_mon_dp";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_mon_dp";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_refclkout";set_related_supply_net -power "vcckr1lcpll_lv_1p05" -ground "vss" -object_list "kr1_refclkout";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_tx_dn0";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_tx_dn0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_tx_dn1";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_tx_dn1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_tx_dp0";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_tx_dp0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_tx_dp1";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_tx_dp1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "fpf0_vref";set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list "fpf0_vref";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "fpf1_vref";set_related_supply_net -power "fuseldo1_vcc1p8_ehv" -ground "vss" -object_list "fpf1_vref";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_refclkin";set_related_supply_net -power "vcckr0lcpll_lv_1p05" -ground "vss" -object_list "kr0_refclkin";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_rx_dn0";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_rx_dn0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_rx_dn1";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_rx_dn1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_rx_dp0";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_rx_dp0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr0_rx_dp1";set_related_supply_net -power "vcckr0a_lv_1p05" -ground "vss" -object_list "kr0_rx_dp1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_refclkin";set_related_supply_net -power "vcckr1lcpll_lv_1p05" -ground "vss" -object_list "kr1_refclkin";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_rx_dn0";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_rx_dn0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_rx_dn1";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_rx_dn1";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_rx_dp0";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_rx_dp0";g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "kr1_rx_dp1";set_related_supply_net -power "vcckr1a_lv_1p05" -ground "vss" -object_list "kr1_rx_dp1";g' lbgns_set_voltage.tcl

#RJS: 01/09/15: add sourcing of lbgns_set_voltage.tcl to lbgns.upf
sed -i '$a # --- set_voltage values for supply/ground (to make dc/spyglass happy)' lbgns.upf
sed -i '$a set UPF_INSTALL_DIR $::env(UPF_INSTALL_DIR)' lbgns.upf
sed -i '$a source ${UPF_INSTALL_DIR}/lbgns_set_voltage.tcl' lbgns.upf
##add a space between this comment and the end of the power state table
sed -i '/# --- set_voltage values for supply\/ground (to make dc\/spyglass happy)/{x;p;x;}' lbgns.upf

#DPV: 02/18/15: add in a control block to kill assertion while power domains are down
sed -i '$a # --- Disable simulation assertion checks while associated power domains are off' lbgns.upf
sed -i '$a source ${UPF_INSTALL_DIR}/lbgns_assertion_kill_cmd.tcl' lbgns.upf

#RJS: 01/27/15: connect top level parxgbe and avrlbgldo Vcc pins
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccsramgbe_bl_1p05"/a connect_supply_net "vccsramgbe_bl_1p05" -ports "vccsramgbe_bl_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccsramgbe_br_1p05"/a connect_supply_net "vccsramgbe_br_1p05" -ports "vccsramgbe_br_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccsramgbe_tr_1p05"/a connect_supply_net "vccsramgbe_tr_1p05" -ports "vccsramgbe_tr_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr0lcpll_lv_1p05"/a connect_supply_net "vcckr0lcpll_lv_1p05" -ports "vcckr0lcpll_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr0a_lv_1p05"/a connect_supply_net "vcckr0a_lv_1p05" -ports "vcckr0a_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr0_lv_1p05"/a connect_supply_net "vcckr0_lv_1p05" -ports "vcckr0_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr0_1_hv_1p8"/a connect_supply_net "vcckr0_1_hv_1p8" -ports "vcckr0_1_hv_1p8"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr0_2_hv_1p8"/a connect_supply_net "vcckr0_2_hv_1p8" -ports "vcckr0_2_hv_1p8"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr1lcpll_lv_1p05"/a connect_supply_net "vcckr1lcpll_lv_1p05" -ports "vcckr1lcpll_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr1a_lv_1p05"/a connect_supply_net "vcckr1a_lv_1p05" -ports "vcckr1a_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr1_lv_1p05"/a connect_supply_net "vcckr1_lv_1p05" -ports "vcckr1_lv_1p05"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr1_1_hv_1p8"/a connect_supply_net "vcckr1_1_hv_1p8" -ports "vcckr1_1_hv_1p8"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vcckr1_2_hv_1p8"/a connect_supply_net "vcckr1_2_hv_1p8" -ports "vcckr1_2_hv_1p8"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "out" "vccldodsw_1p0"/a connect_supply_net "vccldodsw_1p0" -ports "vccldodsw_1p0"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "out" "vccldodsw_1p8"/a connect_supply_net "vccldodsw_1p8" -ports "vccldodsw_1p8"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "out" "vccldo_1p24"/a connect_supply_net "vccldo_1p24" -ports "vccldo_1p24"' lbgns.upf
sed -i '/create_supply_port -domain "lbgns_pd" -direction "in" "vccpldo_1p8"/a connect_supply_net "vccpldo_1p8" -ports "vccpldo_1p8"' lbgns.upf

##RJS: 021015:HSD #5512054 -- change SRSN voltage for usb2_pllmon from vccusbdsw_1p8 to vccusb_1p05 to match .lib for usb2_hip (collage is incorrectly assigning this 
# voltage) -- this is an analog pin.
sed -i 's;set_related_supply_net -power "vccusbdsw_1p8" -ground "vss" -object_list \[get_ports "usb2_pllmon"\];set_related_supply_net -power "vccusb_1p05" -ground "vss" -object_list [get_ports "usb2_pllmon"];g' lbgns_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vccusbdsw_1p8" -ground "vss" -object_list "usb2_pllmon";set_related_supply_net -power "vccusb_1p05" -ground "vss" -object_list "usb2_pllmon";g' lbgns_set_voltage.tcl

##RJS: 021715:HSD #5512089 -- lbgns.upf primary voltage should be vnnprim -- it was set to vccprtc_3p3 due to a tool bug in vcs; with
# vcs 2013, this bug seems to have been fixed. Changing this back to vnbnprim/
sed -i 's;-primary_power_net "vccprtc_3p3";-primary_power_net "vnnprim";g' lbgns.upf

##RJS: 061215: #5512055 -- vcca_dig_1p05 to be removed from parxhcia -- to be handled by backend
sed -i '/^  parxhcia\/vcca_dig_1p05/d' lbgns.upf

##CVB
# Remove parrtc/vnnprim if it exists
grep -v "parrtc/vnnprim" lbgns.upf > lbgns.upf.tmp ; cp lbgns.upf.tmp lbgns.upf ; rm lbgns.upf.tmp

# Add parrtc/vccioparleg_1p05 if it doesn't already exist
grep -q "parrtc/vccioparleg_1p05" lbgns.upf
if ($? == 1) then
    perl -p -i -e 'if(/set VCCIOPARLEG_1P05_PORTS/){$_.="  parrtc/vccioparleg_1p05\n"};' lbgns.upf
endif

# Add parleg/vccusbdsw_1p0 if it doesn't already exist
grep -q "parleg/vccusbdsw_1p0" lbgns.upf
if ($? == 1) then
    perl -p -i -e 'if(/set VCCUSBDSW_1P0_PORTS/){$_.="  parleg/vccusbdsw_1p0\n"};' lbgns.upf
endif


##------------------------------------------------------------------##
##  Acceleration Complex
##------------------------------------------------------------------##
# dvander 02/26/15: changed the below at the request of Sudeep from the AC team
#cp -f -R $MODEL_ROOT/subIP/upf_ac_cpm_ROOT/* .
cp -f -R $upf_ac_cpm_ROOT/* .

sed -i '/connect_supply_net "vss" -ports ${VSS_PORTS}/a connect_supply_net "vccsramcpm_1p05" -ports par_ac_cpm_cluster/vccsramcpm_1p05' lbgns.upf
sed -i '/connect_supply_net "vss" -ports ${VSS_PORTS}/a connect_supply_net "vccsramcpm_1p05" -ports vccsramcpm_1p05' lbgns.upf

mv parpcix16.upf parpcix16.sim.upf
mv parpcix8.upf parpcix8.sim.upf
mv parpsf8.upf parpsf8.sim.upf
mv parpsf9.upf parpsf9.sim.upf
mv parpsf10.upf parpsf10.sim.upf
## dvander 12/30/14: commented out two lines below at the direction of the AC team (lmurugap) for the ww49a model
#mv parssmb.upf parssmb0.upf
#mv parssmc.upf parssmc0.upf
mv par_ac_cpm_cluster.upf par_ac_cpm_cluster.sim.upf


##------------------------------------------------------------------##
## PARSCC
##------------------------------------------------------------------##
## parscc removed from LBGNS  ##  echo  "\n ---> Processing PARSCC ...." |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  cd $COLLAGE_WORK/upf/outputs/merge_results
## parscc removed from LBGNS  ##  if (-d parscc) then
## parscc removed from LBGNS  ##      rm -rf parscc
## parscc removed from LBGNS  ##  endif
## parscc removed from LBGNS  ##  mkdir parscc
## parscc removed from LBGNS  ##  cd parscc
## parscc removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/scc_ROOT/tools/upf/* .
## parscc removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parscc_scanunit/* .
## parscc removed from LBGNS  ##  chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parscc
## parscc removed from LBGNS  ##  dos2unix SCC.upf
## parscc removed from LBGNS  ##  dos2unix parscc_scanunit.upf
## parscc removed from LBGNS  ##  cp -f $MODEL_ROOT/results/collage/upf/outputs/parscc* .
## parscc removed from LBGNS  ##  sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scc_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parfuse_scanunit;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parscc_scanunit;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;$SCC_UPF_ROOT_DIR/SCC_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;$POWER_SWITCH_CELL;$PS_CELL;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;$SCC_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parscc;g' SCC.upf
## parscc removed from LBGNS  ##  #sed -i 's;$SCC_UPF_ROOT_DIR/scc_clamp_clkout.list;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parscc/scc_clamp_clkout.list;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;source $PARSCC_SCANUNIT_UPF_ROOT_DIR/parscc_scanunit_pd_scc_io_aon.upf;## shschmit commented out by FC UPF merge script  source $PARSCC_SCANUNIT_UPF_ROOT_DIR/parscc_scanunit_pd_scc_io_aon.upf;g' parscc_scanunit.upf
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  setenv SPYGLASS_LP_RUN 0
## parscc removed from LBGNS  ##  setenv ENABLE_SLP_RUN 0
## parscc removed from LBGNS  ##  echo "--->---> sub processing PARSCC .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parscc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parscc.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  unsetenv SPYGLASS_LP_RUN
## parscc removed from LBGNS  ##  unsetenv ENABLE_SLP_RUN
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  cp -f parscc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
## parscc removed from LBGNS  ##  cp -f parscc.inc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  

##------------------------------------------------------------------##
## PARFUSE
##------------------------------------------------------------------##
echo  "\n ---> Processing PARFUSE ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parfuse) then
    rm -rf parfuse
endif
mkdir parfuse
cd parfuse

cp -f $MODEL_ROOT/results/collage/upf/outputs/parfuse* . 
cp -f $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parfuse_scanunit/* .
cp -f $MODEL_ROOT/subIP/fuse_ROOT/source/upf/* .
cp -f $MODEL_ROOT/subIP/fuse_ROOT/source/upf/lbg/* .
cp -f $MODEL_ROOT/tools/upf/fuse_hip_wrapper.upf .

## shschmit 4/2/2014 Copying upf with isolation hacks due to applies_to issue
cp -f $MODEL_ROOT/tools/upf/fuse_top_lbg.upf .
cp -f $MODEL_ROOT/tools/upf/fuse_lbg_upf_port_lists.tcl .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parfuse
dos2unix fuse_top_lbg.upf
dos2unix parfuse_scanunit.upf
sed -i 's;tools/upf/fuse_hip_wrapper.upf;results/collage/upf/outputs/merge_results/parfuse/fuse_hip_wrapper.upf;g' parfuse.upf
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parfuse.upf
sed -i 's;subIP/fuse_ROOT/source/upf/fuse_top_nopg.upf;results/collage/upf/outputs/merge_results/parfuse/fuse_top_nopg.upf;g' parfuse.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parfuse_scanunit;results/collage/upf/outputs/merge_results/parfuse;g' parfuse.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/source/upf/fuse_lbg_upf_port_lists.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfuse/fuse_lbg_upf_port_lists.tcl;g' fuse_top_nopg.upf
sed -i 's;source fuse_lbg_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' fuse_top_nopg.upf
sed -i 's;$__LBG_SPG;0;g' fuse_top_nopg.upf
sed -i 's;$GAT_UNG_OUT_ISO_CELL_LOC;parent;g' fuse_top_nopg.upf
sed -i 's;$AON_INP_ISO_CELL_LOC;self;g' fuse_top_nopg.upf
sed -i 's;$__LBG_VCS;0;g' fuse_top_nopg.upf
sed -i 's;\[file exists $::env(IP_ROOT)\];0;g' fuse_top_nopg.upf
sed -i 's;source $::env(IP_ROOT)/source/upf/$::env(SIP_VARIATION)/fuse_top_upf.cfg;source $::env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfuse/fuse_top_upf.cfg;g' fuse_top_nopg.upf

# Delete erroneous create_supply_net declarations
sed -i 's;$__LBG_VCS;0;g' fuse_hip_wrapper.upf
sed -i 's;vccsocvidaon_1p03;vnnprim;g' fuse_top_upf.cfg
setenv IP_NAME chassis_fuse_controller

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARFUSE .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfuse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfuse.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN


#cp -f $MODEL_ROOT/subIP/hip_fuse_ROOT/rtl/upf/p73_fusehd2k.upf .
#sed -i 's;upf_version;#upf_version;g' p73_fusehd2k.upf
cp -f $MODEL_ROOT/tools/upf/fuse_hip_wrapper.upf .
#sed -i 's;$env(MODEL_ROOT)/subIP/hip_fuse_ROOT/rtl/upf/p73_fusehd2k.upf;p73_fusehd2k.upf;g' fuse_hip_wrapper.upf
sed -i 's;$__LBG_VCS;1;g' fuse_hip_wrapper.upf
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARFUSE .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfuse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfuse_sim.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "p73_fuse* p73_module* p73_pgm* p73_sen* c73p1avrfuse* c73p1rfslv* c73p4rngheart*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv IP_NAME

#Remove isolation on pfet_ack signal
sed -i '/hvm_semaphore_inuse/{d}' parfuse.inc.*.tcl
sed -i '/apgm_mode_en/{d}' parfuse.inc.*.tcl
sed -i '/raepif_byteen/{d}' parfuse.inc.*.tcl
sed -i '/PARFUSE_PWELL_WRAPPER_FUSE_TOP1_PD_FUSE_VNN_PGD_ISO0_PINS/a \parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_controller_top/hvm_semaphore_inuse' parfuse.inc.*.tcl
sed -i '/PARFUSE_PWELL_WRAPPER_FUSE_TOP1_PD_FUSE_VNN_PGD_ISO0_PINS/a \parfuse_pwell_wrapper/i_idvp_fublet_parfuse_pwell_wrapper_1/idvtctrlo' parfuse.inc.*.tcl

#sed -i '/hvm_semaphore_inuse/{d}' parfuse.inc.*.tcl
#sed -i '/PARFUSE_PWELL_WRAPPER_FUSE_TOP1_PD_FUSE_VNN_PGD_ISO0_PINS/a \parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_controller_top/hvm_semaphore_inuse' parfuse.inc.*.tcl
#sed -i '/PARFUSE_PWELL_WRAPPER_FUSE_TOP1_PD_FUSE_VNN_PGD_ISO0_PINS/a \parfuse_pwell_wrapper/i_idvp_fublet_parfuse_pwell_wrapper_1/idvtctrlo' parfuse.inc.*.tcl

#cp -f parfuse.impl.upf parfuse.merged.upf

## adding -resolve parallel to these nets which interconnect two separately declared ports.
## sed -i 's;create_supply_net -domain "pd_pwell_parfuse_pd" "vccfldooem";create_supply_net -domain "pd_pwell_parfuse_pd" "vccfldooem" -resolve "parallel";g' parfuse.sim.upf
## sed -i 's;create_supply_net -domain "pd_pwell_parfuse_pd" "vccfhvldointc";create_supply_net -domain "pd_pwell_parfuse_pd" "vccfhvldointc" -resolve "parallel";g' parfuse.sim.upf
## sed -i 's;create_supply_net -domain "pd_pwell_parfuse_pd" "vccfhvldooem";create_supply_net -domain "pd_pwell_parfuse_pd" "vccfhvldooem" -resolve "parallel";g' parfuse.sim.upf
## sed -i 's;create_supply_net -domain "pd_pwell_parfuse_pd" "vccfldointc";create_supply_net -domain "pd_pwell_parfuse_pd" "vccfldointc" -resolve "parallel";g' parfuse.sim.upf

sed -i 's;"fuseldo0_vcc1p8";"fuseldo0_vcc1p8_ehv";g' parfuse.*.upf
sed -i 's;"fuseldo1_vcc1p8";"fuseldo1_vcc1p8_ehv";g' parfuse.*.upf

sed -i 's;"vccfhvldointc" -reuse;"vccfhvldointc";g' parfuse.*.upf 
sed -i 's;"vccfhvldooem" -reuse;"vccfhvldooem";g' parfuse.*.upf 
sed -i 's;"vccfldointc" -reuse;"vccfldointc";g' parfuse.*.upf 
sed -i 's;"vccfldooem" -reuse;"vccfldooem";g' parfuse.*.upf 

sed -i 's;vnnprim" -ground "vss" -object_list \[get_ports "oemifp_o_ldo_analog_mon;fuseldo0_vcc1p8_ehv" -ground "vss" -object_list [get_ports "oemifp_o_ldo_analog_mon;g' parfuse.*.upf 
sed -i 's;vnnprim" -ground "vss" -object_list \[get_ports "intcifp_o_ldo_analog_mon;fuseldo1_vcc1p8_ehv" -ground "vss" -object_list [get_ports "intcifp_o_ldo_analog_mon;g' parfuse.*.upf 

sed -i 's;vnnprim" -ground "vss" -object_list "oemifp_o_ldo_analog_mon;fuseldo0_vcc1p8_ehv" -ground "vss" -object_list "oemifp_o_ldo_analog_mon;g' parfuse.*.upf
sed -i 's;vnnprim" -ground "vss" -object_list "intcifp_o_ldo_analog_mon;fuseldo1_vcc1p8_ehv" -ground "vss" -object_list "intcifp_o_ldo_analog_mon;g' parfuse.*.upf

# intcifp_o_ldo_analog_mon
##sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list [get_ports "oemifp_o_ldo_analog_mon"];set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list [get_ports "oemifp_o_ldo_analog_mon"];g' parfuse.*.upf
##sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "oemifp_o_ldo_analog_mon";set_related_supply_net -power "fuseldo0_vcc1p8_ehv" -ground "vss" -object_list "oemifp_o_ldo_analog_mon";g' parfuse.*.upf
##sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list [get_ports "intcifp_o_ldo_analog_mon"];set_related_supply_net -power "intcifp_o_ldo_analog_mon" -ground "vss" -object_list [get_ports "intcifp_o_ldo_analog_mon"];g' parfuse.*.upf
##sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "intcifp_o_ldo_analog_mon";set_related_supply_net -power "intcifp_o_ldo_analog_mon" -ground "vss" -object_list "intcifp_o_ldo_analog_mon";g' parfuse.*.upf

sed -i 's;parfuse_pwell_wrapper/fuse_top1/fuse_pmc_pfet_en_ack_b;parfuse_pwell_wrapper/i_idvp_fublet_parfuse_pwell_wrapper_0/idvtctrlo;g' parfuse.inc.*.tcl

## 150811 Uzair: HSD 5512603 B0ECO4 parfuse upf: missing connect_supply_net for zprrng_inst
##sed -i '153 i\connect_supply_net "vss" -ports "parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_ctrl_south_complec_drng/zprrng_inst/vss"' parfuse.*.upf
##sed -i '153 i\connect_supply_net "vnnprim" -ports "parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_ctrl_south_complec_drng/zprrng_inst/vccx"' parfuse.*.upf
## 150911 Uzair: It will cause NLP sim error...missing vss port.
sed -i '153 i\connect_supply_net "vss" -ports "parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_ctrl_south_complec_drng/zprrng_inst/vss"' parfuse.impl.upf
sed -i '153 i\connect_supply_net "vnnprim" -ports "parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_ctrl_south_complec_drng/zprrng_inst/vccx"' parfuse.impl.upf


#############################################################################################
## shschmit Need to hack some of the hip_fuse upfs to fix PST coverage issues in NLP flow. ##
#############################################################################################
cp -Rf $MODEL_ROOT/subIP/hip_fuse_ROOT/rtl/upf/p73_fusehd2k.upf .
cp -Rf $MODEL_ROOT/subIP/hip_fuse_ROOT/rtl/upf/p73_pgmvld.upf .
cp -Rf $MODEL_ROOT/subIP/hip_fuse_ROOT/rtl/upf/p73_senvld.upf .
sed -i 's;{HighVoltage 1.05};{HighVoltage 0.94};g' p73_*.upf
sed -i 's;{HighVoltage 2.1}  -state {LowVoltage 1.05};{HighVoltage 3.09};g' p73_*.upf
sed -i 's;add_pst_state pd_vld_on_sense;#commented out by UPF Flow Merge Script   add_pst_state pd_vld_on_sense;g' p73_*.upf
sed -i 's;add_pst_state pd_sense;#commented out by UPF Flow Merge Script  add_pst_state pd_sense;g' p73_*.upf

cp -Rf $MODEL_ROOT/subIP/hip_fuse_ROOT/rtl/upf/c73p1avrfusevrmtop.upf .
sed -i 's;add_port_state vcc1p8_ehv   -state {ON 1.80};add_port_state vcc1p8_ehv   -state {ON 1.66};g' c73p1avrfusevrmtop.upf
sed -i 's;add_port_state vcc1p05_lv   -state {ON 1.05};add_port_state vcc1p05_lv   -state {ON 0.94};g' c73p1avrfusevrmtop.upf
sed -i 's;add_port_state vcc3p3_uhv   -state {ON 3.3} -state {OFF off};add_port_state vcc3p3_uhv   -state {ON 3.09} -state {OFF off};g' c73p1avrfusevrmtop.upf
sed -i 's;add_port_state vss   -state {OFF off};add_port_state vss   -state {ON 0.0};g' c73p1avrfusevrmtop.upf
sed -i 's;OFF\s*};ON };g' c73p1avrfusevrmtop.upf
sed -i '153 i\connect_supply_net "vss" -ports "parfuse_pwell_wrapper/fuse_top1/i_chassis_fuse_ctrl_south_complec_drng/zprrng_inst/vss"' c73p1avrfusevrmtop.upf

##HSD5512804:RJS: restore ldo outputs to 1.05v; change modelling of LDOs (VRMs) in c73p1avrfusevrmtop to output
## the correct LDO voltages (1.05v for both vccf_hv and vccfhv_uhv)
#sed -i 's;add_port_state  vccf_hv  -state {ON 1.05};add_port_state  vccf_hv  -state {ON 0.94};g' c73p1avrfusevrmtop.upf
#sed -i 's;add_port_state  vccfhv_uhv  -state {ON 1.05};add_port_state  vccfhv_uhv  -state {ON 3.09};g' c73p1avrfusevrmtop.upf
#sed -i 's;-input_supply_port {in vcc1p8_ehv };-input_supply_port {in vcc1p05_lv };g' c73p1avrfusevrmtop.upf
sed -i 's;set_voltage -object_list "vccfhvldointc" -min 0.94 0.94;set_voltage -object_list "vccfhvldointc" -min 1.05 1.05;g' parfuse.*.upf 
sed -i 's;set_voltage -object_list "vccfhvldooem" -min 0.94 0.94;set_voltage -object_list "vccfhvldooem" -min 1.05 1.05;g' parfuse.*.upf 
sed -i 's;set_voltage -object_list "vccfldointc" -min 0.94 0.94;set_voltage -object_list "vccfldointc" -min 1.05 1.05;g' parfuse.*.upf 
sed -i 's;set_voltage -object_list "vccfldooem" -min 0.94 0.94;set_voltage -object_list "vccfldooem" -min 1.05 1.05;g' parfuse.*.upf 
sed -i 's;c73p1ifpfusehipldo/vccfhv_uhv" -state "v_on 3.09";c73p1ifpfusehipldo/vccfhv_uhv" -state "v_on 1.05";g' parfuse.*.upf
sed -i 's;c73p1ifpfusehipldo/vccf_hv" -state "v_on 0.94";c73p1ifpfusehipldo/vccf_hv" -state "v_on 1.05";g' parfuse.*.upf

#--comment out power switches:
#sed -i '/create_power_switch pwrswitch_vccf/,+5 s/^/#/' c73p1avrfusevrmtop.upf

#--add lines to control the vccf and vccfhv outputs from the RTL
#sed -i '/connect_supply_net vccf_hv  -ports vccf_hv/a connect_supply_net vccf_hv  -ports ldo_vccf/o_vcc' c73p1avrfusevrmtop.upf
#sed -i '/connect_supply_net vccfhv_uhv  -ports vccfhv_uhv/a connect_supply_net vccfhv_uhv  -ports ldo_vccfhv/o_vcc' c73p1avrfusevrmtop.upf

#HSD#5512845
# connections above to correct the LDO modelling in the c73p1avrfusevrmtop.upf failed in the DeepSx NLP test
# and because there are no other signals available from the ldo bmod, restoring connections back to the power switches
# (i.e comment out the three lines above)
# However, changing the power switches to input voltages of 1p05 (insted of vcc1p8_ehv and vcc3p3_uhv)
sed -i 's;input_supply_port {in vcc1p8_ehv };input_supply_port {in vcc1p05_lv };g' c73p1avrfusevrmtop.upf
sed -i 's;input_supply_port {in vcc3p3_uhv  };input_supply_port {in vcc1p05_lv };g' c73p1avrfusevrmtop.upf

#############################################################################################


cp -f parfuse.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfuse.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfuse.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfuse.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/
# source $::env(MODEL_ROOT)/tools/upf/soc_upf.cfg

##------------------------------------------------------------------##
## PARSCC
##------------------------------------------------------------------##
## parscc removed from LBGNS  ##  echo  "\n ---> Processing PARSCC ...." |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  cd $COLLAGE_WORK/upf/outputs/merge_results
## parscc removed from LBGNS  ##  if (-d parscc) then
## parscc removed from LBGNS  ##      rm -rf parscc
## parscc removed from LBGNS  ##  endif
## parscc removed from LBGNS  ##  mkdir parscc
## parscc removed from LBGNS  ##  cd parscc
## parscc removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/scc_ROOT/tools/upf/* .
## parscc removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parscc_scanunit/* .
## parscc removed from LBGNS  ##  chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parscc
## parscc removed from LBGNS  ##  dos2unix SCC.upf
## parscc removed from LBGNS  ##  dos2unix parscc_scanunit.upf
## parscc removed from LBGNS  ##  cp -f $MODEL_ROOT/results/collage/upf/outputs/parscc* .
## parscc removed from LBGNS  ##  sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scc_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parfuse_scanunit;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parscc_scanunit;results/collage/upf/outputs/merge_results/parscc;g' parscc.upf
## parscc removed from LBGNS  ##  sed -i 's;$SCC_UPF_ROOT_DIR/SCC_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;$POWER_SWITCH_CELL;$PS_CELL;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;$SCC_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parscc;g' SCC.upf
## parscc removed from LBGNS  ##  #sed -i 's;$SCC_UPF_ROOT_DIR/scc_clamp_clkout.list;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parscc/scc_clamp_clkout.list;g' SCC.upf
## parscc removed from LBGNS  ##  sed -i 's;source $PARSCC_SCANUNIT_UPF_ROOT_DIR/parscc_scanunit_pd_scc_io_aon.upf;## shschmit commented out by FC UPF merge script  source $PARSCC_SCANUNIT_UPF_ROOT_DIR/parscc_scanunit_pd_scc_io_aon.upf;g' parscc_scanunit.upf
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  setenv SPYGLASS_LP_RUN 0
## parscc removed from LBGNS  ##  setenv ENABLE_SLP_RUN 0
## parscc removed from LBGNS  ##  echo "--->---> sub processing PARSCC .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parscc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parscc.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
## parscc removed from LBGNS  ##  unsetenv SPYGLASS_LP_RUN
## parscc removed from LBGNS  ##  unsetenv ENABLE_SLP_RUN
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  cp -f parscc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
## parscc removed from LBGNS  ##  cp -f parscc.inc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
## parscc removed from LBGNS  ##  
## parscc removed from LBGNS  ##  

##------------------------------------------------------------------##
## PARCSMEA
##------------------------------------------------------------------##
## parcsmea removed from LBGNS  ##  echo  "\n ---> Processing PARCSMEA ...." |& tee -a ${LOG_FILE_LOCATION}
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  cd $COLLAGE_WORK/upf/outputs/merge_results
## parcsmea removed from LBGNS  ##  if (-d parcsmea) then
## parcsmea removed from LBGNS  ##      rm -rf parcsmea
## parcsmea removed from LBGNS  ##  endif
## parcsmea removed from LBGNS  ##  mkdir parcsmea
## parcsmea removed from LBGNS  ##  cd parcsmea
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parcsmea_scanunit/* .
## parcsmea removed from LBGNS  ##  cp -f -R $MODEL_ROOT/subIP/csme_ROOT/tools/csme/upf/spth/* .
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parcsmea
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  dos2unix parcsmea_scanunit.upf
## parcsmea removed from LBGNS  ##  dos2unix csmea.upf
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  cp -f $MODEL_ROOT/results/collage/upf/outputs/parcsmea* .
## parcsmea removed from LBGNS  ##  sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parcsmea.upf
## parcsmea removed from LBGNS  ##  sed -i 's;subIP/csme_ROOT/tools/csme/upf/spth;results/collage/upf/outputs/merge_results/parcsmea;g' parcsmea.upf
## parcsmea removed from LBGNS  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parcsmea_scanunit;results/collage/upf/outputs/merge_results/parcsmea;g' parcsmea.upf
## parcsmea removed from LBGNS  ##  sed -i 's;$::env(IP_ROOT)/tools/csme/upf/$::env(SIP_VARIATION)/soc_clt_upf;$env(MODEL_ROOT)/tools/upf/soc_upf;g' csmea.upf
## parcsmea removed from LBGNS  ##  sed -i 's;$::env(IP_ROOT)/tools/csme/upf/$::env(SIP_VARIATION)/csmea.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmea/csmea.inc.tcl;g' csmea.upf
## parcsmea removed from LBGNS  ##  sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' csmea.upf
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  setenv SPYGLASS_LP_RUN 0
## parcsmea removed from LBGNS  ##  setenv ENABLE_SLP_RUN 0
## parcsmea removed from LBGNS  ##  echo "--->---> sub processing PARCSMEA .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
## parcsmea removed from LBGNS  ##  ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmea.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmea.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
## parcsmea removed from LBGNS  ##  unsetenv SPYGLASS_LP_RUN
## parcsmea removed from LBGNS  ##  unsetenv ENABLE_SLP_RUN
## parcsmea removed from LBGNS  ##  
## parcsmea removed from LBGNS  ##  cp -f parcsmea.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
## parcsmea removed from LBGNS  ##  cp -f parcsmea.inc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARCSMEACFMIA
##------------------------------------------------------------------##
echo  "\n ---> Processing PARCSMEACFMIA ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parcsmeacfmia) then
    rm -rf parcsmeacfmia
endif
mkdir parcsmeacfmia
cd parcsmeacfmia

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parcsmeacfmia_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/csme_ROOT/tools/csme/upf/lbg/* .

# Temporary - MJG
#jtn cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_UPF/csmea_cfmia.upf     .
#jtn cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_UPF/csmea_cfmia.inc.tcl .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parcsmeacfmia

dos2unix parcsmeacfmia_scanunit.upf
dos2unix csmea_cfmia.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parcsmeacfmia* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parcsmeacfmia.upf
sed -i 's;subIP/csme_ROOT/tools/csme/upf/lbg;results/collage/upf/outputs/merge_results/parcsmeacfmia;g' parcsmeacfmia.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parcsmeacfmia_scanunit;results/collage/upf/outputs/merge_results/parcsmeacfmia;g' parcsmeacfmia.upf
sed -i 's;$::env(CSME_UPF_PATH)/soc_clt_upf;$env(MODEL_ROOT)/tools/upf/soc_upf;g' csmea_cfmia.upf
sed -i 's;$::env(CSME_UPF_PATH)/csmea_cfmia.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacfmia/csmea_cfmia.inc.tcl;g' csmea_cfmia.upf
sed -i 's;$::env(CSME_UPF_PATH)/csmea_cfmia_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacfmia/csmea_cfmia_ebb_load_upf.tcl;g' csmea_cfmia.upf
sed -i 's;set rfarray_csmea_cfmia(moa_cse_cfmia/cse_cfmia_i/mIA486/lmt_rf_rom/cucrom;set romarray_csmea_cfmia(moa_cse_cfmia/cse_cfmia_i/mIA486/lmt_rf_rom/cucrom;g' csmea_cfmia_ebb_load_upf.tcl
sed -i 's;set rfarray_csmea_cfmia(moa_csmea_rom;set romarray_csmea_cfmia(moa_csmea_rom;g' csmea_cfmia_ebb_load_upf.tcl
sed -i 's;foreach rfebb \[array names rfarray_csmea_cfmia\] {;foreach romebb [array names romarray_csmea_cfmia] {\n    load_upf $env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/$romarray_csmea_cfmia($romebb) -scope "$romebb"\n}\n\nforeach rfebb [array names rfarray_csmea_cfmia] {;g' csmea_cfmia_ebb_load_upf.tcl
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf;g' csmea_cfmia_ebb_load_upf.tcl
sed -i 's;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/ip73;load_upf $env(MODEL_ROOT)/subIP/mem_sram_ROOT/upf/ip73;g' csmea_cfmia_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' csmea_cfmia_ebb_load_upf.tcl
sed -i '$i \}' csmea_cfmia_ebb_load_upf.tcl
sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' csmea_cfmia.upf

sed -i 's;$PARCSMEACFMIA_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacfmia;g' parcsmeacfmia_scanunit.upf

unsetenv ACE_RTL_SIM
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
setenv CSME_MIA_RTL_SIM 1
echo "--->---> sub processing PARCSMEACFMIA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeacfmia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeacfmia.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
#unsetenv CSME_MIA_RTL_SIM

echo "--->---> sub processing PARCSMEACFMIA .... Running for NLP ......" |& tee -a ${LOG_FILE_LOCATION}
setenv ACE_RTL_SIM vcs
setenv ENABLE_NLP_RUN 1
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeacfmia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeacfmia.tcl -inc_file -tag sim -skip_load_upfs "c73p1rf* ip731sr*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv CSME_MIA_RTL_SIM
unsetenv ACE_RTL_SIM

#remove vss connections in NLP
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parcsmeacfmia.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_cfmia_pgd_rf_gated0\S\s*\-ports\s*\S*c73/ d' parcsmeacfmia.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_rom_gated0\S\s*\-ports\s*\S*c73/ d' parcsmeacfmia.sim.upf
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*ip73/ d' parcsmeacfmia.sim.upf

# Connect the IDV control port to fix a bug in the merge script
sed -i '/PARCSMEACFMIA_PWELL_WRAPPER_I_IDVP_FUBLET_PARCSMEACFMIA_PWELL_WRAPPER_2_I_CLAMP0_IDV_PINS/,/}/s#parcsmeacfmia_pwell_wrapper/csmea_cfmia1/moa_cse_cfmia/cfmia_pmc_pfet_ack_b#parcsmeacfmia_pwell_wrapper/i_idvp_fublet_parcsmeacfmia_pwell_wrapper_2/idvtctrlo#g' parcsmeacfmia*.inc*.tcl

## 092614 RJS - per SD request, uniquify vccsram_1p05 for parcsmeacfmia -> vccsramcsmea_1p05
sed -i 's;"vccsram_1p05";"vccsramcsmea_1p05";g' parcsmeacfmia.*.upf

## 11/07/14 JTN - per Diana's request, removing -reuse line from upf
sed -i 's;create_supply_net -domain "pd_pwell_parcsmeacfmia_pd" "vccsramcsmea_1p05" -reuse;;g' parcsmeacfmia.*.upf

## jtn - removing all mIA from .sim.upf so it can run with regular lbgns model
sed -i '/mIA486/d' parcsmeacfmia.sim.upf


cp -f parcsmeacfmia.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacfmia.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacfmia.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacfmia.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARCSMEACSE
##------------------------------------------------------------------##
echo  "\n ---> Processing PARCSMEACSE ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parcsmeacse) then
    rm -rf parcsmeacse
endif
mkdir parcsmeacse
cd parcsmeacse

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parcsmeacse_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/csme_ROOT/tools/csme/upf/lbg/* .

# Temporary - MJG
#jtn cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_UPF/csmea_cse.upf   .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parcsmeacse

dos2unix parcsmeacse_scanunit.upf
dos2unix csmea_cse.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parcsmeacse* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parcsmeacse.upf
sed -i 's;subIP/csme_ROOT/tools/csme/upf/lbg;results/collage/upf/outputs/merge_results/parcsmeacse;g' parcsmeacse.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parcsmeacse_scanunit;results/collage/upf/outputs/merge_results/parcsmeacse;g' parcsmeacse.upf
sed -i 's;$::env(CSME_UPF_PATH)/soc_clt_upf;$env(MODEL_ROOT)/tools/upf/soc_upf;g' csmea_cse.upf
sed -i 's;$::env(CSME_UPF_PATH)/csmea_cse.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacse/csmea_cse.inc.tcl;g' csmea_cse.upf
sed -i 's;$::env(CSME_UPF_PATH)/csmea_cse_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacse/csmea_cse_ebb_load_upf.tcl;g' csmea_cse.upf
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' csmea_cse_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' csmea_cse_ebb_load_upf.tcl
sed -i '$i \}' csmea_cse_ebb_load_upf.tcl
sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' csmea_cse.upf

sed -i 's;$PARCSMEACSE_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeacse;g' parcsmeacse_scanunit.upf

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
unsetenv ACE_RTL_SIM
echo "--->---> sub processing PARCSMEACSE .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeacse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeacse.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ACE_RTL_SIM vcs
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARCSMEACSE .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeacse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeacse.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rfslvm*"|& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv ACE_RTL_SIM

#remove vss connections in NLP
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parcsmeacse.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_cse_pgd_rf_gated0\S\s*\-ports\s*\S*c73/ d' parcsmeacse.sim.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARCSMEACSE_PWELL_WRAPPER_I_IDVP_FUBLET_PARCSMEACSE_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parcsmeacse_pwell_wrapper/csmea_cse1/moa_cse/cse_pmc_pfet_ack_b#parcsmeacse_pwell_wrapper/i_idvp_fublet_parcsmeacse_pwell_wrapper_1/idvtctrlo#g' parcsmeacse*.inc*.tcl

#cp -f parcsmeacse.impl.upf parcsmeacse.merged.upf

cp -f parcsmeacse.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacse.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacse.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeacse.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARPSF3
##------------------------------------------------------------------##

echo  "\n ---> Processing PARPSF3 ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpsf3) then
    rm -rf parpsf3
endif
mkdir parpsf3
cd parpsf3

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpsf3_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpsf3
dos2unix psf20_lnsp_psf3.upf
dos2unix parpsf3_scanunit.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parpsf3* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpsf3.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpsf3_scanunit;results/collage/upf/outputs/merge_results/parpsf3;g' parpsf3.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpsf1_scanunit;results/collage/upf/outputs/merge_results/parpsf3;g' parpsf3.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parpsf3;g' parpsf3.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parpsf3;g' parpsf3.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp;$env(MODEL_ROOT)/tools/upf;g' psf20_lnsp_psf3.upf
sed -i 's;source $PSF20_UPF_ROOT_DIR/lnsp/psf20_lnsp_psf3.iso;## source $PSF20_UPF_ROOT_DIR/lnsp/psf20_lnsp_psf3.iso;g' psf20_lnsp_psf3.upf
sed -i 's;source $PSF20_UPF_ROOT_DIR/psf20_top.upf;## source $PSF20_UPF_ROOT_DIR/psf20_top.upf;g' psf20_lnsp_psf3.upf

sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr0_top.upf
sed -i 's;source ${sbr_upf_scripts_dir}/sbr_config_ipxact_workspace_sbr0.upf;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parpsf3/sbr_config_ipxact_workspace_sbr0.upf;g' sbr_config_ipxact_workspace_sbr0_top.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv SIP_LIBRARY_TYPE d04
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPSF3 .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf3.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf3.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPSF3 .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf3.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf3_sim.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

unsetenv SIP_LIBRARY_TYPE
unsetenv SIP_LIBRARY_VOLTAGE

sed -i 's;subIP/hip_lbg_p1273_memory_2014ww10/rtl/rf/rtl/upf;subIP/mem_rf_ROOT/rtl/upf;g' parpsf3.sim.upf
sed -i 's;subIP/hip_lbg_p1273_memory_2014ww26/rtl/rf/rtl/upf;subIP/mem_rf_ROOT/rtl/upf;g' parpsf3.sim.upf
sed -i '/set_voltage -object_list "vnnprim" -min 0.75 0.75/ a set_voltage -object_list "vnnprim_rf_gated" -min 0.75 0.75' parpsf3.*.upf

#cp parpsf3.impl.upf parpsf3.merged.upf

cp -f parpsf3.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf3.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf3.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf3.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARPSF1
##------------------------------------------------------------------##

echo  "\n ---> Processing PARPSF1 ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpsf1) then
    rm -rf parpsf1
endif
mkdir parpsf1
cd parpsf1

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpsf1_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/sbr_config_ipxact_workspace_sbr1_top.upf .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpsf1
dos2unix sbr_config_ipxact_workspace_sbr1_top.upf
dos2unix psf20_lnsp_psf1.upf
dos2unix parpsf1_scanunit.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parpsf1* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpsf1.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpsf1_scanunit;results/collage/upf/outputs/merge_results/parpsf1;g' parpsf1.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parpsf1;g' parpsf1.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parpsf1;g' parpsf1.upf

sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpsf1_scanunit;results/collage/upf/outputs/merge_results/parpsf1;g' parpsf1_scanunit.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf1.upf
sed -i 's;source $PSF20_UPF_ROOT_DIR/psf20_top.upf;##source $PSF20_UPF_ROOT_DIR/psf20_top.upf;g' psf20_lnsp_psf1.upf

sed -i 's;$::env(IP_ROOT);$env(MODEL_ROOT)/subIP/IP_SBR_ROOT;g' sbr_config_ipxact_workspace_sbr1_top.upf
sed -i 's;source $env(MODEL_ROOT)/subIP/IP_SBR_ROOT/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr1_top.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv SIP_LIBRARY_TYPE d04
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPSF1 .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf1.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf1.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPSF1 .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf1.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf1_sim.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv SIP_LIBRARY_TYPE
unsetenv SIP_LIBRARY_VOLTAGE

sed -i 's;subIP/hip_lbg_p1273_memory_2014ww26/rtl/rf/rtl/upf;subIP/mem_rf_ROOT/rtl/upf;g' parpsf1.*.upf
sed -i '/set_voltage -object_list "vnnprim" -min 0.75 0.75/ a set_voltage -object_list "vnnprim_rf_gated" -min 0.75 0.75' parpsf1.*.upf

cp -f parpsf1.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf1.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf1.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf1.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

parpxp:
##------------------------------------------------------------------##
## PARPXPE                                                          ##
##------------------------------------------------------------------##
echo  "\n ---> Processing PARPXPE ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parpxpe

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpxpe) then
    rm -rf parpxpe
endif
mkdir parpxpe
cd parpxpe
cp -f -R -L $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpxpe_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/pcie2_ROOT/tools/upf/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpxpe
dos2unix pcie.upf
dos2unix parpxpe_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpxpe* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpxpe.upf
sed -i 's;subIP/pcie2_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpxpe;g' parpxpe.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpxpe_scanunit;results/collage/upf/outputs/merge_results/parpxpe;g' parpxpe.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pcie.upf
sed -i 's;load_upf $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/upf/;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' pcie.upf
sed -i 's;{\[info exists synopsys_program_name\] && ($synopsys_program_name == "vcs")};{\[info exists ::env(ENABLE_NLP_RUN)\]};g' pcie.upf


if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
  mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
endif
echo "####################################################"        >  $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# " `(cd $MODEL_ROOT; stat -c %N subIP/pcie2_ROOT)`          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
sed -e "s:pcie2_top\.:$par.${par}_pwell_wrapper.pcie2_top5.:g"                              \
    -e "s: 'sippcie_x4_a_rf_rom1/: '${par}_pwell_wrapper/pcie2_top5/sippcie_x4_a_rf_rom1/:" \
    -e "s/pd_pciemex_cpgd_cm_PGD/pd_pwell_${par}_pd_GATED_0/"                               \
    -e "s/pd_pciemex_vdd_aon/pd_pwell_${par}_pd/"                                           \
    -e "s/(supply ._gated0:0.750)/(supply *_vnnprim_gated:0.750)/"                          \
    -e 's/-comment *"/-comment "pcie2 SIP sippcie2_top.swl: /'                              \
    $MODEL_ROOT/subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# END OF sippcie2_top.swl"                                   >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo ""                                                            >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  cat $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif


setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPXPE .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpe.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPXPE .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpe.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv ENABLE_SLP_RUN

##Remove retention from the partition UPF
mv parpxpe.impl.upf parpxpe.impl1.upf
mv parpxpe.sim.upf parpxpe.sim1.upf

cat parpxpe.impl1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpe.impl.upf
cat parpxpe.sim1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpe.sim.upf

# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpe.impl.upf
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpe.sim.upf

cp -f parpxpe.impl.upf parpxpe.merged.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARPXPE .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpe.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF
mv parpxpe.slp.upf parpxpe.slp1.upf
cat parpxpe.slp1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpe.slp.upf
# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpe.slp.upf

cp -f parpxpe.slp.upf parpxpe.spyglass.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 6/17/2014
sed -i '/PARPXPE_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPE_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parpxpe_pwell_wrapper/pcie2_top5/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpe_pwell_wrapper/i_idvp_fublet_parpxpe_pwell_wrapper_0/idvtctrlo#g' parpxpe*.inc*.tcl
sed -i '/PARPXPE_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPE_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpxpe_pwell_wrapper/pcie2_top5/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpe_pwell_wrapper/i_idvp_fublet_parpxpe_pwell_wrapper_1/idvtctrlo#g' parpxpe*.inc*.tcl

## Copying the files to central area 
#cp -f parpxpe.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f parpxpe.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.


cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpe.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpe.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARPXPD                                                          ##
##------------------------------------------------------------------##
echo  "\n ---> Processing PARPXPD ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parpxpd

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpxpd) then
    rm -rf parpxpd
endif
mkdir parpxpd
cd parpxpd

cp -f -R $MODEL_ROOT/subIP/pcie2_ROOT/tools/upf/* .
cp -f -R -L $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpxpd_scanunit/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpxpd
dos2unix pcie.upf
dos2unix parpxpd_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpxpd* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpxpd.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/upf_global_defs.tcl .
sed -i 's;subIP/pcie2_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpxpd;g' parpxpd.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpxpd_scanunit;results/collage/upf/outputs/merge_results/parpxpd;g' parpxpd.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pcie.upf
sed -i 's;load_upf $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/upf/;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' pcie.upf
sed -i 's;{\[info exists synopsys_program_name\] && ($synopsys_program_name == "vcs")};{\[info exists ::env(ENABLE_NLP_RUN)\]};g' pcie.upf


if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
  mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
endif
echo "####################################################"        >  $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# " `(cd $MODEL_ROOT; stat -c %N subIP/pcie2_ROOT)`          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
sed -e "s:pcie2_top\.:$par.${par}_pwell_wrapper.pcie2_top4.:g"                              \
    -e "s: 'sippcie_x4_a_rf_rom1/: '${par}_pwell_wrapper/pcie2_top4/sippcie_x4_a_rf_rom1/:" \
    -e "s/pd_pciemex_cpgd_cm_PGD/pd_pwell_${par}_pd_GATED_0/"                               \
    -e "s/pd_pciemex_vdd_aon/pd_pwell_${par}_pd/"                                           \
    -e "s/(supply ._gated0:0.750)/(supply *_vnnprim_gated:0.750)/"                          \
    -e 's/-comment *"/-comment "pcie2 SIP sippcie2_top.swl: /'                              \
    $MODEL_ROOT/subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# END OF sippcie2_top.swl"                                   >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo ""                                                            >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  cat $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif


setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPXPD .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpd.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpd.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPXPD .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpd.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpd.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

##Remove retention from the partition UPF
mv parpxpd.impl.upf parpxpd.impl1.upf
mv parpxpd.sim.upf parpxpd.sim1.upf
cat parpxpd.impl1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpd.impl.upf
cat parpxpd.sim1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpd.sim.upf

# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpd.impl.upf
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpd.sim.upf

#cp -f parpxpd.impl.upf parpxpd.merged.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARPXPD .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpd.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpd.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF
mv parpxpd.slp.upf parpxpd.slp1.upf
cat parpxpd.slp1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpd.slp.upf
# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpd.slp.upf

cp -f parpxpd.slp.upf parpxpd.spyglass.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 6/17/2014
sed -i '/PARPXPD_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPD_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parpxpd_pwell_wrapper/pcie2_top4/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpd_pwell_wrapper/i_idvp_fublet_parpxpd_pwell_wrapper_0/idvtctrlo#g' parpxpd*.inc*.tcl
sed -i '/PARPXPD_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPD_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpxpd_pwell_wrapper/pcie2_top4/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpd_pwell_wrapper/i_idvp_fublet_parpxpd_pwell_wrapper_1/idvtctrlo#g' parpxpd*.inc*.tcl

## Copying the files to central area 
#cp -f parpxpd.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f parpxpd.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpd.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpd.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARPXPC                                                          ##
##------------------------------------------------------------------##
echo  "\n ---> Processing PARPXPC ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parpxpc

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpxpc) then
    rm -rf parpxpc
endif
mkdir parpxpc
cd parpxpc

cp -f -R -L $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpxpc_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/pcie2_ROOT/tools/upf/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpxpc
dos2unix parpxpc_scanunit.upf
dos2unix pcie.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpxpc* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpxpc.upf
sed -i 's;subIP/pcie2_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpxpc;g' parpxpc.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpxpc_scanunit;results/collage/upf/outputs/merge_results/parpxpc;g' parpxpc.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pcie.upf
sed -i 's;load_upf $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/upf/;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' pcie.upf
sed -i 's;{\[info exists synopsys_program_name\] && ($synopsys_program_name == "vcs")};{\[info exists ::env(ENABLE_NLP_RUN)\]};g' pcie.upf


if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
  mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
endif
echo "####################################################"        >  $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# " `(cd $MODEL_ROOT; stat -c %N subIP/pcie2_ROOT)`          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
sed -e "s:pcie2_top\.:$par.${par}_pwell_wrapper.pcie2_top3.:g"                              \
    -e "s: 'sippcie_x4_a_rf_rom1/: '${par}_pwell_wrapper/pcie2_top3/sippcie_x4_a_rf_rom1/:" \
    -e "s/pd_pciemex_cpgd_cm_PGD/pd_pwell_${par}_pd_GATED_0/"                               \
    -e "s/pd_pciemex_vdd_aon/pd_pwell_${par}_pd/"                                           \
    -e "s/(supply ._gated0:0.750)/(supply *_vnnprim_gated:0.750)/"                          \
    -e 's/-comment *"/-comment "pcie2 SIP sippcie2_top.swl: /'                              \
    $MODEL_ROOT/subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# END OF sippcie2_top.swl"                                   >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo ""                                                            >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  cat $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif


setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPXPC .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpc.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPXPC .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpc.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN


##Remove retention from the partition UPF
mv parpxpc.impl.upf parpxpc.impl1.upf
mv parpxpc.sim.upf parpxpc.sim1.upf

cat parpxpc.impl1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpc.impl.upf
cat parpxpc.sim1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpc.sim.upf
# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpc.impl.upf
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpc.sim.upf

#cp -f parpxpc.impl.upf parpxpc.merged.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARPXPC .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpc.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF
mv parpxpc.slp.upf parpxpc.slp1.upf
cat parpxpc.slp1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpc.slp.upf
# Remove pwell_wrapper_0_i_clock_idv / pwell_wrapper_0_i_clamp0_idv isolation cells, in this case they are chained within the same domain (to pwell_wrapper_1)
perl -i -ne '$idv0=0 if /^ *set iso_name/; $idv0=1 if /^ *set iso_name \"parpxp._pwell_wrapper_i_idvp_fublet_parpxp._pwell_wrapper_0_i_cl\w*_idv/; $remove=1 if $idv0 && /^(set|map)_isolation\w* \${iso_name}/; s/^/# / if $remove; $remove=0 unless /\\$/; print;' parpxpc.slp.upf

cp -f parpxpc.slp.upf parpxpc.spyglass.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 6/17/2014
sed -i '/PARPXPC_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPC_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parpxpc_pwell_wrapper/pcie2_top3/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpc_pwell_wrapper/i_idvp_fublet_parpxpc_pwell_wrapper_0/idvtctrlo#g' parpxpc*.inc*.tcl
sed -i '/PARPXPC_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPC_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpxpc_pwell_wrapper/pcie2_top3/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpc_pwell_wrapper/i_idvp_fublet_parpxpc_pwell_wrapper_1/idvtctrlo#g' parpxpc*.inc*.tcl

# HSD 5511590  - make  i_idvp_fublet_parpxpc_pwell_wrapper_0 AON (but leave whatever else is there as-is): 
perl -i -ne '$targ = 0 if /}/; $targ = 1 if /PD_PWELL_PARPXPC_PD_GATED_0_ELEMENTS/; print unless ($targ && /i_idvp_fublet_parpxpc_pwell_wrapper_0/);' parpxpc.inc.*.tcl 

## Copying the files to central area 
#cp -f parpxpc.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f parpxpc.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpc.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpc.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARPXPB                                                          ##
##------------------------------------------------------------------##
echo  "\n ---> Processing PARPXPB ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parpxpb

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpxpb) then
    rm -rf parpxpb
endif
mkdir parpxpb
cd parpxpb

cp -f -R -L $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpxpb_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/pcie2_ROOT/tools/upf/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpxpb
dos2unix parpxpb_scanunit.upf
dos2unix pcie.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpxpb* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpxpb.upf
sed -i 's;subIP/pcie2_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpxpb;g' parpxpb.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpxpb_scanunit;results/collage/upf/outputs/merge_results/parpxpb;g' parpxpb.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pcie.upf
sed -i 's;load_upf $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/upf/;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' pcie.upf
sed -i 's;{\[info exists synopsys_program_name\] && ($synopsys_program_name == "vcs")};{\[info exists ::env(ENABLE_NLP_RUN)\]};g' pcie.upf


if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
  mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
endif
echo "####################################################"        >  $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# " `(cd $MODEL_ROOT; stat -c %N subIP/pcie2_ROOT)`          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
sed -e "s:pcie2_top\.:$par.${par}_pwell_wrapper.pcie2_top2.:g"                              \
    -e "s: 'sippcie_x4_a_rf_rom1/: '${par}_pwell_wrapper/pcie2_top2/sippcie_x4_a_rf_rom1/:" \
    -e "s/pd_pciemex_cpgd_cm_PGD/pd_pwell_${par}_pd_GATED_0/"                               \
    -e "s/pd_pciemex_vdd_aon/pd_pwell_${par}_pd/"                                           \
    -e "s/(supply ._gated0:0.750)/(supply *_vnnprim_gated:0.750)/"                          \
    -e 's/-comment *"/-comment "pcie2 SIP sippcie2_top.swl: /'                              \
    $MODEL_ROOT/subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# END OF sippcie2_top.swl"                                   >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo ""                                                            >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  cat $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif


setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPXPB .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpb.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPXPB .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpb.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

##Remove retention from the partition UPF
mv parpxpb.impl.upf parpxpb.impl1.upf
mv parpxpb.sim.upf parpxpb.sim1.upf
cat parpxpb.impl1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpb.impl.upf
cat parpxpb.sim1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpb.sim.upf

#cp parpxpb.impl.upf  parpxpb.merged.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARPXPB .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpb.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF
mv parpxpb.slp.upf parpxpb.slp1.upf
cat parpxpb.slp1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpb.slp.upf

cp -f parpxpb.slp.upf parpxpb.spyglass.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 6/17/2014
sed -i '/PARPXPB_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPB_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpxpb_pwell_wrapper/pcie2_top2/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpb_pwell_wrapper/i_idvp_fublet_parpxpb_pwell_wrapper_1/idvtctrlo#g' parpxpb*.inc*.tcl

## Copying the files to central area 
#cp -f parpxpb.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f parpxpb.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpb.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpb.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto parpxpa

##------------------------------------------------------------------##
## PARIEA
##------------------------------------------------------------------##
##  pariea removed from lbgns  ##  echo  "\n ---> Processing PARIEA ...." |& tee -a ${LOG_FILE_LOCATION}
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  cd $COLLAGE_WORK/upf/outputs/merge_results
##  pariea removed from lbgns  ##  if (-d pariea) then
##  pariea removed from lbgns  ##      rm -rf pariea
##  pariea removed from lbgns  ##  endif
##  pariea removed from lbgns  ##  mkdir pariea
##  pariea removed from lbgns  ##  cd pariea
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/pariea_scanunit/* .
##  pariea removed from lbgns  ##  cp -f -R $MODEL_ROOT/subIP/csme_ROOT/tools/csme/upf/spth/* .
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/pariea
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  dos2unix csmea.upf
##  pariea removed from lbgns  ##  dos2unix pariea_scanunit.upf
##  pariea removed from lbgns  ##  cp -f $MODEL_ROOT/results/collage/upf/outputs/pariea* .
##  pariea removed from lbgns  ##  sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pariea.upf
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pariea.upf
##  pariea removed from lbgns  ##  sed -i 's;subIP/csme_ROOT/tools/csme/upf/spth;results/collage/upf/outputs/merge_results/parcsmea;g' pariea.upf
##  pariea removed from lbgns  ##  sed -i 's;subIP/scanunit_ROOT/tools/upf/out/pariea_scanunit;results/collage/upf/outputs/merge_results/pariea;g' pariea.upf
##  pariea removed from lbgns  ##  sed -i 's;$::env(IP_ROOT)/tools/csme/upf/$::env(SIP_VARIATION)/soc_clt_upf;$env(MODEL_ROOT)/tools/upf/soc_upf;g' csmea.upf
##  pariea removed from lbgns  ##  sed -i 's;$::env(IP_ROOT)/tools/csme/upf/$::env(SIP_VARIATION)/csmea.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pariea/csmea.inc.tcl;g' csmea.upf
##  pariea removed from lbgns  ##  sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' csmea.upf
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  sed -i 's;$PARIEA_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pariea;g' pariea_scanunit.upf
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  setenv SPYGLASS_LP_RUN 0
##  pariea removed from lbgns  ##  setenv ENABLE_SLP_RUN 0
##  pariea removed from lbgns  ##  echo "--->---> sub processing PARIEA .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
##  pariea removed from lbgns  ##  ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pariea.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pariea.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
##  pariea removed from lbgns  ##  unsetenv SPYGLASS_LP_RUN
##  pariea removed from lbgns  ##  unsetenv ENABLE_SLP_RUN
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  ## -- Remap voltage values generated by merge script. 
##  pariea removed from lbgns  ##  ## -- This is caused due to a limitation in the merge script
##  pariea removed from lbgns  ##  sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' pariea.impl.upf
##  pariea removed from lbgns  ##  sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' pariea.impl.upf
##  pariea removed from lbgns  ##  sed -i 's;"vss" N/A;"vss" 0.0;g' pariea.impl.upf
##  pariea removed from lbgns  ##  sed -i 's;vccd_1p0;vccsram_1p05;g' pariea.merged.upf
##  pariea removed from lbgns  ##  sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' pariea.impl.upf
##  pariea removed from lbgns  ##  sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 1.05 1.05;g' pariea.impl.upf
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  
##  pariea removed from lbgns  ##  cp -f pariea.impl.upf pariea.merged.upf

##------------------------------------------------------------------##
## PARIEACFMIA
##------------------------------------------------------------------##
echo  "\n ---> Processing PARIEACFMIA ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parieacfmia) then
    rm -rf parieacfmia
endif
mkdir parieacfmia
cd parieacfmia

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parieacfmia_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/ie_ROOT/tools/csme/upf/lbg_ie/* .

# Temporary - MJG
#jtn using IP upfs cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_UPF/iea_cfmia.upf   .
#jtn using IP upfs cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_IPF/iea_cfmia.inc.tcl .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parieacfmia

dos2unix iea_cfmia.upf
dos2unix parieacfmia_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parieacfmia* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parieacfmia.upf

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parieacfmia.upf
sed -i 's;subIP/ie_ROOT/tools/csme/upf/lbg_ie;results/collage/upf/outputs/merge_results/parieacfmia;g' parieacfmia.upf
sed -i 's;newupf;results/collage/upf/outputs/merge_results/parieacfmia;g' parieacfmia.upf   # MJG -- Hack until new UPF in official area
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parieacfmia_scanunit;results/collage/upf/outputs/merge_results/parieacfmia;g' parieacfmia.upf
sed -i 's;$::env(IE_UPF_PATH)/soc_clt_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' iea_cfmia.upf
sed -i 's;$::env(IE_UPF_PATH)/iea_cfmia.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacfmia/iea_cfmia.inc.tcl;g' iea_cfmia.upf
sed -i 's;$::env(IE_UPF_PATH)/iea_cfmia_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacfmia/iea_cfmia_ebb_load_upf.tcl;g' iea_cfmia.upf
sed -i 's;set rfarray_iea_cfmia(moa_cse_cfmia/cse_cfmia_i/mIA486/lmt_rf_rom/cucrom;set romarray_iea_cfmia(moa_cse_cfmia/cse_cfmia_i/mIA486/lmt_rf_rom/cucrom;g' iea_cfmia_ebb_load_upf.tcl
sed -i 's;set rfarray_iea_cfmia(moa_csmea_rom;set romarray_iea_cfmia(moa_csmea_rom;g' iea_cfmia_ebb_load_upf.tcl
sed -i 's;foreach rfebb \[array names rfarray_iea_cfmia\] {;foreach romebb [array names romarray_iea_cfmia] {\n    load_upf $env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/$romarray_iea_cfmia($romebb) -scope "$romebb"\n}\n\nforeach rfebb [array names rfarray_iea_cfmia] {;g' iea_cfmia_ebb_load_upf.tcl
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf;g' iea_cfmia_ebb_load_upf.tcl
sed -i 's;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/ip73;load_upf $env(MODEL_ROOT)/subIP/mem_sram_ROOT/upf/ip73;g' iea_cfmia_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' iea_cfmia_ebb_load_upf.tcl
sed -i '$i \}' iea_cfmia_ebb_load_upf.tcl
sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' iea_cfmia.upf

sed -i 's;$PARIEACFMIA_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacfmia;g' parieacfmia_scanunit.upf

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
setenv CSME_MIA_RTL_SIM 1
unsetenv ACE_RTL_SIM
echo "--->---> sub processing PARIEACFMIA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieacfmia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieacfmia.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ACE_RTL_SIM vcs
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARIEACFMIA .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieacfmia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieacfmia.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rf* ip731sr*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv ACE_RTL_SIM
unsetenv CSME_MIA_RTL_SIM 1

#remove vss connections in NLP
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parieacfmia.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_cfmia_pgd_rf_gated0\S\s*\-ports\s*\S*c73/ d' parieacfmia.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_rom_gated0\S\s*\-ports\s*\S*c73/ d' parieacfmia.sim.upf
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*ip73/ d' parieacfmia.sim.upf

# Connect the IDV control port to fix a bug in the merge script
sed -i '/PARIEACFMIA_PWELL_WRAPPER_I_IDVP_FUBLET_PARIEACFMIA_PWELL_WRAPPER_2_I_CLAMP0_IDV_PINS/,/}/s#parieacfmia_pwell_wrapper/iea_cfmia1/moa_cse_cfmia/cfmia_pmc_pfet_ack_b#parieacfmia_pwell_wrapper/i_idvp_fublet_parieacfmia_pwell_wrapper_2/idvtctrlo#g' parieacfmia*.inc*.tcl

## -- Remap voltage values generated by merge script. 
## -- This is caused due to a limitation in the merge script
sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' parieacfmia.impl.upf
sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' parieacfmia.impl.upf
sed -i 's;"vss" N/A;"vss" 0.0;g' parieacfmia.impl.upf
#sed -i 's;vccd_1p0;vccsram_1p05;g' parieacfmia.impl.upf
sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' parieacfmia.impl.upf
sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 1.05 1.05;g' parieacfmia.impl.upf

sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' parieacfmia.sim.upf
sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' parieacfmia.sim.upf
sed -i 's;"vss" N/A;"vss" 0.0;g' parieacfmia.sim.upf
#sed -i 's;vccd_1p0;vccsram_1p05;g' parieacfmia.sim.upf
sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' parieacfmia.sim.upf
sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 1.05 1.05;g' parieacfmia.sim.upf



#cp -f parieacfmia.impl.upf parieacfmia.merged.upf

## 092614 RJS - per SD request, uniquify vccsram_1p05 for parieacfmia -> vccsramiea_1p05
sed -i 's;"vccsram_1p05";"vccsramiea_1p05";g' parieacfmia.*.upf

## 11/07/14 JTN - per Diana's request, removing -reuse line from upf
sed -i 's;create_supply_net -domain "pd_pwell_parieacfmia_pd" "vccsramiea_1p05" -reuse;;g' parieacfmia.*.upf

## jtn - removing all mIA from .sim.upf so it can run with regular lbgns model
sed -i '/mIA486/d' parieacfmia.sim.upf

cp -f parieacfmia.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacfmia.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacfmia.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacfmia.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARIEACSE
##------------------------------------------------------------------##
echo  "\n ---> Processing PARIEACSE ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parieacse) then
    rm -rf parieacse
endif
mkdir parieacse
cd parieacse

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parieacse_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/ie_ROOT/tools/csme/upf/lbg_ie/* .

# Temporary - MJG
#jtn using IP upfs now cp -f $MODEL_ROOT/tools/upf/temp_RTL0.8_UPF/iea_cse.upf   .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parieacse

dos2unix iea_cse.upf
dos2unix parieacse_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parieacse* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parieacse.upf

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parieacse.upf
sed -i 's;subIP/ie_ROOT/tools/csme/upf/lbg_ie;results/collage/upf/outputs/merge_results/parieacse;g' parieacse.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parieacse_scanunit;results/collage/upf/outputs/merge_results/parieacse;g' parieacse.upf
sed -i 's;$::env(IE_UPF_PATH)/soc_clt_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' iea_cse.upf
sed -i 's;$::env(IE_UPF_PATH)/iea_cse.inc.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacse/iea_cse.inc.tcl;g' iea_cse.upf
sed -i 's;$::env(IE_UPF_PATH)/iea_cse_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacse/iea_cse_ebb_load_upf.tcl;g' iea_cse.upf
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' iea_cse_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' iea_cse_ebb_load_upf.tcl
sed -i '$i \}' iea_cse_ebb_load_upf.tcl
sed -i 's;$SRAM_PRIM_SUPPLY_NOM;$SRAM_SUPPLY_NOM;g' iea_cse.upf

sed -i 's;$PARIEACSE_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieacse;g' parieacse_scanunit.upf

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
unsetenv ACE_RTL_SIM
echo "--->---> sub processing PARIEACSE .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieacse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieacse.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
setenv ACE_RTL_SIM vcs
echo "--->---> sub processing PARIEACSE .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieacse.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieacse.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rfslvm*"|& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv ACE_RTL_SIM

#remove vss connections in NLP
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parieacse.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_cse_pgd_rf_gated0\S\s*\-ports\s*\S*c73/ d' parieacse.sim.upf

## -- Remap voltage values generated by merge script. 
## -- This is caused due to a limitation in the merge script
sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' parieacse.impl.upf
sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' parieacse.impl.upf
sed -i 's;"vss" N/A;"vss" 0.0;g' parieacse.impl.upf
##sed -i 's;vccd_1p0;vccsram_1p05;g' parieacse.merged.upf
sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' parieacse.impl.upf
sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 1.05 1.05;g' parieacse.impl.upf

sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' parieacse.sim.upf
sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' parieacse.sim.upf
sed -i 's;"vss" N/A;"vss" 0.0;g' parieacse.sim.upf
##sed -i 's;vccd_1p0;vccsram_1p05;g' parieacse.merged.upf
sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' parieacse.sim.upf
sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 1.05 1.05;g' parieacse.sim.upf


## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARIEACSE_PWELL_WRAPPER_I_IDVP_FUBLET_PARIEACSE_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parieacse_pwell_wrapper/iea_cse1/moa_cse/cse_pmc_pfet_ack_b#parieacse_pwell_wrapper/i_idvp_fublet_parieacse_pwell_wrapper_0/idvtctrlo#g' parieacse*.inc*.tcl

sed -i '/PARIEACSE_PWELL_WRAPPER_I_IDVP_FUBLET_PARIEACSE_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parieacse_pwell_wrapper/iea_cse1/moa_cse/cse_pmc_pfet_ack_b#parieacse_pwell_wrapper/i_idvp_fublet_parieacse_pwell_wrapper_1/idvtctrlo#g' parieacse*.inc*.tcl

#cp -f parieacse.impl.upf parieacse.merged.upf

cp -f parieacse.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacse.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacse.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieacse.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARDSP
##------------------------------------------------------------------##
echo  "\n ---> Processing PARDSP ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d pardsp) then
    rm -rf pardsp
endif
mkdir pardsp
cd pardsp

#cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
cp -f -R $MODEL_ROOT/subIP/hdas_ROOT/tools/upf/hda/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/pardsp_scanunit/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/pardsp

#dos2unix sbr_config_ipxact_workspace_sbr10_top.upf
dos2unix pardsp_scanunit.upf
dos2unix HDA.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/pardsp* .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/pardsp_design_attributes.txt .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pardsp.upf
sed -i 's;subIP/hdas_ROOT/tools/upf/hda;results/collage/upf/outputs/merge_results/pardsp;g' pardsp.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/pardsp_scanunit;results/collage/upf/outputs/merge_results/pardsp;g' pardsp.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/pardsp;g' pardsp.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' HDA.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pardsp;g' sbr_config_ipxact_workspace_sbr10_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr10_top.upf
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/pardsp_hsd5511970_ECO.txt .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/pardsp_hsd5511970_eco_slp_tcl.txt .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/pardsp_hsd5511970_eco_impl_tcl.txt .

unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
echo "--->---> sub processing PARDSP .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardsp.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardsp.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARDSP .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardsp.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardsp.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN


##Remove retention from the partition UPF(impl)
cp -f pardsp.impl.upf pardsp.impl.upf_wret
cp -f pardsp.sim.upf pardsp.sim.upf_wret

cat pardsp.impl.upf_wret | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> pardsp.impl.upf_woret
cat pardsp.sim.upf_wret | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> pardsp.sim.upf_woret

cp -f pardsp.impl.upf_woret pardsp.merged.upf
cp -f pardsp.impl.upf_woret pardsp.impl.upf
cp -f pardsp.sim.upf_woret pardsp.sim.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARDSP .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardsp.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardsp.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF (slp)
cp -f pardsp.slp.upf pardsp.slp.upf_wret

cat pardsp.slp.upf_wret | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> pardsp.slp.upf_woret

cp -f pardsp.slp.upf_woret pardsp.slp.upf


## Workaround to an issue of enable created by merge script. svaradh1 5/27/2014
sed -i '/PARDSP_PWELL_WRAPPER_I_IDVP_FUBLET_PARDSP_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#pardsp_pwell_wrapper/hda1/hdamrf1/hdadsp1_mem_fet_en_b#pardsp_pwell_wrapper/i_idvp_fublet_pardsp_pwell_wrapper_0/idvtctrlo#g' pardsp*.inc*.tcl
sed -i '/PARDSP_PWELL_WRAPPER_I_IDVP_FUBLET_PARDSP_PWELL_WRAPPER_4_I_CLAMP0_IDV_PINS/,/}/s#pardsp_pwell_wrapper/hda1/hdamrf1/hdadma_mem_fet_en_b#pardsp_pwell_wrapper/i_idvp_fublet_pardsp_pwell_wrapper_4/idvtctrlo#g' pardsp*.inc*.tcl

## path changes to EBB pins -- file bug on IP UPF -- HDA.upf : rjs: 081314  HSD#5510831
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk1.l1icache_i1_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1icache_i1_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk2.l1icache_i0_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1icache_i0_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk7.l1dcache_d1m_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1dcache_d1m_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk8.l1dcache_d0m_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1dcache_d0m_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk9.l1dcache_d1l_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1dcache_d1l_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp0_gen/genblk10.l1dcache_d0l_w;hdamsr1/hdamsr_l1sramdsp0_gen/\\l1dcache_d0l_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk1.l1icache_i1_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1icache_i1_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk2.l1icache_i0_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1icache_i0_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk7.l1dcache_d1m_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1dcache_d1m_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk8.l1dcache_d0m_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1dcache_d0m_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk9.l1dcache_d1l_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1dcache_d1l_w;g' pardsp.*.upf
sed -i 's;hdamsr1/hdamsr_l1sramdsp1_gen/genblk10.l1dcache_d0l_w;hdamsr1/hdamsr_l1sramdsp1_gen/\\l1dcache_d0l_w;g' pardsp.*.upf
sed -i 's;hdamrf1/genhdamrf_l2tlbrf_genhdamrf_l2tlbrfwork.hdamrf_l2tlbrf_gen/genblk2.l2tlbrf_ebb1;hdamrf1/genhdamrf_l2tlbrf_genhdamrf_l2tlbrfwork.hdamrf_l2tlbrf_gen/genblk3.l2tlbrf_ebb1;g' pardsp.*.upf

## insert missign isolation: HSD #5510829  : rjs: 081514
sed -i '/set PARDSP_PWELL_WRAPPER_HDA1_PD_HDAPGD1_PGD_TO_PD_CORE_PINS {/a pardsp_pwell_wrapper/hda1/hdamro1/genhdamro_l2rom_genhdamro_l2romwork_lbg.hdamro_l2rom_gen/aary_LV_WSO_l2rom' pardsp.inc.*.tcl
sed -i '/set PARDSP_PWELL_WRAPPER_HDA1_PD_HDAPGD1_PGD_TO_PD_CORE_PINS {/a pardsp_pwell_wrapper/hda1/hdamrf1/genhdamrf_l2tlbrf_genhdamrf_l2tlbrfwork.hdamrf_l2tlbrf_gen/aary_LV_WSO_l2tlbrf' pardsp.inc.*.tcl


## Copying the files to one area 
#cp -f pardsp.impl.upf $COLLAGE_WORK/upf/outputs/.
#cp -f pardsp.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

## NLP/VCS changes
# remove "connect_supply_net vss" lines for EBBs/RFs 
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' pardsp.sim.upf
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*ip731/ d' pardsp.sim.upf
# remove "connect_supply_net ...vccdgt_1p0" lines (both ro and rf)
sed -i '/^\s*connect_supply_net\s*\Svnnprim_r._gated.\S\s*\-ports\s*\S*c73/ d' pardsp.sim.upf
# revmoe "connect_supply_net ...vccramxxxsi0_1p03" lines for srams
#sed -i '/^\s*connect_supply_net\s*\Svccsram_1p05\S\s*\-ports\s*\S*ip73/ d' pardsp.sim.upf
# add load_upfs for EBBs/ROMs
sed -i '/source $::env(UPF_INSTALL_DIR)\/pardsp.inc.sim.tcl/r pardsp_design_attributes.txt' pardsp.sim.upf


## 092614 RJS - per SD request, uniquify vccsram_1p05 for pardsp -> vccsramdsp_1p05
sed -i 's;vccsram_1p05;vccsramdsp_1p05;g' pardsp.*.upf*
# remove extra create supply net - causing fev tool to crash
sed -i 's;create_supply_net -domain "pd_pwell_pardsp_pd" "vccsramdsp_1p05" -reuse;;g' pardsp.*.upf*

## 012915 RJS - HSD5511970 ECO -
sed -i '/# --- All remaining top-level CSNs/r pardsp_hsd5511970_ECO.txt' pardsp.*.upf
sed -i '/pardsp_pwell_wrapper\/hda1\/hdas1\/hdah1\/hdahc1\/hdahc_dec1\/wake_prim_gclk/ d' pardsp.inc.*.tcl
cat pardsp_hsd5511970_eco_slp_tcl.txt >> pardsp.inc.slp.tcl
cat pardsp_hsd5511970_eco_impl_tcl.txt >> pardsp.inc.impl.tcl 
cat pardsp_hsd5511970_eco_impl_tcl.txt >> pardsp.inc.sim.tcl


cp -f pardsp.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardsp.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardsp.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardsp.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardsp.slp.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardsp.inc.slp.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## 151219 UMDREJAB: PARDSP AOECO8 + IDV port connection [pardsp_b0_nov102015_fix2]
##------------------------------------------------------------------##
# remove "connect_supply_net ...vccdgt_1p0" lines (both rom and rf)
sed -i '/^\s*connect_supply_net\s*\Svnnprim_r._gated.\S\s*\-ports\s*\S*c73/ d' $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.sim.upf
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.slp.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f $MODEL_ROOT/tools/upf/pardsp_upf/pardsp.inc.slp.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARXHCIA
##------------------------------------------------------------------##

echo  "\n ---> Processing PARXHCIA ...." |& tee -a ${LOG_FILE_LOCATION}
setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs/merge_results/parxhcia
echo "UPF_INSTALL_DIR: $UPF_INSTALL_DIR" |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parxhcia) then
    rm -rf parxhcia
endif
mkdir parxhcia
cd parxhcia
cp -f -R $MODEL_ROOT/subIP/usb3_ROOT/tools/upf/LBG/xhci_upf/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parxhcia_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parxhcia
cp -f $MODEL_ROOT/results/collage/upf/outputs/parxhcia* .
cp -f $MODEL_ROOT/results/collage/upf/outputs/upf_global* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parxhcia.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parxhcia;g' parxhcia.upf
sed -i 's;subIP/usb3_ROOT/tools/upf/LBG/xhci_upf;results/collage/upf/outputs/merge_results/parxhcia;g' parxhcia.upf
sed -i 's;::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE);env(MODEL_ROOT)/tools/upf/soc_upf;g' sbr_config_ipxact_workspace_sbr2_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcia;g' sbr_config_ipxact_workspace_sbr2_top.upf
sed -i 's;::env(IP_ROOT)/tools/upf/$::env(SIP_VARIATION);env(MODEL_ROOT)/tools/upf;g' XHCI.upf
sed -i 's;source $XHCI_UPF_ROOT_DIR/XHCI_upf.cfg;#source $XHCI_UPF_ROOT_DIR/XHCI_upf.cfg;g' XHCI.upf
sed -i 's;XHCI_UPF_ROOT_DIR/XHCI_isolation.upf;env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcia/XHCI_isolation.upf;g' XHCI.upf
sed -i 's;${SOC_SUPPLY_PORT}_gated1;pd_pwell_parxhcia_pd_GATED_0_vnnprim_gated;g' XHCI.upf

##################################################################################################
##temp workaround until we resolve vccusbdsw related supplies.
#sed -i 's;vccusbdsw_1p0;vnnprim;g' parxhcia_set_voltage.tcl
#sed -i 's;vccdsw_1p0;vnnprim;g' parxhcia_set_voltage.tcl

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARXHCIA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcia.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

cp XHCI.upf XHCI.upf.impl

setenv ENABLE_NLP_RUN 1
sed -i 's;$RF1_ROOT;$::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl;g' XHCI.upf
sed -i 's;$VCS_ENV;1;g' XHCI.upf
#sed -i 's;-domain ${rf}/pd_ebb;-domain ${rf};g' XHCI.upf
cp XHCI.upf XHCI.upf.sim

echo "--->---> sub processing PARXHCIA .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcia.tcl  -inc_file -tag sim -set_vars "VCS_ENV 1" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
# Remove supply connections to EBB vss ports
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parxhcia.sim.upf
setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs
echo "UPF_INSTALL_DIR: $UPF_INSTALL_DIR" |& tee -a ${LOG_FILE_LOCATION}

## FILE HSD for these missing ISO violations in sip_usb3-lbg-a0-14ww30_mux_fix2. ################################################
sed -i '/PARXHCIA_PWELL_WRAPPER_USBX_USB3_COM1_PD_XHCI_CORE_PGD_TO_PD_XHCI_AON_1_PINS/a \    parxhcia_pwell_wrapper/usbx_usb3_com1/usbx_usb3_gate/uxpa_uxcao_dsp_disconnect_flag[0]' parxhcia.inc.*.tcl
sed -i '/PARXHCIA_PWELL_WRAPPER_USBX_USB3_COM1_PD_XHCI_CORE_PGD_TO_PD_XHCI_AON_1_PINS/a \    parxhcia_pwell_wrapper/usbx_usb3_com1/usbx_usb3_gate/uxpa_uxcao_dsp_disconnect_flag[1]' parxhcia.inc.*.tcl
sed -i '/PARXHCIA_PWELL_WRAPPER_USBX_USB3_COM1_PD_XHCI_CORE_PGD_TO_PD_XHCI_AON_1_PINS/a \    parxhcia_pwell_wrapper/usbx_usb3_com1/usbx_usb3_gate/allow_power_gate_flag' parxhcia.inc.*.tcl
#################################################################################################################################
#sed -i '/PARXHCIA_PWELL_WRAPPER_I_IDVP_FUBLET_PARXHCIA_PWELL_WRAPPER_3_I_CLAMP0_IDV_PINS/a \    parxhcia_pwell_wrapper/i_idvp_fublet_parxhcia_pwell_wrapper_3/idvtctrlo' parxhcia.inc.*.tcl
#parxhcia.parxhcia_pwell_wrapper.i_idvp_fublet_parxhcia_pwell_wrapper_3.idvtctrlo

sed -i 's;usbx_usb3_com1/usbx_usb3_ao/ux_enginepgd_fet_en_ack_b;i_idvp_fublet_parxhcia_pwell_wrapper_3/idvtctrlo;g' parxhcia.inc.*.tcl
#sed -i 's;isolation_power_net "vnnprim_gated1";isolation_power_net "pd_pwell_parxhcia_pd_GATED_0_vnnprim_gated";g' parxhcia.*.upf
sed -i 's;create_supply_net -domain "pd_pwell_parxhcia_pd_GATED_0" "vnnprim_gated1";## shschmit create_supply_net -domain "pd_pwell_parxhcia_pd_GATED_0" "vnnprim_gated1";g' parxhcia.*.upf
sed -i 's;vccusbdsw_1p0;vnnprim;g' parxhcia.*.upf
sed -i 's;vccrtcwell1p5_ehv;vnnprim;g' parxhcia.*.upf
sed -i 's;vccdsw_1p0;vnnprim;g' parxhcia.*.upf
sed -i '/set_voltage -object_list "vss" 0.0/a \    set_voltage -object_list "vnnprim_rf_gated1" -min 0.75 0.75' parxhcia.impl.upf
sed -i '/set_voltage -object_list "vss" 0.0/a \    set_voltage -object_list "vnnprim_rf_gated2" -min 0.75 0.75' parxhcia.impl.upf
sed -i 's;create_power_domain "pd_pwell_parxhcia_pd_GATED_0" -elements $PD_PWELL_PARXHCIA_PD_GATED_0_ELEMENTS;hagan create_power_domain "pd_pwell_parxhcia_pd_GATED_0" -elements $PD_PWELL_PARXHCIA_PD_GATED_0_ELEMENTS;g' parxhcia.*.upf
sed -i 's;create_supply_net -domain "pd_pwell_parxhcia_pd_GATED_0" "pd_pwell_parxhcia_pd_GATED_0_vnnprim_gated";hagan create_supply_net -domain "pd_pwell_parxhcia_pd_GATED_0" "pd_pwell_parxhcia_pd_GATED_0_vnnprim_gated";g' parxhcia.*.upf
sed -i 's;# --- Merged UPF generated by merge_upf;hagan # --- Merged UPF generated by merge_upf;g' parxhcia.*.upf

sed -i 's;source $::env(UPF_INSTALL_DIR)/parxhcia.inc.impl.tcl;hagan source $::env(UPF_INSTALL_DIR)/parxhcia.inc.impl.tcl;g' parxhcia.impl.upf
sed -i 's;source $::env(UPF_INSTALL_DIR)/parxhcia.inc.sim.tcl;hagan source $::env(UPF_INSTALL_DIR)/parxhcia.inc.sim.tcl;g' parxhcia.sim.upf

sed -i 's;# --- Begin TOP domain: pd_pwell_parxhcia_pd;hagan # --- Begin TOP domain: pd_pwell_parxhcia_pd;g' parxhcia.*.upf
#sed -i 's;;;g' parxhcia.*.upf

mv parxhcia.impl.upf parxhcia.impl.upf.temp
mv parxhcia.sim.upf parxhcia.sim.upf.temp

grep '^\hagan' parxhcia.impl.upf.temp > parxhcia.impl.upf
grep -v '^\hagan' parxhcia.impl.upf.temp >> parxhcia.impl.upf
grep '^\hagan' parxhcia.sim.upf.temp > parxhcia.sim.upf
grep -v '^\hagan' parxhcia.sim.upf.temp >> parxhcia.sim.upf
sed -i '/hagan/a \    ' parxhcia.*.upf

sed -i 's;hagan ;;g' parxhcia.*.upf
sed -i 's;mode_atpg;mode_ramseq;g' parxhcia.*.upf
sed -i 's;mode_atpg;mode_ramseq;g' parxhcia.inc.*.tcl

#comment out retention
mv parxhcia.impl.upf parxhcia.impl.upf.with.retention
mv parxhcia.sim.upf parxhcia.sim.upf.with.retention
cat parxhcia.impl.upf.with.retention | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next  }1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> parxhcia.impl.upf
cat parxhcia.sim.upf.with.retention | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next  }1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> parxhcia.sim.upf

sed -i 's;usbx_usb3_com1/usbx_usb3_ao/ux_enginepgd_fet_en_ack_b;i_idvp_fublet_parxhcia_pwell_wrapper_3/idvtctrlo;g' parxhcia.inc.*.tcl 

#cp -f parxhcia.impl.upf parxhcia.merged.upf

## 150811 Uzair: HSD #5512612 set_related_supply_net for following 3 pins should be vnnprim:
##		pmsyncclk1_func_data_in
##		pmsyncclk2_func_data_in
##		bmcclk_func_data_in

sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "bmcclk_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "bmcclk_func_data_in"\]/' parxhcia.*.upf
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "pmsyncclk1_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "pmsyncclk1_func_data_in"\]/' parxhcia.*.upf
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "pmsyncclk2_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "pmsyncclk2_func_data_in"\]/' parxhcia.*.upf

sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "bmcclk_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "bmcclk_func_data_in"/' parxhcia.*.upf
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "pmsyncclk1_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "pmsyncclk1_func_data_in"/' parxhcia.*.upf
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "pmsyncclk2_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "pmsyncclk2_func_data_in"/' parxhcia.*.upf

sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "bmcclk_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "bmcclk_func_data_in"\]/' parxhcia.inc.*.tcl
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "pmsyncclk1_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "pmsyncclk1_func_data_in"\]/' parxhcia.inc.*.tcl
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "pmsyncclk2_func_data_in"\]/set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "pmsyncclk2_func_data_in"\]/' parxhcia.inc.*.tcl

sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "bmcclk_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "bmcclk_func_data_in"/' parxhcia.inc.*.tcl
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "pmsyncclk1_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "pmsyncclk1_func_data_in"/' parxhcia.inc.*.tcl
sed -i 's/set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "pmsyncclk2_func_data_in"/set_related_supply_net -power "vnnprim" -ground "vss" -object_list "pmsyncclk2_func_data_in"/' parxhcia.inc.*.tcl

## 150703 Uzair: #5512055 Remove vcca_dig_1p05
sed -i '/"vcca_dig_1p05"/d' parxhcia.*.upf
sed -i '/"vcca_dig_1p05"/d' parxhcia.inc.*.tcl

##### 080115 -- RJS -- remove vcca_dig_1p05 LS info from UPF and .tcl files
##upf:
sed -i '/set_domain_supply_net "pd_pwell_parxhcia_pd"/,/-primary_ground_net "vss"/a BEGIN_VCCA_DIG_1P05_LS_REMOVAL' parxhcia.*.upf
sed -i '/# --- End TOP domain: pd_pwell_parxhcia_pd/i END_VCCA_DIG_1P05_LS_REMOVAL' parxhcia.*.upf
sed -i '/BEGIN_VCCA_DIG_1P05_LS_REMOVAL/,/END_VCCA_DIG_1P05_LS_REMOVAL/d' parxhcia.*.upf
sed -i '/set_domain_supply_net "pd_pwell_parxhcia_pd" \\/a \  -primary_power_net "vnnprim" \\' parxhcia.*.upf
sed -i '/^  -primary_power_net "vnnprim" \\/a \  -primary_ground_net "vss"' parxhcia.*.upf

##tcl:
sed -i '/# --- Pins of LS pd_pwell_parxhcia_pd_isclk1_to_clockse_bscan_block1_vcca_dig_1p05_vnnprim_ls/i BEGIN_VCCA_DIG_1P05_LS_REMOVAL' parxhcia.inc.*.tcl
sed -i '/# --- Elements of domain parxhcia_pwell_wrapper_usbx_usb3_com1_pd_rf_gated1/i END_VCCA_DIG_1P05_LS_REMOVAL' parxhcia.inc.impl.tcl
sed -i '/# --- Elements of domain pd_pwell_parxhcia_pd_GATED_0/i END_VCCA_DIG_1P05_LS_REMOVAL' parxhcia.inc.sim.tcl
sed -i '/BEGIN_VCCA_DIG_1P05_LS_REMOVAL/,/END_VCCA_DIG_1P05_LS_REMOVAL/d' parxhcia.inc.*.tcl

##150902 Uzair: HSD #5512613 HSD closed as "not a bug"
##150819 Uzair: HSD #5512613 "PARXHCIB_PWELL_WRAPPER_USBX_DEV_COM1_SR_XDCI_CORE_PGD_ELEMENTS " list incorrect. Root caused is XDCI sr_list 
##150902 sed -i 's/mux_body\/visa2_registers\.deserializer\/secure_deser\.front_end/deserializer/g' parxhcia.inc.*.tcl

cp -f parxhcia.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parxhcia.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parxhcia.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parxhcia.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

parsata:
##------------------------------------------------------------------##
## PARSATA
##------------------------------------------------------------------##
echo  "\n ---> Processing PARSATA ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parsata

## -- Copy over SATA UPF as it needs to be cleaning up before merging
cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parsata) then
    rm -rf parsata
endif
mkdir parsata
cd parsata

cp -f -R -L $MODEL_ROOT/subIP/sata3_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parsata_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parsata
dos2unix sata.upf
dos2unix parsata_scanunit.upf
dos2unix sbr_config_ipxact_workspace_sbr3_top.upf
dos2unix psf20_lnsp_psf4.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parsata* .
cp -f $MODEL_ROOT/results/collage/upf/outputs/upf_global_defs.tcl .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parsata.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parsata;g' parsata.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parsata;g' parsata.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parsata_scanunit;results/collage/upf/outputs/merge_results/parsata;g' parsata.upf
sed -i 's;subIP/sata3_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parsata;g' parsata.upf

sed -i 's;$PARSATA_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parsata;g' parsata_scanunit.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf4.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf4.upf
sed -i 's;$PSF20_UPF_ROOT_DIR/lnsp;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parsata;g' psf20_lnsp_psf4.upf
#sed -i 's;$PSF20_UPF_ROOT_DIR/lnsp;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parsata;g' psf20_lnsp_psf4.upf
#sed -i 's;$PSF20_UPF_ROOT_DIR/psf20;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parsata/psf20;g' psf20_lnsp_psf4.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/subIP/IP_SBR_ROOT/tools/upf/soc_upf_d04.cfg;g' sbr_config_ipxact_workspace_sbr0_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/subIP/IP_SBR_ROOT/tools/upf/router;g' sbr_config_ipxact_workspace_sbr0_top.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/rtl;$env(MODEL_ROOT)/subIP/hip_rf_ROOT/rtl/upf;g' sata.upf
sed -i 's;connect_supply_net ${SOC_SUPPLY_PORT}_gated0;connect_supply_net ${SOC_SUPPLY_PORT};g' sata.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr3_top.upf
sed -i 's;${sbr_upf_scripts_dir};$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parsata;g' sbr_config_ipxact_workspace_sbr3_top.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
# clear sip upf dependency variable for syn 
if ( $?ACE_RTL_SIM ) then
  set ace_rtl_sim_val = $ACE_RTL_SIM
  unsetenv ACE_RTL_SIM
endif
echo "--->---> sub processing PARSATA .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parsata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parsata.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

#unsetenv SIP_LIBRARY_VOLTAGE
#setenv SIP_LIBRARY_VOLTAGE 0.75
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARSATA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parsata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parsata.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
setenv ENABLE_NLP_RUN 1
setenv ACE_RTL_SIM vcs
echo "--->---> sub processing PARSATA .... Running for SIM ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parsata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parsata.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv IP_ROOT
unsetenv SIP_LIBRARY_VOLTAGE
if ( $?ace_rtl_sim_val ) then
  setenv ACE_RTL_SIM $ace_rtl_sim_val
  unset ace_rtl_sim_val
else
  unsetenv ACE_RTL_SIM
endif

### Now remove load_upf c73* directives from impl
sed -i '/hip_rf_ROOT/d' parsata.impl.upf

## remove vss connections in nlp
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parsata.sim.upf


## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARSATA_PWELL_WRAPPER_I_IDVP_FUBLET_PARSATA_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parsata_pwell_wrapper/st1/sata_sip_core_pgd1/st_rf_rom_wrapper1/vp_st_ram_01_fet_en_b#parsata_pwell_wrapper/i_idvp_fublet_parsata_pwell_wrapper_0/idvtctrlo#g' parsata*.inc*.tcl

#cp -f parsata.impl.upf parsata.merged.upf
cp -f $par.impl.upf             $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp -f parsata.inc.impl.tcl      $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parsata.sim.upf           $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parsata.inc.sim.tcl       $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript

##------------------------------------------------------------------##
## PARFIA
##------------------------------------------------------------------##
echo  "\n ---> Processing PARFIA ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parfia) then
    rm -rf parfia
endif
mkdir parfia
cd parfia


##Copy all colllage generated upf output files for this partition to current directory
cp -f $MODEL_ROOT/results/collage/upf/outputs/parfia* .
rm -f parfia20*   ##RJS: ONLy have parfia contents in this directory

##Copy all subIP UPF for this parititon to current directory and make UNIX clean
cp -f    $MODEL_ROOT/subIP/fia1_ROOT/tools/upf/sipfia1.upf .
cp -f    $MODEL_ROOT/subIP/hip_wm26_ROOT/rtl/upf/* .
dos2unix sipfia1.upf 
dos2unix c73p1wmhybridx26familyew.upf

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parfia

##edit partition UPF file for synthesis
sed -i 's;subIP/fia1_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parfia;g' parfia.upf
sed -i 's;subIP/hip_wm26_ROOT/rtl/upf;results/collage/upf/outputs/merge_results/parfia;g' parfia.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73p1wmhybridx26familyew.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1wmlanetopew.upf 
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1wmcmnlane_hptopew.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1wmcmnlane_lptopew.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1plllccorelppwrgatetop.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1plllccorelptop.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73p1hspllebblp_top.upf
sed -i 's;$::env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia;g' c73hybr26_c73p1wmpllebb_corelppwrgatetop.upf

sed -i 's;echo;#echo;g' c73p1wmhybridx26familyew.upf
##edits for NLP -- prevents conflicts between parfia and parfia20 
sed -i '/set numComLanes 2/a set hybrid_common_mst2_out_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numComLanes 2/a set hybrid_common_mst1_out_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numComLanes 2/a set hybrid_common_mst0_out_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numComLanes 2/a set hybrid_common_mst2_in_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numComLanes 2/a set hybrid_common_mst1_in_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numComLanes 2/a set hybrid_common_mst0_in_ports ""' c73p1wmhybridx26familyew.upf
sed -i '/set numDatLanes 25/a set hybrid_datalane_out_ports ""' c73p1wmhybridx26familyew.upf 
sed -i '/set numDatLanes 25/a set hybrid_datalane_in_ports ""' c73p1wmhybridx26familyew.upf


setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARFIA .... Running for DC/SLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1wmhybridx26familyew*" |& tee -a ${LOG_FILE_LOCATION} 
unsetenv ENABLE_SLP_RUN
unsetenv SPYGLASS_LP_RUN
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARFIA .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia.tcl -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1wmhybridx26familyew*" |& tee -a ${LOG_FILE_LOCATION} 
unsetenv ENABLE_NLP_RUN
unsetenv IP_ENABLE_ALL
#  setenv SIP_LIBRARY_VOLTAGE

##use original slp.upf for sim because it loads the upf for WM26
####### TEMP shschmit  #####  cp -f parfia.slp.upf parfia.sim.upf
##Comment out load_upf line for wm26 (SPYGLASS/DC only)
sed -i 's;load_upf;#RJS: commented out for SLP runs: load_upf;g' parfia.impl.upf
##change abut signal from WM20 to WM26 voltage domain
#sed -i 's;vccauppcie2pll_1p05;vccapcie2pll_1p05;g' parfia.*.upf
##Change isclk refclk voltage domain from vcca_nssc_1p05 to parfia related voltage domain
sed -i 's;vcca_nssc_1p05;vccapcie2pll_1p05;g' parfia.*.upf
#####->080115- isclk voltage change vcca_nssc_1p05 to vcca_dig_1p05 --- need to change above command:
sed -i 's;vcca_dig_1p05;vccapcie2pll_1p05;g' parfia.*.upf
##--110415:RJS: Remove parfia.inc.impl.upf from parfia.impl.upf: reason (empty file)
sed -i '/source $::env(UPF_INSTALL_DIR)\/parfia.inc.impl.tcl/d' parfia.impl.upf

#cp -f parfia.slp.upf parfia.impl.upf


#setenv SPYGLASS_LP_RUN 0
#setenv ENABLE_SLP_RUN 0
#echo "--->---> sub processing PARFIA .... Running for VCS ....." |& tee -a ${LOG_FILE_LOCATION}
#${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia.tcl  -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1wmhybridx26familyew*" |& tee -a ${LOG_FILE_LOCATION}
#unsetenv SPYGLASS_LP_RUN
#unsetenv ENABLE_SLP_RUN
#cp -f parfia.vcs.upf parfia.merged.upf


## Copying the files to central area 
## cp -f parfia.impl.upf $COLLAGE_WORK/upf/outputs/parfia.merged.upf

cp -f parfia.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfia.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfia.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
#cp -f parfia.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARDFX
##------------------------------------------------------------------##

echo  "\n ---> Processing PARDFX ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d pardfx) then
    rm -rf pardfx
endif
mkdir pardfx
cd pardfx
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/pardfx_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/dfx_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
## Copying Woon Kai's files until they are accessible through subIP dir
cp -f -R $MODEL_ROOT/tools/upf/ip_upf/pardfx/* .
#cp -f -R $MODEL_ROOT/tools/upf/ip_upf/pardfx/mst_dfx_core_set_voltage.tcl .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/pardfx
dos2unix pardfx_scanunit.upf
dos2unix mst_dfx_core.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/pardfx* .
cp -f $MODEL_ROOT/results/collage/upf/outputs/upf_global_defs.tcl .

sed -i '/env(UPF_INSTALL_DIR)/asource $::env(MODEL_ROOT)/tools/upf/soc_upf.cfg' pardfx.upf
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pardfx.upf
sed -i 's;subIP/dfx_ROOT/tools/upf;results/collage/upf/outputs/merge_results/pardfx;g' pardfx.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/pardfx_scanunit;results/collage/upf/outputs/merge_results/pardfx;g' pardfx.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/pardfx;g' pardfx.upf
sed -i 's;${UPF_INSTALL_DIR};$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pardfx;g' mst_dfx_core.upf
sed -i 's/vccpwell_lv/vnnprim/g' mst_dfx_core.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/pardfx_scanunit;results/collage/upf/outputs/merge_results/pardfx;g' pardfx_scanunit.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pardfx;g' sbr_config_ipxact_workspace_sbr10_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr10_top.upf

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARDFX .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardfx.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardfx.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

#sed -i '/vccdgt_1p0/{d}' mst_dfx_core.upf
setenv PATHNAME "${MODEL_ROOT}/subIP/mem_rf_ROOT/rtl/upf"
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARDFX .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardfx.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardfx.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

# Remove supply connections to EBB vss ports
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' pardfx.sim.upf
sed -i '/^\s*create_supply_net\s*\Sdomain\s*\Spd_pwell_pardfx_pd\S\s*\Svccsram_1p05\S/ d' pardfx.*.upf
sed -i 's;vccsram_1p05;vnnprim;g' pardfx.*.upf

#Remove isolation on pfet_ack signal
### sed -i '/dfx_pfet_ack_b/{d}' pardfx.inc.*.tcl
sed -i 's;mst_dfx_core1/i_dtdfxpgcbunit/dfx_pfet_ack_b;i_idvp_fublet_pardfx_pwell_wrapper_0/idvtctrlo;g' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_IDVP_CONTROLLER_TO_MST_DFX_CORE_UNSPECIFIED_0_ISO_PINS/apardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_enable*' pardfx.inc.*.tcl
sed -i '/List of voltage values for all the power nets/a  set_voltage -object_list "rf_gated_supply" -min 0.75 0.75' pardfx.*.upf
sed -i 's;vccdsw_1p0;vnnprim;g' pardfx.*.upf

sed -i '/fidv_tck/d' pardfx.inc.*.tcl 
sed -i '/npk_avisa_clk/d' pardfx.inc.*.tcl
sed -i '/LV_WRCK/d' pardfx.inc.*.tcl
sed -i '/tam_avisa_clk/d' pardfx.inc.*.tcl
sed -i '/ftapnw_ftap_tck/d' pardfx.inc.*.tcl

sed -i 's;mst_dfx_core1/i_dtdfxpgcbunit/dfx_pfet_ack_b;i_idvp_fublet_pardfx_pwell_wrapper_0/idvtctrlo;g' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[5]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[4]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[3]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[2]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[1]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a  pardfx_pwell_wrapper/mst_dfx_core1/idvp_controller/fidv_tck[0]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_northpeak/npk_avisa_clk[0][0]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_northpeak/npk_avisa_clk[0][1]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_northpeak/npk_avisa_clk[1][0]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_northpeak/npk_avisa_clk[1][1]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/pch_mbist_tap1/LV_WRCK' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_tam/tam_avisa_clk[0]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/i_tam/tam_avisa_clk[1]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[6]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[5]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[4]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[3]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[2]' pardfx.inc.*.tcl
sed -i '/PARDFX_PWELL_WRAPPER_MST_DFX_CORE1_MSTDFXPPG_ISLAND_MST_DFX_CORE_PD_CLOCK_ISOLATION_PINS/a    pardfx_pwell_wrapper/mst_dfx_core1/mbist_tapnw/ftapnw_ftap_tck[1]' pardfx.inc.*.tcl

#cp -f pardfx.impl.upf pardfx.merged.upf

# shschmit setenv SIP_LIBRARY_VOLTAGE 0.75
# shschmit setenv IP_ENABLE_ALL 1
# shschmit setenv SPYGLASS_LP_RUN 1
# shschmit setenv ENABLE_SLP_RUN 1
# shschmit echo "--->---> sub processing PARDFX .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
# shschmit ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardfx.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardfx.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
# shschmit unsetenv SPYGLASS_LP_RUN
# shschmit unsetenv ENABLE_SLP_RUN
# shschmit unsetenv IP_ENABLE_ALL

cp -f pardfx.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardfx.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardfx.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardfx.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARDMI
##------------------------------------------------------------------##
echo  "\n ---> Processing PARDMI ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d pardmi) then
    rm -rf pardmi
endif
mkdir pardmi
cd pardmi

cp -f -R $MODEL_ROOT/subIP/pdmi_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/pardmi_scanunit/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/pardmi
dos2unix pdmi.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/pardmi* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pardmi.upf
sed -i 's;subIP/pdmi_ROOT/tools/upf;results/collage/upf/outputs/merge_results/pardmi;g' pardmi.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf;$env(MODEL_ROOT)/tools/upf;g' pdmi.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/rtl;$::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf;g' pdmi.upf
sed -i 's;source $PDMI_UPF_ROOT_DIR/PDMI_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pdmi.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf7.upf

setenv SIM_MODE_RETENTION 0
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARDMI .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardmi.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardmi.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
#Delete connections to gated supplies for sim upf until we figure out how to filter them in the UPF scripts:
#sed -i '/vccdgt_1p0/d' pdmi.upf
sed -i 's;$synopsys_program_name == "vcs";1;g' pdmi.upf
sed -i 's;\[info exists synopsys_program_name\];1;g' pdmi.upf

echo "--->---> sub processing PARDMI .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardmi.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardmi.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SIM_MODE_RETENTION
unsetenv ENABLE_NLP_RUN

# Remove supply connections to EBB vss ports
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' pardmi.sim.upf

#comment out retention
mv pardmi.impl.upf pardmi.impl.upf.with.retention
mv pardmi.sim.upf pardmi.sim.upf.with.retention

cat pardmi.impl.upf.with.retention | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next  }1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > pardmi.impl.upf
cat pardmi.sim.upf.with.retention | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next  }1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > pardmi.sim.upf

#cp -f pardmi.impl.upf pardmi.merged.upf

## Workaround to an issue of enable created by merge script. shschmit 5/27/2014
sed -i 's;pardmi_pwell_wrapper/pdmi1/sippdmi_rf_rom1/np_bist_fet_en_ack_b;pardmi_pwell_wrapper/i_idvp_fublet_pardmi_pwell_wrapper_0/idvtctrlo;g' pardmi*.inc*.tcl

#Delete connections to gated supplies for sim upf until we figure out how to filter them in the UPF scripts:
#sed -i '/vccdgt_1p0/d' pardmi.sim.upf

#PD feedback: add vnnprim_rf_gated0 to DC set voltage
sed -i '/set_voltage -object_list "pd_pwell_pardmi_pd_GATED_0_vnnprim_gated" -min 0.75 0.75/a \  set_voltage -object_list "vnnprim_rf_gated0" -min 0.75 0.75' pardmi.*.upf


## Copying the files to one area 
#cp -f pardmi.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f pardmi.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

cp -f pardmi.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardmi.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardmi.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pardmi.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


parssata:
##------------------------------------------------------------------##
## PARSSATA
##------------------------------------------------------------------##

echo  "\n ---> Processing PARSSATA ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parssata

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parssata) then
    rm -rf parssata
endif
mkdir parssata
cd parssata

cp -f -R -L $MODEL_ROOT/subIP/ssata3_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parssata_scanunit/* .

cp $MODEL_ROOT/subIP/ssata3_ROOT/tools/spyglasslp/sipsata_waiver.swl .
cp $MODEL_ROOT/subIP/psf_ROOT/tools/spyglasslp/psf20_slp_waiver.swl .
cp $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/spyglasslp/router/iosf_sbc_rtr_waivers.swl .


chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parssata
dos2unix sata.upf
dos2unix psf20_lnsp_psf7.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parssata* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parssata.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parssata;g' parssata.upf
sed -i 's;subIP/ssata3_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parssata;g' parssata.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parssata;g' parssata.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parssata_scanunit;results/collage/upf/outputs/merge_results/parssata;g' parssata.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf7.upf
sed -i 's;$PSF20_UPF_ROOT_DIR/lnsp;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parssata;g' psf20_lnsp_psf7.upf

sed -i 's;SATA_UPF_ROOT_DIR;env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parssata;g' sata.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/rtl;$env(MODEL_ROOT)/subIP/hip_rf_ROOT/rtl/upf;g' sata.upf

sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr13_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/subIP/IP_SBR_ROOT/tools/upf/router;g' sbr_config_ipxact_workspace_sbr13_top.upf

sed -i 's;$PARSSATA_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parssata;g' parssata_scanunit.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
# clear sip upf dependency variable for syn 
if ( $?ACE_RTL_SIM ) then
  set ace_rtl_sim_val = $ACE_RTL_SIM
  unsetenv ACE_RTL_SIM
endif
echo "--->---> sub processing PARSSATA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parssata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parssata.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "$MODEL_ROOT/subIP/hip_rf_ROOT/rtl/upf/c73p1rfslvm.*" |& tee -a ${LOG_FILE_LOCATION}
#/nfs/pdx/proj/acd/fe.75/work/cvanbeek/cct/lbg/fc-lbg-a0_6132014/tools/upf/upf_tools/tools/upf/merge_upf/merge_upf.tcl -upf parssata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parssata.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "$MODEL_ROOT/subIP/hip_rf_ROOT/rtl/upf/c73p1rfslvm.*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
setenv ENABLE_NLP_RUN 1
setenv ACE_RTL_SIM vcs
echo "--->---> sub processing PARSSATA .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parssata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parssata.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "$MODEL_ROOT/subIP/hip_rf_ROOT/rtl/upf/c73p1rfslvm.*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN 
if ( $?ace_rtl_sim_val ) then
  setenv ACE_RTL_SIM $ace_rtl_sim_val
  unset ace_rtl_sim_val
else
  unsetenv ACE_RTL_SIM
endif

sed -i '/hip_rf_ROOT/d' parssata.impl.upf

## remove vss connections in nlp
#sed -i '/^\s*connect_supply_net\s*\Svss\S\s*\-ports\s*\S*c73/ d' parssata.sim.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARSSATA_PWELL_WRAPPER_I_IDVP_FUBLET_PARSSATA_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parssata_pwell_wrapper/st2/sata_sip_core_pgd1/st_rf_rom_wrapper1/vp_st_ram_01_fet_en_b#parssata_pwell_wrapper/i_idvp_fublet_parssata_pwell_wrapper_0/idvtctrlo#g' parssata*.inc*.tcl
sed -i '/PARSSATA_PWELL_WRAPPER_I_IDVP_FUBLET_PARSSATA_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parssata_pwell_wrapper/psf7/i_psf20_top_psf7/fab_pmc_fet_en_ack_b#parssata_pwell_wrapper/i_idvp_fublet_parssata_pwell_wrapper_1/idvtctrlo#g' parssata*.inc*.tcl

#cp parssata.impl.upf parssata.merged.upf

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parssata.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parssata.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript

##------------------------------------------------------------------##
## PARPSF2
##------------------------------------------------------------------##

echo  "\n ---> Processing PARPSF2 ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpsf2) then
    rm -rf parpsf2
endif
mkdir parpsf2
cd parpsf2

cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpsf2_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
cp -f -R $MODEL_ROOT/subIP/exi_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpsf2
dos2unix psf20_lnsp_psf2.upf
dos2unix parpsf2_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpsf2* .

sed -i 's;subIP/exi_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpsf2;g' parpsf2.upf
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpsf2.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpsf2_scanunit;results/collage/upf/outputs/merge_results/parpsf2;g' parpsf2.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parpsf2;g' parpsf2.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parpsf2;g' parpsf2.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_psf2.upf
sed -i 's;source $PSF20_UPF_ROOT_DIR/psf20_top.upf;## source $PSF20_UPF_ROOT_DIR/psf20_top.upf;g' psf20_lnsp_psf2.upf
sed -i 's;source $PSF20_UPF_ROOT_DIR/lnsp/psf20_lnsp_psf2.iso;## source $PSF20_UPF_ROOT_DIR/lnsp/psf20_lnsp_psf2.iso;g' psf20_lnsp_psf2.upf

sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/SPT_SYN_soc_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' exi_core.upf
sed -i 's;set_design_top;#set_design_top;g' exi_core.upf
sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/exi_sr.list;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parpsf2/exi_sr.list;g' exi_core.upf
sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/exi_isolation.upf;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parpsf2/exi_isolation.upf;g' exi_core.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr2_top.upf
sed -i 's;set sbr_upf_scripts_dir $::env(IP_ROOT)/tools/upf/router;set sbr_upf_scripts_dir $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parpsf2;g' sbr_config_ipxact_workspace_sbr2_top.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv SIP_LIBRARY_TYPE d04
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPSF2 .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf2.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf2.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPSF2 .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf2.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf2_sim.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv SIP_LIBRARY_TYPE
unsetenv SIP_LIBRARY_VOLTAGE

## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARPSF2_PWELL_WRAPPER_I_IDVP_FUBLET_PARPSF2_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#parpsf2_pwell_wrapper/psf2/i_psf20_top_psf2/fab_pmc_fet_en_ack_b#parpsf2_pwell_wrapper/i_idvp_fublet_parpsf2_pwell_wrapper_0/idvtctrlo#g' parpsf2*.inc*.tcl
sed -i '/PARPSF2_PWELL_WRAPPER_I_IDVP_FUBLET_PARPSF2_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpsf2_pwell_wrapper/exi_core1/exi_pmc_fet_ack#parpsf2_pwell_wrapper/i_idvp_fublet_parpsf2_pwell_wrapper_1/idvtctrlo#g' parpsf2*.inc*.tcl
#cp parpsf2.impl.upf parpsf2.merged.upf

sed -i 's;subIP/hip_lbg_p1273_memory_2014ww10/rtl/rf/rtl/upf;subIP/mem_rf_ROOT/rtl/upf;g' parpsf2.sim.upf
sed -i '/set_voltage -object_list "vnnprim" -min 0.75 0.75/ a set_voltage -object_list "vnnprim_rf_gated" -min 0.75 0.75' parpsf2.*.upf

cp -f parpsf2.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf2.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf2.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpsf2.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARPXPA
##------------------------------------------------------------------##
parpxpa:

echo  "\n ---> Processing PARPXPA ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parpxpa

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parpxpa) then
    rm -rf parpxpa
endif
mkdir parpxpa
cd parpxpa
cp -f -R -L $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parpxpa_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/pcie2_ROOT/tools/upf/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parpxpa
dos2unix pcie.upf
dos2unix parpxpa_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parpxpa* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parpxpa.upf
sed -i 's;subIP/pcie2_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parpxpa;g' parpxpa.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parpxpa_scanunit;results/collage/upf/outputs/merge_results/parpxpa;g' parpxpa.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pcie.upf
sed -i 's;load_upf $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/subIP/mem/upf/;load_upf $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/;g' pcie.upf
sed -i 's;{\[info exists synopsys_program_name\] && ($synopsys_program_name == "vcs")};{\[info exists ::env(ENABLE_NLP_RUN)\]};g' pcie.upf

if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
  mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
endif
echo "####################################################"        >  $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# " `(cd $MODEL_ROOT; stat -c %N subIP/pcie2_ROOT)`          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
sed -e "s:pcie2_top\.:$par.${par}_pwell_wrapper.pcie2_top1.:g"                              \
    -e "s: 'sippcie_x4_a_rf_rom1/: '${par}_pwell_wrapper/pcie2_top1/sippcie_x4_a_rf_rom1/:" \
    -e "s/pd_pciemex_cpgd_cm_PGD/pd_pwell_${par}_pd_GATED_0/"                               \
    -e "s/pd_pciemex_vdd_aon/pd_pwell_${par}_pd/"                                           \
    -e "s/(supply ._gated0:0.750)/(supply *_vnnprim_gated:0.750)/"                          \
    -e 's/-comment *"/-comment "pcie2 SIP sippcie2_top.swl: /'                              \
    $MODEL_ROOT/subIP/pcie2_ROOT/tools/spyglasslp/sippcie2_top.swl >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "# END OF sippcie2_top.swl"                                   >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo "####################################################"        >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
echo ""                                                            >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  cat $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl          >> $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif


setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARPXPA .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpa.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpa.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARPXPA .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpa.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpa.tcl  -inc_file -tag sim -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1rfslv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

##Remove retention from the partition UPF
mv parpxpa.impl.upf parpxpa.impl1.upf
mv parpxpa.sim.upf parpxpa.sim1.upf
cat parpxpa.impl1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpa.impl.upf
cat parpxpa.sim1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpa.sim.upf

#cp parpxpa.impl.upf  parpxpa.merged.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARPXPA .... Running for DC/Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpa.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpa.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
unsetenv IP_ENABLE_ALL

##Remove retention from the partition UPF
mv parpxpa.slp.upf parpxpa.slp1.upf
cat parpxpa.slp1.upf | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' > parpxpa.slp.upf

cp parpxpa.slp.upf parpxpa.spyglass.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 6/17/2014
sed -i '/PARPXPA_PWELL_WRAPPER_I_IDVP_FUBLET_PARPXPA_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parpxpa_pwell_wrapper/pcie2_top1/sippcie_x4_a_rf_rom1/pgcb_ip_fet_en_b#parpxpa_pwell_wrapper/i_idvp_fublet_parpxpa_pwell_wrapper_1/idvtctrlo#g' parpxpa*.inc*.tcl

## Copying the files to central area 
#cp -f parpxpa.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f parpxpa.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpa.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parpxpa.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript


##------------------------------------------------------------------##
## PARGBE
##------------------------------------------------------------------##

echo  "\n ---> Processing PARGBE ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d pargbe) then
    rm -rf pargbe
endif
mkdir pargbe
cd pargbe
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/pargbe_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/gbe_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/tools/upf/ip_upf/pargbe/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/pargbe
dos2unix GbE.upf
dos2unix pargbe_scanunit.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/pargbe* .

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' pargbe.upf
sed -i 's;subIP/gbe_ROOT/tools/upf;results/collage/upf/outputs/merge_results/pargbe;g' pargbe.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/pargbe_scanunit;results/collage/upf/outputs/merge_results/pargbe;g' pargbe.upf
sed -i 's;$::env(GBE_ROOT)/tools/upf/;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/pargbe;g' GbE.upf

sed -i 's;source $GbE_UPF_ROOT_DIR/SPT_SYN_soc_upf.cfg;#source $GbE_UPF_ROOT_DIR/SPT_SYN_soc_upf.cfg;g' GbE.upf
sed -i 's;source $GbE_UPF_ROOT_DIR/GbE_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' GbE.upf

# kharen - Put the gated RAM pin on the gated supply
sed -i '/_rf_gated_0.*vccd_1p0/s/vccd_1p0/vccdgt_1p0/g' GbE.upf
# kh - Fix a type-o that had both RAMs listed as "0" instead of "0" and "1"
sed -i '/gbd_SRAM_path_1/s/_MSWT_WRP_0/_MSWT_WRP_1/g' SRAM_list/SRAM_path.list

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARGBE .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pargbe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pargbe.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell"  |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv SRAM_UPF_DIR "${MODEL_ROOT}/tools/upf/ip_upf/sram"
setenv SRAM_UPF_PATH "${MODEL_ROOT}/tools/upf/ip_upf/sram"
setenv RF_UPF_PATH "${MODEL_ROOT}/subIP/mem_rf_ROOT/rtl/upf"

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARGBE .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pargbe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pargbe.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslv* ip731srstlv*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv SRAM_UPF_PATH
unsetenv RF_UPF_PATH

##Remove retention from the partition IMPL and SIM UPFs
cp pargbe.impl.upf pargbe.impl.upf.temp1
cp pargbe.sim.upf pargbe.sim.upf.temp1
cat pargbe.impl.upf.temp1 | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> pargbe.impl.upf.temp2
cat pargbe.sim.upf.temp1 | awk -v pat="map_retention" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+2;j++) print "#"a[j]; i=j}}}' | awk 'BEGIN { start = 0 } /set_retention /,/-elements/ { print "#" $_ ; start=1;next}1' | awk -v pat="set_retention_control" -v cnt=2 '{a[NR]=$0;}END{for(i=1;i<=FNR;i++){if(a[i] !~ pat) {print a[i]} ;if(a[i] ~ pat ){for(j=i;j<=i+3;j++) print "#"a[j]; i=j}}}' >> pargbe.sim.upf.temp2

# Set the voltage for vnnprim_rf_gated_0
# This should be done in the IP UPF
sed -i '/set_voltage.*"vnnprim"/a \  set_voltage -object_list "vnnprim_rf_gated_0" -min 0.75 0.75' pargbe.*.upf

# Connect the IDV control port to fix a bug in the merge script
sed -i '/PARGBE_PWELL_WRAPPER_I_IDVP_FUBLET_PARGBE_PWELL_WRAPPER_0_I_CLAMP0_IDV_PINS/,/}/s#pargbe_pwell_wrapper/gbeunit_wrapper1/u_gbeunit_pgd/u_gbm/u_m2k/fary_pwren_b_rf#pargbe_pwell_wrapper/i_idvp_fublet_pargbe_pwell_wrapper_0/idvtctrlo#g' pargbe*.inc*.tcl

#cp pargbe.merged.upf     pargbe.impl.upf

## 092614 RJS - per SD request, uniquify vccsram_1p05 for pargbe -> vccsramgbe_tl_1p05
sed -i 's;vccsram_1p05;vccsramgbe_tl_1p05;g' pargbe.*.upf
sed -i 's;gbeunit_wrapper1/u_gbeunit_pgd/u_gbm/u_m2k/fary_pwren_b_rf;i_idvp_fublet_pargbe_pwell_wrapper_1/idvtctrlo;g' pargbe.inc.*.tcl

cp -f pargbe.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pargbe.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pargbe.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f pargbe.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


parxhcib:
##------------------------------------------------------------------##
## PARXHCIB
##------------------------------------------------------------------##
echo  "\n ---> Processing PARXHCIB ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parxhcib

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parxhcib) then
    rm -rf parxhcib
endif
mkdir parxhcib
cd parxhcib
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parxhcib_scanunit/* .
#cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
cp -f -R $MODEL_ROOT/subIP/usb3_ROOT/tools/upf/LBG/xdci_upf/* .
cp -f -R $MODEL_ROOT/subIP/hip_usb2_ROOT/rtl/upf/* .

## Copy over version of c73usb2e0_usbhsip_ppwrapper0.upf with correct vss state in PST
cp -f -R $MODEL_ROOT/tools/upf/ip_upf/usb/* .

cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/parxhcib_HSD_5512084.txt .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parxhcib

dos2unix XDCI.upf
dos2unix c73p1usbtop14pfamilyew.upf
#dos2unix sbr_config_ipxact_workspace_sbr3_top.upf

cp -f $MODEL_ROOT/results/collage/upf/outputs/parxhcib* .
sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parxhcib.upf

sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parxhcib_scanunit;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf
#sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf
sed -i 's;subIP/usb3_ROOT/tools/upf/SPTH/xdci_upf;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf
sed -i 's;subIP/usb3_ROOT/tools/upf/BXT/xdci_upf;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf
sed -i 's;subIP/usb3_ROOT/tools/upf/LBG/xdci_upf;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf
sed -i 's;subIP/hip_usb2_ROOT/rtl/upf;results/collage/upf/outputs/merge_results/parxhcib;g' parxhcib.upf

#sed -i 's;::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE);env(MODEL_ROOT)/tools/upf/soc_upf;g' sbr_config_ipxact_workspace_sbr3_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcib;g' sbr_config_ipxact_workspace_sbr3_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/$::env(SIP_VARIATION)/xdci_upf/sr_list;$env(MODEL_ROOT)/subIP/usb3_ROOT/tools/upf/BXT/xdci_upf/sr_list;g' XDCI.upf
sed -i 's;SOC_RETENTION_CELL_MAP_DSYNC;SOC_DOUBLESYNC_RETENTION_CELL_MAP;g' XDCI.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/$::env(SIP_VARIATION)/xdci_upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcib;g' XDCI.upf
#sed -i 's;$SIP_INTERNAL; 1 ;g' XDCI.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/usbx_tb/$::env(SIP_VARIATION);$env(MODEL_ROOT)/subIP/usb3_ROOT/tools/upf/usbx_tb/BXT;g' XDCI.upf
sed -i 's;env(ip_usb2phy_upf_path);env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcib;' c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_off_offP/off/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_off_0P/off/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_3P09/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_0P94/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_1P21/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_0P75/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_1P66/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/MIG_USB2_on_0P65/on/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/c73adpll_h_ON_1P35/ON/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i -e "s/c73adpll_h_ON_0P94/ON/g" c73p1usbtop14pfamilyew.upf c73usb2e0_*.upf c73p1adpll_hscoretopver_uniq.upf
sed -i 's;::env(IP_ROOT)/tools/upf/$::env(SIP_VARIATION);env(MODEL_ROOT)/tools/upf;g' XDCI.upf
sed -i 's;$XDCI_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parxhcib;g' XDCI.upf
echo  'if { [info exists env(ENABLE_NLP_RUN)] } { set VCS_ENV 1; puts "Setting VCS_ENV for NLP" }' >> XDCI_upf.cfg
echo  'set RF1_ROOT  $env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl' >> XDCI_upf.cfg


####################################################################################
## The following hacks are needed to enable full PST coverage ######################
####################################################################################
sed -i 's;vcccore_aon1p0_lv\s*-state\s*{on 0.65};vcccore_aon1p0_lv -state {on 0.94};' c73p1usbtop14pfamilyew.upf  c73usb2e0_usbhsip_gblwrapper.upf c73usb2e0_usbhsip_ppwrapper0.upf 
sed -i 's;vcccore_aon1p0_lv\s*-state\s*{on 0.75};vcccore_aon1p0_lv -state {on 0.94};' c73p1usbtop14pfamilyew.upf  c73usb2e0_usbhsip_gblwrapper.upf c73usb2e0_usbhsip_ppwrapper0.upf 
sed -i 's;vccsfr_1p35_hv\s*-state\s*{on 1.21};vccsfr_1p35_hv -state {on 1.24};' c73p1usbtop14pfamilyew.upf c73usb2e0_usbhsip_gblwrapper.upf 
sed -i 's;vccsfr_1p35_hv\s*-state\s*{ON 1.35};vccsfr_1p35_hv -state {ON 1.24};' c73p1adpll_hscoretopver_uniq.upf 
####################################################################################


if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl ) then
  if ( -e $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl ) then
    mv $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl.bak
  endif

  cp $MODEL_ROOT/tools/upf/spyglass/waivers/$par.lbg.swl $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
else 
  touch $MODEL_ROOT/tools/upf/spyglass/waivers/$par.swl
endif

setenv SOC_REPO_ROOT $MODEL_ROOT
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARXHCIB .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcib.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcib.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

#connect_supply_net ${SOC_SUPPLY_PORT}_rf_gated1 -ports ${rf}/vccdgt_1p0
sed -i '/connect_supply_net $SOC_GROUND_PORT -ports ${rf}\/vss/a }' XDCI.upf
sed -i '/${SOC_SUPPLY_PORT}_rf_gated1 -ports ${rf}\/vccdgt_1p0/{N;s/\n.*//;}' XDCI.upf
setenv ENABLE_NLP_RUN 1
setenv IP_ENABLE_ALL 1
echo "--->---> sub processing PARXHCIB .... Running for SIM ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcib.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcib.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv IP_ENABLE_ALL
unsetenv SOC_REPO_ROOT

##Remove retention from the partition UPF
cp parxhcib.impl.upf parxhcib.impl.upf.raw
perl -ni -e '$subst = 1 if /(set|map)_retention/; $_ = "# $_" if $subst; $subst = 0 unless /\\$/; print' parxhcib.impl.upf
cp parxhcib.sim.upf parxhcib.sim.upf.raw
perl -ni -e '$subst = 1 if /(set|map)_retention/; $_ = "# $_" if $subst; $subst = 0 unless /\\$/; print' parxhcib.sim.upf

## Workaround to an issue of incorrect enable created by merge script. rjstach 7/17/2014
sed -i '/PARXHCIB_PWELL_WRAPPER_I_IDVP_FUBLET_PARXHCIB_PWELL_WRAPPER_1_I_CLAMP0_IDV_PINS/,/}/s#parxhcib_pwell_wrapper/usbx_dev_com1/uxd_fet_pmc_en_ack_b#parxhcib_pwell_wrapper/i_idvp_fublet_parxhcib_pwell_wrapper_1/idvtctrlo#g' parxhcib*.inc*.tcl

## HIP connect_supply_net is in manual include file 'parxhcib_hip_usb2_ls.tcl'; Don't duplicate statements in SIM upf from IP_ENABLE_ALL
sed -i '/^connect_supply_net .*-ports "parxhcib_pwell_wrapper\/hip_usb2/s:^connect_supply_net:## nect_supply_net:' parxhcib.sim.upf

## Add level shifters for HIP_USB2 DSW signals - insert PARXHCIB_HIP_USB2_LS.TCL contents
mv parxhcib.impl.upf parxhcib.impl1.upf
mv parxhcib.sim.upf parxhcib.sim1.upf
sed -n '1,/# --- End TOP domain:/ p' parxhcib.impl1.upf            >  parxhcib.impl.upf
cat $MODEL_ROOT/tools/upf/scripts/parxhcib_hip_usb2_ls.tcl         >> parxhcib.impl.upf
sed -n '/# --- End TOP domain:/,$ p' parxhcib.impl1.upf | tail +2  >> parxhcib.impl.upf
cat $MODEL_ROOT/tools/upf/scripts/parxhcib_hip_usb2_ls.inc.tcl     >> parxhcib.inc.impl.tcl

sed -n '1,/# --- End TOP domain:/ p' parxhcib.sim1.upf             >  parxhcib.sim.upf
cat $MODEL_ROOT/tools/upf/scripts/parxhcib_hip_usb2_ls.sim.tcl     >> parxhcib.sim.upf
sed -n '/# --- End TOP domain:/,$ p' parxhcib.sim1.upf | tail +2   >> parxhcib.sim.upf
cat $MODEL_ROOT/tools/upf/scripts/parxhcib_hip_usb2_ls.inc.tcl     >> parxhcib.inc.sim.tcl

# add missing 'bextckmonout_usb_pad_lv' related supply (Ray: 'collage sometimes has trouble with inouts')
sed -i '/set_related_supply_net.* -object_list \[get_ports "bcomp_usb_pad_ehv"\]/a  set_related_supply_net -power "vccusb_1p05" -ground "vss" -object_list [get_ports "bextckmonout_usb_pad_lv"]' parxhcib.*.upf
sed -i '/set_related_supply_net.* -object_list "bcomp_usb_pad_ehv"/a  set_related_supply_net -power "vccusb_1p05" -ground "vss" -object_list "bextckmonout_usb_pad_lv"'                           parxhcib.*.upf

# following pins should be vnnprim. Collage sees the vccusbdsw_1p0 endpoints, doesn't know we will be adding level shifting inside the partition. 
cp parxhcib.impl.upf parxhcib.diffimpl.upf
echo "Warning: changing pins from what Collage put (vccdsw_1p0) to vnnprim.  Verify the other end of these signals as well." | tee -a ${LOG_FILE_LOCATION}
egrep 'set_related_supply_net -power "vccdsw_1p0".*(ip.*_afe_d.pulldown_vnn|o_ldoclkreq|isoc_phy_fwenb|utmiplus_usb_.*_LineState|ophy_soc_ldogblcorepwrack)' parxhcib.impl.upf | sed 's/^/-W- /' | tee -a ${LOG_FILE_LOCATION}
sed -ri '/ip.*_afe_d.pulldown_vnn|o_ldoclkreq|isoc_phy_fwenb|utmiplus_usb_.*_LineState|ophy_soc_ldogblcorepwrack/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.impl.upf
sed -ri '/ip.*_afe_d.pulldown_vnn|o_ldoclkreq|isoc_phy_fwenb|utmiplus_usb_.*_LineState|ophy_soc_ldogblcorepwrack/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.sim.upf
# HSD 5511872 (ECO)
echo "-W- HSD 5511872 (ECO):" | tee -a ${LOG_FILE_LOCATION}
egrep 'set_related_supply_net -power "vccdsw_1p0".*(o_pwrack_primldo_h)' parxhcib.impl.upf | sed 's/^/-W- /' | tee -a ${LOG_FILE_LOCATION}
sed -ri '/o_pwrack_primldo_h/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.impl.upf
sed -ri '/o_pwrack_primldo_h/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.sim.upf

### 150918 Uzair: Using new B0 iSCLK lib
## vcca_nssc_1p05 to vccusb_1p05:
#echo "Warning: changing pins from what Collage put (vcca_nssc_1p05) to vccusb_1p05.  Verify the other end of these signals as well." | tee -a ${LOG_FILE_LOCATION}
#egrep 'set_related_supply_net -power "vcca_nssc_1p05".*usbpllref_clk' parxhcib.impl.upf | sed 's/^/-W- /' | tee -a ${LOG_FILE_LOCATION}
#sed -i '/usbpllref_clk/ s/set_related_supply_net -power "vcca_nssc_1p05"/set_related_supply_net -power "vccusb_1p05"/' parxhcib.impl.upf
#sed -i '/usbpllref_clk/ s/set_related_supply_net -power "vcca_nssc_1p05"/set_related_supply_net -power "vccusb_1p05"/' parxhcib.sim.upf
########-> 080115 -- RJS --- isclk voltage name change from vcca_nssc_1p05 to vcca_dig_1p05 -redoing above
echo "Warning: changing pins from what Collage put (vcca_dig_1p05) to vccusb_1p05.  Verify the other end of these signals as well." | tee -a ${LOG_FILE_LOCATION}
egrep 'set_related_supply_net -power "vcca_dig_1p05".*usbpllref_clk' parxhcib.impl.upf | sed 's/^/-W- /' | tee -a ${LOG_FILE_LOCATION}
sed -i '/usbpllref_clk/ s/set_related_supply_net -power "vcca_dig_1p05"/set_related_supply_net -power "vccusb_1p05"/' parxhcib.impl.upf
sed -i '/usbpllref_clk/ s/set_related_supply_net -power "vcca_dig_1p05"/set_related_supply_net -power "vccusb_1p05"/' parxhcib.sim.upf

# HSD 5511873 (ECO) - tie off op*_usbwakedetect_host_vnnaon in spare (using vnnprim)
# Collage may ultimately detect the vnnprim driver from parxhcib_spare after ECO implementation, but just in case and/or to get the UPF right earlier in the ECO process,
#   substitute vnnprim if hip_usb2's vccdsw_1p0 is currently shown
echo "Warning: Possibly changing pins from what Collage put for op.*_usbwakedetect_host_vnnaon (vccdsw_1p0?) to vnnprim for ECO: HSD 5511873." | tee -a ${LOG_FILE_LOCATION}
egrep 'set_related_supply_net -power "vccdsw_1p0".*op.*_usbwakedetect_host_vnnaon' parxhcib.impl.upf | sed 's/^/-W- /' | tee -a ${LOG_FILE_LOCATION}
sed -ri '/op._usbwakedetect_host_vnnaon|op.._usbwakedetect_host_vnnaon/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.impl.upf
sed -ri '/op._usbwakedetect_host_vnnaon|op.._usbwakedetect_host_vnnaon/ s/set_related_supply_net -power "vccdsw_1p0"/set_related_supply_net -power "vnnprim"/' parxhcib.sim.upf

diff parxhcib.diffimpl.upf parxhcib.impl.upf | tee -a ${LOG_FILE_LOCATION}
rm parxhcib.diffimpl.upf

##RJS: 021815:HSD #5512084: NLP Change only: VSS connections missing for i_otg3_rams --adding back into paxhcib.sim.upf
sed -i '/connect_supply_net "vnnprim" -ports "parxhcib_pwell_wrapper\/usbx_dev_com1\/uxdevunit\/uxdevpgd2_i\/otg3\/i_otg3_rams\/ram2_i\/i1_otg3_2_c73p4rfslvm1r1w512x64_dfx_wrapper\/mode_ramseq.c73p1rfslvm1r1w512x64hb4\/vccd_1p0"/r parxhcib_HSD_5512084.txt' parxhcib.sim.upf

##150902 Uzair: HSD #5512613 HSD closed as "not a bug"
##150819 Uzair: HSD #5512613 "PARXHCIB_PWELL_WRAPPER_USBX_DEV_COM1_SR_XDCI_CORE_PGD_ELEMENTS " list incorrect. Root caused is XDCI sr_list 
##150902 sed -i 's/mux_body\/visa2_registers\.deserializer\/secure_deser\.front_end/deserializer/g' parxhcib.inc.*.tcl

cp $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/

cp -f parxhcib.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parxhcib.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript

parieb:
##------------------------------------------------------------------##
## PARIEB
##------------------------------------------------------------------##
echo  "\n ---> Processing PARIEB ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parieb

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parieb) then
    rm -rf parieb
endif
mkdir parieb
cd parieb

# HSD #5511222 fixed in scanunit-lbg-a0-14ww39.  Current RTL1.0 candidate points to scanunit-lbg-a0-14ww37a.  Unless updated from scanunit-lbg-a0-14ww37a, patch to scanunit-lbg-a0-14ww39
if ( `readlink $MODEL_ROOT/subIP/scanunit_ROOT` =~ */scanunit-lbg-a0-14ww37a ) then
  echo "-W-: Warning: Taking HSD #5511222 fixes from scanunit-lbg-a0-14ww39 release instead of current realease" `readlink $MODEL_ROOT/subIP/scanunit_ROOT`
  cp -f -R /p/acd/proj/lbg/release/sip/scanunit/scanunit-lbg-a0-14ww39/tools/upf/out/parieb_scanunit/* .
else
  cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parieb_scanunit/* .
endif
cp -f -R $MODEL_ROOT/subIP/ie_ROOT/tools/csme/upf/lbg_ie/* .
#cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
#cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parieb
cp -f $MODEL_ROOT/results/collage/upf/outputs/parieb* .
# latest IE release should include SIM / load_upf support if env variables are set right
#cp -f $MODEL_ROOT/tools/upf/ip_upf/parieb/* .

dos2unix ieb.upf
dos2unix parieb_scanunit.upf
#dos2unix psf20_lnsp_ie.upf
#dos2unix sbr_config_ipxact_workspace_sbr8_top.upf
#dos2unix sbr_config_ipxact_workspace_sbr9_top.upf

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parieb.upf

sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parieb_scanunit;results/collage/upf/outputs/merge_results/parieb;g' parieb.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parieb;g' parieb.upf
sed -i 's;subIP/ie_ROOT/tools/csme/upf/lbg_ie;results/collage/upf/outputs/merge_results/parieb;g' parieb.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parieb;g' parieb.upf

sed -i 's;$::env(IE_UPF_PATH)/soc_clt_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' ieb.upf
sed -i 's;$::env(IE_UPF_PATH);$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb;g' ieb.upf

sed -i 's;$::env(IE_UPF_PATH)/ieb_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb/ieb_ebb_load_upf.tcl;g' ieb.upf
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf;g' ieb_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' ieb_ebb_load_upf.tcl
sed -i '$i \}' ieb_ebb_load_upf.tcl

sed -i 's;$PARIEB_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb;g' parieb_scanunit.upf

#sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_ie.upf
#sed -i 's;$PSF20_UPF_ROOT_DIR/lnsp;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb;g' psf20_lnsp_ie.upf

#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb;g' sbr_config_ipxact_workspace_sbr8_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr8_top.upf

#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parieb;g' sbr_config_ipxact_workspace_sbr9_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr9_top.upf

echo "--->---> sub processing PARIEB .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
# clear ieb.upf dependency variable for syn (conditional is missing in CSME_LBG_2014WW33_1p0_v1 / sip_csme-lbg-a0-14ww33a_mod14ww34a, but being added per HSD-ES #1203751357 for LBG HSD#5511000)
if ( $?ACE_RTL_SIM ) then
  set ace_rtl_sim_val = $ACE_RTL_SIM
  unsetenv ACE_RTL_SIM
endif
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieb.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

echo "--->---> sub processing PARIEB .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
setenv RF_UPF_PATHNAME "${MODEL_ROOT}/subIP/mem_rf_ROOT/rtl/upf"
setenv ENABLE_NLP_RUN 1
setenv ACE_RTL_SIM vcs
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parieb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parieb.tcl  -inc_file -tag sim -set_vars "synopsys_program_name vcs" -skip_load_upfs "c73p1rfslvm*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv RF_UPF_PATHNAME
if ( $?ace_rtl_sim_val ) then
  setenv ACE_RTL_SIM $ace_rtl_sim_val
  unset ace_rtl_sim_val
else
  unsetenv ACE_RTL_SIM
endif

# temp patches - LBG HSD 5511000 / SIP HSD-ES 1203751357
# -> per SIP feedback there may be a different answer via a tcl setting, tbd....
if ( -d ../../../../../../.git ) then
  set temp = `git reflog | grep fc-lbg-a0-14ww36a_candidate_MR2`
  if ( $status == 0 ) then
    echo "Patching parieb.inc.*.tcl for fc-lbg-a0-14ww36a_candidate_MR2 LBG HSD 5511000 / SIP HSD-ES 1203751357 (generate_merged_upf.csh)"
    mv parieb.inc.impl.tcl parieb.inc.impl1.tcl
    #mv parieb.inc.sim.tcl  parieb.inc.sim1.tcl
    grep -v -e 'sbebase/sbcport/[ie]np' -e 'sbebase/sbcport/[ie]pc' parieb.inc.impl1.tcl > parieb.inc.impl.tcl
    #grep -v -e 'sbebase/sbcport/[ie]np' -e 'sbebase/sbcport/[ie]pc' parieb.inc.sim1.tcl  > parieb.inc.sim.tcl
  endif
endif

# compensate for merge_upf tool deficiency (broadly-applied signal merging)
sed -i s:parieb_pwell_wrapper/ieb1/moa_pmt/csme_pmt_pfet_ack_b:parieb_pwell_wrapper/i_idvp_fublet_parieb_pwell_wrapper_1/idvtctrlo: parieb.inc.impl.tcl
sed -i s:parieb_pwell_wrapper/ieb1/moa_pmt/csme_pmt_pfet_ack_b:parieb_pwell_wrapper/i_idvp_fublet_parieb_pwell_wrapper_1/idvtctrlo: parieb.inc.sim.tcl

cp -f $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp -f $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/

cp -f parieb.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parieb.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript

parcsmeb:
##------------------------------------------------------------------##
## PARCSMEB
##------------------------------------------------------------------##
echo  "\n ---> Processing PARCSMEB ...." |& tee -a ${LOG_FILE_LOCATION}
set par = parcsmeb

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parscmeb) then
    rm -rf parcsmeb
endif
mkdir parcsmeb
cd parcsmeb

cp -f -R $MODEL_ROOT/subIP/csme_ROOT/tools/csme/upf/lbg/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parcsmeb_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/psf_ROOT/tools/upf/lnsp/* .
#cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/parcsmeb_design_attributes.txt .

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parcsmeb
cp -f $MODEL_ROOT/results/collage/upf/outputs/parcsmeb* .

dos2unix csmeb.upf
dos2unix parcsmeb_scanunit.upf
dos2unix psf20_lnsp_csme.upf
#dos2unix sbr_config_ipxact_workspace_sbr7_top.upf
#dos2unix sbr_config_ipxact_workspace_sbr6_top.upf

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parcsmeb.upf

sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parcsmeb_scanunit;results/collage/upf/outputs/merge_results/parcsmeb;g' parcsmeb.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parcsmeb;g' parcsmeb.upf
sed -i 's;subIP/csme_ROOT/tools/csme/upf/lbg;results/collage/upf/outputs/merge_results/parcsmeb;g' parcsmeb.upf
sed -i 's;subIP/psf_ROOT/tools/upf/lnsp;results/collage/upf/outputs/merge_results/parcsmeb;g' parcsmeb.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/lnsp/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' psf20_lnsp_csme.upf
sed -i 's;$PSF20_UPF_ROOT_DIR/lnsp;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb;g' psf20_lnsp_csme.upf
# need to pre-process psf20_top.upf to eliminate PSF rentention while preserving csmeb retention
sed -i 's;$PSF20_UPF_ROOT_DIR/psf20_top.upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb/psf20_top.upf;g' psf20_lnsp_csme.upf
perl -pe '$subst = 1 if /^ *(set|map)_retention/; $_ = "# $_" if $subst; $subst = 0 unless /\\$/;' $MODEL_ROOT/subIP/psf_ROOT/tools/upf/psf20_top.upf > $MODEL_ROOT/results/collage/upf/outputs/merge_results/parcsmeb/psf20_top.upf

sed -i 's;$::env(CSME_UPF_PATH)/soc_clt_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' csmeb.upf
sed -i 's;$::env(CSME_UPF_PATH);$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb;g' csmeb.upf

sed -i 's;$::env(CSME_UPF_PATH)/csmeb_ebb_load_upf.tcl;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb/csmeb_ebb_load_upf.tcl;g' csmeb.upf
sed -i 's;${C73_RF_DIR};$env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf;g' csmeb_ebb_load_upf.tcl
sed -i '1i if { [ info exists ::env(ENABLE_NLP_RUN) ] } {' csmeb_ebb_load_upf.tcl
sed -i '$i \}' csmeb_ebb_load_upf.tcl

sed -i 's;$PARCSMEB_SCANUNIT_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb;g' parcsmeb_scanunit.upf

#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb;g' sbr_config_ipxact_workspace_sbr6_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr6_top.upf

#sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parcsmeb;g' sbr_config_ipxact_workspace_sbr7_top.upf
#sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr7_top.upf

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
# clear csmeb.upf dependency variable for syn
if ( $?ACE_RTL_SIM ) then
  set ace_rtl_sim_val = $ACE_RTL_SIM
  unsetenv ACE_RTL_SIM
endif
echo "--->---> sub processing PARCSMEB .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeb.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
setenv ACE_RTL_SIM vcs
 echo "--->---> sub processing PARCSMEB .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeb.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rfslvm*"|& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN 
if ( $?ace_rtl_sim_val ) then
  setenv ACE_RTL_SIM $ace_rtl_sim_val
  unset ace_rtl_sim_val
endif

# compensate for merge_upf tool problem (broadly-applied signal merging)
sed -i s:parcsmeb_pwell_wrapper/csme/i_psf20_top_csme/fab_pmc_fet_en_ack_b:parcsmeb_pwell_wrapper/i_idvp_fublet_parcsmeb_pwell_wrapper_0/idvtctrlo:     parcsmeb.inc*.tcl
sed -i s:parcsmeb_pwell_wrapper/csmeb1/moa_smt_ip0/csme_smt_pfet_ack_b:parcsmeb_pwell_wrapper/i_idvp_fublet_parcsmeb_pwell_wrapper_1/idvtctrlo: parcsmeb.inc*.tcl

## NLP/VCS changes
# remove "connect_supply_net ...vccdgt_1p0" lines (rf)
sed -i '/^\s*connect_supply_net\s*\Svnnprim_sm._pgd_rf_gated.\S\s*\-ports\s*\S*c73/ d' parcsmeb.sim.upf
sed -i '/^\s*connect_supply_net\s*\Svnnprim_usbr_pgd_rf_gated.\S\s*\-ports\s*\S*c73/ d' parcsmeb.sim.upf
# add load_upfs for EBBs/ROMs
sed -i '/source $::env(UPF_INSTALL_DIR)\/parcsmeb.inc.sim.tcl/r parcsmeb_design_attributes.txt' parcsmeb.sim.upf

cp -f $par.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/$par.upf
cp -f $par.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/

cp -f parcsmeb.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parcsmeb.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

if ( $?UPF_DEBUG_PARTITION ) goto endofscript


##------------------------------------------------------------------##
## PARLEG
##------------------------------------------------------------------##
echo  "\n ---> Processing PARLEG ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parleg) then
    rm -rf parleg
endif
mkdir parleg
cd parleg
cp -f -R $MODEL_ROOT/subIP/pmc_ROOT/tools/upf/LBG/isogen/* .
cp -f -R $MODEL_ROOT/subIP/p2sb_ROOT/tools/upf/LBG/* .
cp -f -R $MODEL_ROOT/subIP/spi_ROOT/tools/upf/LBG/* .
cp -f -R $MODEL_ROOT/subIP/smb_ROOT/tools/upf/* .
cp -f -R $MODEL_ROOT/subIP/lpc_ROOT/tools/upf/LBG/* .
cp -f -R $MODEL_ROOT/subIP/lpc_ROOT/tools/upf/LBG/sr_list/* .
cp -f -R $MODEL_ROOT/subIP/scanunit_ROOT/tools/upf/out/parleg_scanunit/* .
cp -f -R $MODEL_ROOT/subIP/IP_SBR_ROOT/tools/upf/router/* .
cp -f -R $MODEL_ROOT/subIP/smb_ROOT/tools/upf/LBG/* .
chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parleg
dos2unix pmc_pwell.upf
dos2unix p2sb.upf
dos2unix spi.upf
dos2unix smb_primary.upf
dos2unix parleg_scanunit.upf
dos2unix lpc_primary.upf
dos2unix sbr_config_ipxact_workspace_sbr11_top.upf
dos2unix smb.upf
cp -f $MODEL_ROOT/results/collage/upf/outputs/parleg* .

sed -i 's;info exists ::IP_ENABLE_ALL;info exists env(IP_ENABLE_ALL);g' parleg.upf
sed -i 's;subIP/pmc_ROOT/tools/upf/LBG/isogen;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/p2sb_ROOT/tools/upf/p2sb;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/spi_ROOT/tools/upf/LBG;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
#sed -i 's;subIP/smb_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/scanunit_ROOT/tools/upf/out/parleg_scanunit;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/lpc_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/IP_SBR_ROOT/tools/upf/router;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/subIP/smb_ROOT/tools/upf/LBG;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf
sed -i 's;subIP/smb_ROOT/tools/upf/LBG;results/collage/upf/outputs/merge_results/parleg;g' parleg.upf

sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/$::env(SIP_VARIATION)/soc_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' lpc_primary.upf
sed -i 's;source $LPC_UPF_ROOT_DIR/sr_list/lpc_sr.list;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg/lpc_sr.list;g' lpc_primary.upf
sed -i 's;source $LPC_UPF_ROOT_DIR/sr_list/lpc_doublesync_sr.list;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg/lpc_doublesync_sr.list;g' lpc_primary.upf
#sed -i 's;$P2SB_UPF_ROOT_DIR/p2sb_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' p2sb.upf
#sed -i 's;$P2SB_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' p2sb.upf
sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/LBG/soc_upf.cfg;#source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/LBG/soc_upf.cfg;g' p2sb.upf
sed -i 's;source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;#source $::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/soc_upf.cfg;g' p2sb.upf
sed -i 's;##source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' p2sb.upf
sed -i 's;source $P2SB_UPF_ROOT_DIR/p2sb_sr.list;source $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg/p2sb_sr.list;g' p2sb.upf
sed -i 's;$P2SB_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' p2sb.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/$::env(PMC_SIP_VARIATION);$env(MODEL_ROOT)/tools/upf;g' pmc_pwell.upf
sed -i 's;$PMC_PWELL_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' pmc_pwell.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/router;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' sbr_config_ipxact_workspace_sbr11_top.upf
sed -i 's;$::env(IP_ROOT)/tools/upf/soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' sbr_config_ipxact_workspace_sbr11_top.upf
sed -i 's;$SMB_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' smb_primary.upf
sed -i 's;$SPI_UPF_ROOT_DIR/spi_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' spi.upf
sed -i 's;source spi_upf.cfg;source $env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' spi.upf
sed -i 's;source spi_sr.list;source $env(MODEL_ROOT)/subIP/spi_ROOT/tools/upf/LBG/sr_list/spi_sr.list;g' spi.upf
sed -i 's;$SPI_SR_LIST_DIR/spi_sr.list;source $env(MODEL_ROOT)/subIP/spi_ROOT/tools/upf/LBG/sr_list/spi_sr.list;g' spi.upf
sed -i 's;$SPI_SR_LIST_DIR/spi_sr.list;source $env(MODEL_ROOT)/subIP/spi_ROOT/tools/upf/LBG/sr_list/spi_sr.list;g' spi.upf
sed -i 's;$SPI_ASSERTION_SR;0;g' spi.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/$::env(SIP_VARIATION)/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' pmc_pwell.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/$::env(SIP_VARIATION)/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' smb.upf
sed -i 's;$SMB_UPF_ROOT_DIR;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parleg;g' smb.upf

sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf/$::env(SIP_VARIATION)/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' smb_primary.upf
sed -i 's;$::env(ACE_ENG)/$::env(ACE_PWA_DIR)/tools/upf//$::env(SIP_VARIATION)/soc_upf.cfg;$env(MODEL_ROOT)/tools/upf/soc_upf.cfg;g' smb_rtc.upf

# Set correct level shifter cell to use
# -> This overrides the variable included in "tools/upf/soc_upf.cfg" and has to do with where the 
#    level shifting occurs (on the outputs of the domain, or on the inputs to the domain). This
#    fixes the vccdsw->vnnprim level shifter since the shifters are placed in vccdsw. The
#    vccio->vnnprim level shifters are added later and need the d04slgn2ld0d5 version since the
#    shifter is on an input to the domain.
# d04slgn2ld0d5 "d04slgn2ld0d5" ls # H->L or L->H level shifter, std rail on output vcc, use on non-iso inputs
# d04slgn5ld0d5 "d04slgn5ld0d5" ls # H->L or L->H level shifter, std rail on input vcc, use on non-iso outputs
perl -p -i -e 'if (/create_power_domain.*pd_pwell_parleg_pd.*/) {$_ .= "set LS_HL_BUF_S_CELL \"d04slgn5ld0d5\"\n";}' parleg.upf

# Merge the power domain to 4: vccdsw, vnnprim, and 2 gated vnnprim (SPI & PES)
setenv PROJNAME p2sb
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> merge sub processing PARLEG .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
# Run with the Spyglass variables set
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parleg.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parleg.tcl -inc_file -tag slp -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN
# Rerun to get DC version (paths/structure references are different)
echo "--->---> merge sub processing PARLEG .... Running for DC ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parleg.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parleg.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
setenv ENABLE_NLP_RUN 1
echo "--->---> merge sub processing PARLEG .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parleg.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parleg.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1rf*" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN
unsetenv PROJNAME

# Copy include tcl file to $UPF_INSTALL_DIR so the files are picked up in future commands.
echo " Copying inc impl tcl to the outputs area .. "
cp parleg.inc.slp.tcl  $MODEL_ROOT/results/collage/upf/outputs/parleg.inc.slp.tcl
cp parleg.inc.impl.tcl $MODEL_ROOT/results/collage/upf/outputs/parleg.inc.impl.tcl
cp parleg.inc.sim.tcl  $MODEL_ROOT/results/collage/upf/outputs/parleg.inc.sim.tcl

## -- Add intermediate LS hierarchy needed in parrtc
## -- Intermediate LS is needed as libs cells cannot LS from vnnprim to vccrtc directly.
## -- There is two stages of level shifting vnnprim<->vccio_parleg<->vccrtc.
echo "Inserting level shifters into PARLEG" 
perl $MODEL_ROOT/tools/upf/scripts/parleg_insert_ls.pl |& tee -a ${LOG_FILE_LOCATION}
# Copy include tcl file to $UPF_INSTALL_DIR
cp parleg.inc.*.ls.tcl $MODEL_ROOT/results/collage/upf/outputs

# Fix up connections to vccdgt_1p0 pins
# -> PMC UPF has these connected to vnnprim.
perl -p -i -e 's/connect_supply_net \"vnnprim\"(.*rom_wrapper.*vccdgt_1p0.)/connect_supply_net \"vnnprim_rom_gated1\"\1/;' parleg.impl.ls.upf parleg.slp.ls.upf
perl -p -i -e 's/connect_supply_net \"vnnprim\"(.*rf_wrapper.*vccdgt_1p0.)/connect_supply_net \"vnnprim_rf_gated1\"\1/;' parleg.impl.ls.upf parleg.slp.ls.upf

# Add missing connection to RF in DSW to both Spyglass and DC UPFs
# -> This is missing from PMC UPF.
echo 'create_supply_net -domain "pd_dsw_parleg_pd" "vccdsw_rf_gated" -resolve "parallel"' >> parleg.impl.ls.upf
echo 'connect_supply_net "vccdsw_1p0" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vccd_1p0"' >> parleg.impl.ls.upf
echo 'connect_supply_net "vccdsw_rf_gated" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vccdgt_1p0"' >> parleg.impl.ls.upf
echo 'connect_supply_net "vss" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vss"' >> parleg.impl.ls.upf
echo 'create_supply_net -domain "pd_dsw_parleg_pd" "vccdsw_rf_gated" -resolve "parallel"' >> parleg.slp.ls.upf
echo 'connect_supply_net "vccdsw_1p0" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vccd_1p0"' >> parleg.slp.ls.upf
echo 'connect_supply_net "vccdsw_rf_gated" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vccdgt_1p0"' >> parleg.slp.ls.upf
echo 'connect_supply_net "vss" -ports "parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4/vss"' >> parleg.slp.ls.upf

# Various munging of the UPF
echo "--->---> munge sub processing PARLEG .... Running for DC ....." |& tee -a ${LOG_FILE_LOCATION}
${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.impl.ls.upf -config $MODEL_ROOT/tools/upf/scripts/parleg_insert_intermediate_ls.tcl -inc_file -tag impl -verbose |& tee -a ${LOG_FILE_LOCATION}
echo "--->---> munge sub processing PARLEG .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.slp.ls.upf -config $MODEL_ROOT/tools/upf/scripts/parleg_insert_intermediate_ls.tcl -inc_file -tag impl -verbose |& tee -a ${LOG_FILE_LOCATION}
echo "--->---> munge sub processing PARLEG .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.sim.ls.upf -config $MODEL_ROOT/tools/upf/scripts/parleg_insert_intermediate_ls.tcl -inc_file -tag sim -verbose -skip_load_upfs "c73p1rf*" |& tee -a ${LOG_FILE_LOCATION}

# Copy/rename files and update include lines for consistent naming.
cp parleg.impl.ls.impl.upf     parleg.impl.upf
cp parleg.impl.ls.inc.impl.tcl parleg.inc.impl.tcl
cp parleg.slp.ls.impl.upf      parleg.spyglass.upf
cp parleg.slp.ls.inc.impl.tcl  parleg.inc.spyglass.tcl
cp parleg.sim.ls.sim.upf       parleg.sim.upf
cp parleg.sim.ls.inc.sim.tcl   parleg.inc.sim.tcl
sed -i 's;parleg.impl.ls.inc.impl.tcl;parleg.inc.impl.tcl;g' parleg.impl.upf
sed -i 's;parleg.slp.ls.inc.impl.tcl;parleg.inc.spyglass.tcl;g' parleg.spyglass.upf
sed -i 's;parleg.sim.ls.inc.sim.tcl;parleg.inc.sim.tcl;g' parleg.sim.upf

# Munge is removing the '-resolve "parallel"' option from the gated supplies. Add them back
perl -p -i -e 'if (/create_supply_net.*vnnprim_(rf|rom)_gated1/) {chop ; $_ .= " -resolve \"parallel\"\n";}' parleg.impl.upf parleg.spyglass.upf parleg.sim.upf

# PD request to isolate these signals: spi_io_csb_inenb[3], spi_io_csb_o[3] & spi_io_csb_pdenb[3] in parleg_pwell_wrapper/spi_pw1/spi_pgd_top1.
#  These signals don't actually fanout to any logic, so the isolation is not required and not harming anything.
perl -p -i -e 'if (/set PARLEG_PWELL_WRAPPER_SPI_PW1_PD_SPI_PGD_TO_PD_SPI_UGD_PINS/) {$_ .= "  parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/spi_io_csb_inenb[3]\n  parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/spi_io_csb_o[3]\n  parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/spi_io_csb_pdenb[3]\n"; }' parleg.inc.impl.tcl parleg.inc.spyglass.tcl parleg.inc.sim.tcl

# Remove retention strategies (LBG decision to not have retention in parleg)
perl -p -i -e 'if (/^(set_retention|map_retention_cell)/){while(/\\/){$_=<>;}$_=""}' parleg.impl.upf parleg.spyglass.upf parleg.sim.upf

# Add wtap_AWTAP_WSO to vccio->vnnprim ELS
perl -p -i -e 'if (/set PD_PWELL_PD_INTERMEDIATE_IP_LS_H2L_ISO_PINS/){$_ .= "  wtap_AWTAP_WSO\n"}' parleg.inc.impl.tcl parleg.inc.spyglass.tcl parleg.inc.sim.tcl
perl -p -i -e 'if (/set PD_PWELL_PD_INTERMEDIATE_IP_LS_H2L_PINS/){$_ .= "  wtap_AWTAP_WSO\n"}' parleg.inc.impl.tcl parleg.inc.spyglass.tcl parleg.inc.sim.tcl

# Add wtap_FWTAP_WRCK to clock level shifter list
perl -p -i -e 'if (/set PD_PWELL_PD_INTERMEDIATE_IP_CLOCK_PORT_LS_PINS/){$_ .= "  wtap_FWTAP_WRCK\n"}' parleg.inc.impl.tcl parleg.inc.spyglass.tcl parleg.inc.sim.tcl

# Fixup for Spyglass -> The converts "dc" style structure references to spyglass style
perl -p -i -e 's/(csme_rtc_prim2rtc_gclatchen\[0\]\[0\])/csme_rtc_prim2rtc_gclatchen\[\*\]\n  \1/;' parleg.inc.spyglass.tcl
perl -p -i -e 'if(/creg_pc(e|gc)\./){s/\[\d+\]//;s/\./\[/;chop;$_.="]*\n";};' parleg.inc.spyglass.tcl

# Fix set voltage commands
sed -i 's;set_voltage -object_list "vnnprim_rom_gated1".*;set_voltage -object_list "vnnprim_rom_gated1" -min 0.75 0.75;g' parleg.impl.upf parleg.spyglass.upf parleg.sim.upf
sed -i 's;set_voltage -object_list "vccdsw_rf_gated".*;set_voltage -object_list "vccdsw_rf_gated" -min 0.94 0.94;g' parleg.impl.upf parleg.spyglass.upf parleg.sim.upf
perl -p -i -e 'if (/set_voltage.*\"vnnprim_rf_gated1\"/){s/N\/A/-min 0.75 0.75/;} if (/set_voltage.*\"vnnprim_rom_gated1\"/) {$_.="  set_voltage -object_list \"vnnprim_rom_gated0\" -min 0.75 0.75\n  set_voltage -object_list \"vccdsw_rf_gated\" -min 0.94 0.94\n";}' parleg.impl.upf parleg.spyglass.upf parleg.sim.upf

# Fix paths on load_upf in sim
perl -p -i -e 's/load_upf.*p1273\/mem_(.*?)\//load_upf "\$::env(ACE_ENG)\/\$::env(ACE_PWA_DIR)\/subIP\/mem_\1_ROOT\//;' parleg.sim.upf
perl -p -i -e 's/.*(vnnprim_rf_gated1|vnnprim_rom_gated0).*//;' parleg.sim.upf

# HSD5235017 change SPI_HW_DECOMPRESSION1/spi_hw_decompression1 to SPI_HW_DECOMPRESSION1.spi_hw_decompression1
# -> This fixes the hierarchy reference for FEV (Conformal)
perl -p -i -e 'if(/control_port/){s/SPI_HW_DECOMPRESSION1\/spi_hw_decompression1/SPI_HW_DECOMPRESSION1.spi_hw_decompression1/;}' parleg.*.upf

# HSD5511873: Put the tie-off buffer in the DSW power domain.
perl -p -i -e 'if (/set PD_DSW_PARLEG_PD_ELEMENTS/){for($i=0;$i<14;$i++){$_.="  dummy_unit_parlegdsw_$i\n"}}' parleg.inc.impl.tcl parleg.inc.spyglass.tcl parleg.inc.sim.tcl

# Remove a spurious element in isolations. It is a hierarchy without a signal.
perl -p -i -e 'if(/parleg_pwell_wrapper\/p2sb1\/$/){$_="";};' parleg.inc.sim.tcl parleg.inc.impl.tcl parleg.inc.spyglass.tcl

sed -i 's;mode_atpg;mode_ramseq;g' parleg.*.upf parleg.inc.*.tcl
sed -i 's;16Kb/mode_ramseq.c73p1rfshdmrom2048;16Kb/mode_atpg.c73p1rfshdmrom2048;g' parleg.*.upf parleg.inc.*.tcl
sed -i 's;_4Kb/mode_ramseq.c73p1rfshdmrom512;_4Kb/mode_atpg.c73p1rfshdmrom512;g' parleg.*.upf parleg.inc.*.upf

## 151007 Uzair: It was missing due to ECO done by DFX team (Yee Khang). The signal now is bypassing the inverter (INV1). 
##		 In order to keep the parleg.upf same as previous release (parleg_b0_aug), those missing iso and level shifter cell were added as shown below.
echo "### parleg.inc.*.tcl ---- START ----"
sed -i '/parleg_dswwell_wrapper\/gpd_0_fivrbreak_n_txen_b/ d' parleg.inc.*.tcl

sed -i '2233 i set PD_DSW_PARLEG_PD_PMCI_IOOCPUPWRGD_INV1_TO_PARLEG_DSWWELL_WRAPPER_UNSPECIFIED_0_ISO_PINS {\n    parleg_dswwell_wrapper/gpd_0_fivrbreak_n_txen_b\n  }\n' parleg.inc.*.tcl
sed -i '2915 i # --- Pins of LS pd_dsw_parleg_pd_pmci_ioocpupwrgd_inv1_to_parleg_dswwell_wrapper_unspecified_0_iso_ls\nset PD_DSW_PARLEG_PD_PMCI_IOOCPUPWRGD_INV1_TO_PARLEG_DSWWELL_WRAPPER_UNSPECIFIED_0_ISO_LS_PINS {\n  parleg_dswwell_wrapper\/gpd_0_fivrbreak_n_txen_b\n  }\n' parleg.inc.*.tcl

echo "### parleg.inc.*.tcl ---- END ----"

echo "### parleg.*.upf ----- START -----"
sed -i '330 i set_isolation "pd_dsw_parleg_pd_pmci_ioocpupwrgd_inv1_to_parleg_dswwell_wrapper_unspecified_0_iso" \\\\
  \-domain "pd_dsw_parleg_pd" \\\\
  \-isolation_power_net "vccdsw_1p0" \\\\
  \-isolation_ground_net "vss" \\\\
  \-clamp_value 0 \\\\
  \-elements $PD_DSW_PARLEG_PD_PMCI_IOOCPUPWRGD_INV1_TO_PARLEG_DSWWELL_WRAPPER_UNSPECIFIED_0_ISO_PINS\\
\\
set_isolation_control "pd_dsw_parleg_pd_pmci_ioocpupwrgd_inv1_to_parleg_dswwell_wrapper_unspecified_0_iso" \\\\
  \-domain "pd_dsw_parleg_pd" \\\\
  \-isolation_signal "int_pwell_pok_dsw" \\\\
  \-isolation_sense "low" \\\\
  \-location "self"\\
\\
map_isolation_cell "pd_dsw_parleg_pd_pmci_ioocpupwrgd_inv1_to_parleg_dswwell_wrapper_unspecified_0_iso" \\\\
  \-domain    "pd_dsw_parleg_pd" \\\\
  \-lib_cells "d04sva00ld0b0"\\
' parleg.impl.upf parleg.spyglass.upf

sed -i '575 i set_level_shifter "pd_dsw_parleg_pd_pmci_ioocpupwrgd_inv1_to_parleg_dswwell_wrapper_unspecified_0_iso_ls" \-domain "pd_dsw_parleg_pd" \\\\
  \-threshold 0 \\\\
  \-rule      "low_to_high" \\\\
  \-location  "self" \\\\
  \-elements $PD_DSW_PARLEG_PD_PMCI_IOOCPUPWRGD_INV1_TO_PARLEG_DSWWELL_WRAPPER_UNSPECIFIED_0_ISO_LS_PINS\\
' parleg.impl.upf parleg.spyglass.upf


echo "### parleg.*.upf -----  END  -----"


#########################Create parleg.sim.upf from parleg.impl.upf###############################
rm -f parleg.sim.upf
cp parleg.impl.upf parleg.sim.upf
sed -i 's;parleg.inc.impl.tcl;parleg.inc.sim.tcl;g' parleg.sim.upf
sed -i '/vccdgt_1p0"\s*$/d' parleg.sim.upf

sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w256x16be2hb4.upf -scope parleg_dswwell_wrapper/pmcdswunit_wrapper1/i_pmcdsw_rf_rom_wrapper/i_dsw_ram0/mode_ramseq.c73p1rfslvm1r1w256x16be2hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_0/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_1/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_2/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_3/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_4/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_5/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_6/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x138hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_patch_rf_wrapper/i_8K_RAM_7/mode_ramseq.c73p1rfslvm1r1w512x138hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w256x72be8hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rf_wrapper/i_2K_RAM/genc73p1rfslvm1r1w256x72be8hb4_dfx_wrapper_be_instirfap1r1w256d72w8sp_dfx_wrapper_bework.c73p1rfslvm1r1w256x72be8hb4_dfx_wrapper_be_inst/mode_ramseq.c73p1rfslvm1r1w256x72be8hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x72be8hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rf_wrapper/i_4K_RAM_0/genc73p1rfslvm1r1w512x72be8hb4_dfx_wrapper_be_instirfap1r1w512d72w8sp_dfx_wrapper_bework.c73p1rfslvm1r1w512x72be8hb4_dfx_wrapper_be_inst/mode_ramseq.c73p1rfslvm1r1w512x72be8hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rf_ROOT/rtl/upf/c73p1rfslvm1r1w512x72be8hb4.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rf_wrapper/i_4K_RAM_1/genc73p1rfslvm1r1w512x72be8hb4_dfx_wrapper_be_instirfap1r1w512d72w8sp_dfx_wrapper_bework.c73p1rfslvm1r1w512x72be8hb4_dfx_wrapper_be_inst/mode_ramseq.c73p1rfslvm1r1w512x72be8hb4' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom2048x64hb4img82.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom0_16Kb/mode_atpg.c73p1rfshdmrom2048x64hb4img82' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom2048x64hb4img83.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom1_16Kb/mode_atpg.c73p1rfshdmrom2048x64hb4img83' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img70.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom2_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img70' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img71.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom3_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img71' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img72.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom4_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img72' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img73.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom5_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img73' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img74.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom6_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img74' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img75.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom7_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img75' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img76.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom8_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img76' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom512x64hb4img77.upf -scope parleg_pwell_wrapper/pmc_pwell1/pmcisusunit_wrapper1/i_pmcisus_rom_wrapper/i_rom9_4Kb/mode_atpg.c73p1rfshdmrom512x64hb4img77' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom2048x32hb4img70.upf -scope parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/spi_core1/SPI_HW_DECOMPRESSION1.spi_hw_decompression1/xph_rombist_wrapper1/dicrom_wrapper_8kb/mode_ramseq.c73p1rfshdmrom2048x32hb4img70' parleg.sim.upf
sed -i '/parleg.inc.sim.tcl/a load_upf $::env(MODEL_ROOT)/subIP/mem_rom_ROOT/rtl/upf/c73p1rfshdmrom2048x36hb4img70.upf -scope parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/spi_core1/SPI_HW_DECOMPRESSION1.spi_hw_decompression1/xph_rombist_wrapper1/hfmrom_wrapper_8kb/mode_ramseq.c73p1rfshdmrom2048x36hb4img70'  parleg.sim.upf
##################################################################################################

## 150625 Uzair: HSD bug_id=5512483 => remove all VCS "IF" statement for IDV
#add idv vcc connections to end of upf files
#sed -i '$a ###RJS:012715 --create/connect supply for IDVs for NLP only' parleg.*.upf
#sed -i '$a if {[info exists synopsys_program_name] && ($synopsys_program_name == "vcs")} {' parleg.*.upf
#sed -i '$a connect_supply_net "vnnprim" -ports "parleg_pwell_wrapper/i_idvp_fublet_parleg_pwell_wrapper_0/i_c73_d8xmidvmif/vccidv_nom"' parleg.*.upf
#sed -i '$a connect_supply_net "vnnprim" -ports "parleg_pwell_wrapper/i_idvp_fublet_parleg_pwell_wrapper_1/i_c73_d8xmidvmif/vccidv_nom"' parleg.*.upf
#sed -i '$a }' parleg.*.upf

sed -i '$a ## 150625 UZ:  --create/connect supply for IDVs' parleg.*.upf
sed -i '$a connect_supply_net "vnnprim" -ports "parleg_pwell_wrapper/i_idvp_fublet_parleg_pwell_wrapper_0/i_c73_d8xmidvmif/vccidv_nom"' parleg.*.upf
sed -i '$a connect_supply_net "vnnprim" -ports "parleg_pwell_wrapper/i_idvp_fublet_parleg_pwell_wrapper_1/i_c73_d8xmidvmif/vccidv_nom"' parleg.*.upf

## 152815: RJS: HSD #: Isolation signal restored back to A0 version -- signal is a dont care due to
#  ICC constraints on the signal make an AON channel for it - it is NOT affected by the PGD domain it runs through
sed -i '/parleg_pwell_wrapper\/spi_pw1\/spi_pgd_top1\/aary_LV_WSO_rom/a \  parleg_pwell_wrapper/spi_pw1/spi_pgd_top1/aary_pwren_b_rom' parleg.inc.*.tcl


cp -f parleg.impl.upf     parleg.inc.impl.tcl     $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parleg.spyglass.upf parleg.inc.spyglass.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parleg.sim.upf      parleg.inc.sim.tcl      $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------##
## PARFIA20
##------------------------------------------------------------------##
echo  "\n ---> Processing PARFIA20 ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parfia20) then
    rm -rf parfia20
endif
mkdir parfia20
cd parfia20

##Copy all colllage generated upf output files for this partition to current directory
cp -f $MODEL_ROOT/results/collage/upf/outputs/parfia20* .

##Copy all subIP UPF for this parititon to current directory and make UNIX clean
cp -f    $MODEL_ROOT/subIP/fia0_ROOT/tools/upf/FIA.upf .
cp -f    $MODEL_ROOT/subIP/hip_wm20_ROOT/rtl/upf/* .

dos2unix FIA.upf 
dos2unix c73p1wmgen3x20familyew.upf

chmod -R 755 $COLLAGE_WORK/upf/outputs/merge_results/parfia20

##edit partition UPF file for synthesis
sed -i 's;subIP/fia0_ROOT/tools/upf;results/collage/upf/outputs/merge_results/parfia20;g' parfia20.upf
sed -i 's;subIP/hip_wm20_ROOT/rtl/upf;results/collage/upf/outputs/merge_results/parfia20;g' parfia20.upf
sed -i 's;$env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia20;g' c73p1wmgen3x20familyew.upf
sed -i 's;$env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia20;g' c73pcie20_c73p1wmlanetopew.upf
sed -i 's;$env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia20;g' c73pcie20_c73p1wmcmnlane_hptopew.upf
sed -i 's;$env(DUV_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/parfia20;g' c73pcie20_c73p1wmcmnlane_lptopew.upf
##edits for NLP -- prevents conflicts between parfia and parfia20 
sed -i '/set numComLanes 1/a set hybrid_common_mst1_out_ports ""' c73p1wmgen3x20familyew.upf
sed -i '/set numComLanes 1/a set hybrid_common_mst0_out_ports ""' c73p1wmgen3x20familyew.upf
sed -i '/set numComLanes 1/a set hybrid_common_mst1_in_ports ""' c73p1wmgen3x20familyew.upf
sed -i '/set numComLanes 1/a set hybrid_common_mst0_in_ports ""' c73p1wmgen3x20familyew.upf
sed -i '/set numDatLanes 19/a set hybrid_datalane_out_ports ""' c73p1wmgen3x20familyew.upf 
sed -i '/set numDatLanes 19/a set hybrid_datalane_in_ports ""' c73p1wmgen3x20familyew.upf
sed -i 's;family_gaon_ports;family_fia20_gaon_ports;g' c73p1wmgen3x20familyew.upf

setenv SIP_LIBRARY_VOLTAGE 0.75
setenv IP_ENABLE_ALL 1
setenv SPYGLASS_LP_RUN 1
setenv ENABLE_SLP_RUN 1
echo "--->---> sub processing PARFIA20 .... Running for SLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia20.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia20.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1wmgen3x20family*" |& tee -a ${LOG_FILE_LOCATION} 
unsetenv ENABLE_SLP_RUN
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARFIA20 .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia20.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia20.tcl  -tag sim -set_vars "synopsys_program_name dc_shell" -skip_load_upfs "c73p1wmgen3x20family*" |& tee -a ${LOG_FILE_LOCATION} 
unsetenv ENABLE_NLP_RUN



##Comment out load_upf line for wm20 (SPYGLASS/DC only)
sed -i 's;load_upf;#RJS: commented out for SLP runs: load_upf;g' parfia20.impl.upf

#cp -f parfia20.slp.upf parfia20.impl.upf


#setenv SPYGLASS_LP_RUN 0
#setenv ENABLE_SLP_RUN 0
#echo "--->---> sub processing PARFIA20 .... Running for VCS ....." |& tee -a ${LOG_FILE_LOCATION}
#${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parfia20.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parfia20.tcl  -tag vcs -set_vars "synopsys_program_name junk" -skip_load_upfs "c73p1wmgen3x20familyew*" |& tee -a ${LOG_FILE_LOCATION} 
#unsetenv SPYGLASS_LP_RUN
#unsetenv ENABLE_SLP_RUN
#cp -f parfia20.vcs.upf parfia20.merged.upf

### 150918 Uzair: Revert below changes for B0 isclk lib
## HSD#5510291 -- isclk changing related voltage for this pin to a 1p05 voltage (versus vnnprim)
#sed -i 's;set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list \[get_ports "mphy_gen2pxppllref_clk"\];set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list [get_ports "mphy_gen2pxppllref_clk"];g' parfia20.*.upf
#sed -i 's;set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list "mphy_gen2pxppllref_clk";set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list "mphy_gen2pxppllref_clk";g' parfia20.*.upf
#sed -i 's;set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list \[get_ports "wm20_i_com1_ck_pll1corerefclk"\];set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list [get_ports "wm20_i_com1_ck_pll1corerefclk"];g' parfia20.*.upf
#sed -i 's;set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list "wm20_i_com1_ck_pll1corerefclk";set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list "wm20_i_com1_ck_pll1corerefclk";g' parfia20.*.upf

#####->080115 --  isclk voltage change from vcca_nssc_1p05 -> vcca_dig_1p05 --- redoing above with new voltage
sed -i 's;set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "mphy_gen2pxppllref_clk"\];set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list [get_ports "mphy_gen2pxppllref_clk"];g' parfia20.*.upf
sed -i 's;set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "mphy_gen2pxppllref_clk";set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list "mphy_gen2pxppllref_clk";g' parfia20.*.upf
sed -i 's;set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list \[get_ports "wm20_i_com1_ck_pll1corerefclk"\];set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list [get_ports "wm20_i_com1_ck_pll1corerefclk"];g' parfia20.*.upf
sed -i 's;set_related_supply_net -power "vcca_dig_1p05" -ground "vss" -object_list "wm20_i_com1_ck_pll1corerefclk";set_related_supply_net -power "vccapcie2pll_1p05" -ground "vss" -object_list "wm20_i_com1_ck_pll1corerefclk";g' parfia20.*.upf

##--110415:RJS: Remove parfia20.inc.impl.upf from parfia20.impl.upf: reason (empty file)
sed -i '/source $::env(UPF_INSTALL_DIR)\/parfia20.inc.impl.tcl/d' parfia20.impl.upf


## Copying the files to central area 
#cp -f parfia20.impl.upf $COLLAGE_WORK/upf/outputs/parfia20.merged.upf

cp -f parfia20.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfia20.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f parfia20.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
#cp -f parfia20.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/


##------------------------------------------------------------------##
## PARRTC
##------------------------------------------------------------------##

echo  "\n ---> Processing PARRTC ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d parrtc) then
    rm -rf parrtc
endif
mkdir parrtc
cd parrtc

cp -f $MODEL_ROOT/results/collage/upf/outputs/parrtc* .

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARRTC .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parrtc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parrtc.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARRTC .... Running for SIM ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parrtc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parrtc.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

# Copying inc impl tcl to the outputs area so the munge_upf script can find them
cp -f parrtc.inc.impl.tcl $MODEL_ROOT/results/collage/upf/outputs/parrtc.inc.impl.tcl
cp -f parrtc.inc.sim.tcl $MODEL_ROOT/results/collage/upf/outputs/parrtc.inc.sim.tcl

echo "--->---> sub processing PARRTC .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parrtc.impl.upf -config $MODEL_ROOT/tools/upf/scripts/parrtc_insert_intermediate_ls.tcl -verbose -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}

echo "--->---> sub processing PARRTC .... Running for SIM ....." |& tee -a ${LOG_FILE_LOCATION}
${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parrtc.sim.upf -config $MODEL_ROOT/tools/upf/scripts/parrtc_insert_intermediate_ls.tcl -verbose -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}

# Fix up pins that munge script doesn't change SRSN correctly
perl -p -i -e 's/(set_related_supply_net -power ")vnnprim/\1vccioparleg_1p05/;' parrtc.impl.impl.upf parrtc.sim.sim.upf

# Remove vnnprim
egrep -v '"vnnprim"' parrtc.impl.impl.upf > parrtc.impl.impl.upf.tmp
cp parrtc.impl.impl.upf.tmp parrtc.impl.impl.upf
egrep -v '"vnnprim"' parrtc.sim.sim.upf > parrtc.sim.sim.upf.tmp
cp parrtc.sim.sim.upf.tmp parrtc.sim.sim.upf

# Fix voltage
sed -i 's;set_voltage -object_list "vccioparleg_1p05".*;set_voltage -object_list "vccioparleg_1p05" -min 0.94 0.94;g' parrtc.impl.impl.upf parrtc.sim.sim.upf

# Remove power/gnd connections to EBBs on sim UPF
egrep -v 'connect_supply_net.*xrrtcram9t1r1w16x321' parrtc.sim.sim.upf > parrtc.sim.sim.upf.tmp
cp -f parrtc.sim.sim.upf.tmp parrtc.sim.sim.upf

# Copy UPFs to release directory
cp -f parrtc.impl.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/parrtc.impl.upf
cp -f parrtc.sim.sim.upf   $MODEL_ROOT/source/gen/upf/fc_par/parrtc.sim.upf
cp -f parrtc.impl.inc.impl.tcl parrtc.sim.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

# Create Spyglass version - Start with the dc_shell version
cp -f parrtc.impl.impl.upf     $MODEL_ROOT/source/gen/upf/fc_par/parrtc.spyglass.upf
cp -f parrtc.impl.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/parrtc.spyglass.inc.upf
sed -i 's;parrtc.impl.inc.impl.tcl;parrtc.spyglass.inc.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/parrtc.spyglass.upf

# Spyglass treats the multi-dim array differently. Change it to a '*'
perl -p -i -e 's/(csme_rtc_prim2rtc_gclatchen\[0\]\[0\])/csme_rtc_prim2rtc_gclatchen\*\n  \1/;' $MODEL_ROOT/source/gen/upf/fc_par/parrtc.spyglass.inc.upf


##------------------------------------------------------------------##
## PARICC
##------------------------------------------------------------------##

echo  "\n ---> Processing PARICC ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d paricc) then
    rm -rf paricc
endif
mkdir paricc
cd paricc

cp -f $MODEL_ROOT/results/collage/upf/outputs/paricc* .

setenv SPYGLASS_LP_RUN 0
setenv ENABLE_SLP_RUN 0
echo "--->---> sub processing PARICC .... Running for IMPL ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf paricc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_paricc.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv SPYGLASS_LP_RUN
unsetenv ENABLE_SLP_RUN

setenv ENABLE_NLP_RUN 1
echo "--->---> sub processing PARICC .... Running for NLP ....." |& tee -a ${LOG_FILE_LOCATION}
${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf paricc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_paricc.tcl  -inc_file -tag sim -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
unsetenv ENABLE_NLP_RUN

##HACK for replacing incorrect voltages from PARRTC -- remove when PARRTC UPF is released
#sed -i 's;set_related_supply_net -power "vccrtcwell_ehv";set_related_supply_net -power "vnnprim";g' paricc.impl.upf 
#sed -i 's;set_related_supply_net -power "vccusbdsw_1p0";set_related_supply_net -power "vnnprim";g' paricc.impl.upf 
#sed -i 's;set_related_supply_net -power "vccdsw_1p0";set_related_supply_net -power "vnnprim";g' paricc.impl.upf 

#sed -i 's;set_related_supply_net -power "vccrtcwell_ehv";set_related_supply_net -power "vnnprim";g' paricc.sim.upf 
#sed -i 's;set_related_supply_net -power "vccusbdsw_1p0";set_related_supply_net -power "vnnprim";g' paricc.sim.upf 
#sed -i 's;set_related_supply_net -power "vccdsw_1p0";set_related_supply_net -power "vnnprim";g' paricc.sim.upf 

#cp -f paricc.impl.upf paricc.merged.upf

## Copying the files to one area 
#cp -f paricc.merged.upf $COLLAGE_WORK/upf/outputs/.
#cp -f paricc.inc.impl.tcl $COLLAGE_WORK/upf/outputs/.

sed -i 's;vccdsw_1p0;vnnprim;g' paricc.*.upf 

# add IDV vcc connections to end of UPF files
## 150625 Uzair: HSD bug_id=5512483 => remove all VCS "IF" statement for IDV
#sed -i '$a ###RJS: 012715 --create/connect supply for IDVs for NLP only' paricc.*.upf
#sed -i '$a if {[info exists synopsys_program_name] && ($synopsys_program_name == "vcs")} {' paricc.*.upf
#sed -i '$a  connect_supply_net "vnnprim" -ports "paricc_pwell_wrapper/i_idvp_fublet_paricc_pwell_wrapper_0/i_c73_d8xmidvmif/vccidv_nom"' paricc.*.upf
#sed -i '$a }' paricc.*.upf

sed -i '$a ## 150814 UZ:  --create/connect supply for IDVs' paricc.*
sed -i '$a  connect_supply_net "vnnprim" -ports "paricc_pwell_wrapper/i_idvp_fublet_paricc_pwell_wrapper_0/i_c73_d8xmidvmif/vccidv_nom"' paricc.*.upf


cp -f paricc.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f paricc.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/
cp -f paricc.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/
cp -f paricc.inc.sim.tcl $MODEL_ROOT/source/gen/upf/fc_par/

##------------------------------------------------------------------------##
## lbgns_io_wrapper
##------------------------------------------------------------------------##

echo  "\n ---> Processing LBGNS_IO_WRAPPER ...." |& tee -a ${LOG_FILE_LOCATION}

cd $COLLAGE_WORK/upf/outputs/merge_results
if (-d lbgns_io_wrapper) then
    rm -rf lbgns_io_wrapper
endif
mkdir lbgns_io_wrapper
cd lbgns_io_wrapper

cp -f $MODEL_ROOT/results/collage/upf/outputs/lbgns_io_wrapper* .
cp -f $MODEL_ROOT/results/collage/upf/outputs/upf_global_defs.tcl .
cp -f $MODEL_ROOT/tools/collage/configs/config_lbg_0.5/soc/integ_specs/upf/lbgns_io_wrapper_design_attributes.txt .

## Add IP_ENABLE_ALL to upf
sed -i '/# --- File: lbgns_io_wrapper.upf; UPF file for partition "lbgns_io_wrapper"/a set ::IP_ENABLE_ALL 1' lbgns_io_wrapper.upf

## Add DC condition to all IPs
sed -i 's;if { \[info exists ::env(SPYGLASS_RUN)\] || \[info exists ::env(CONFORMAL_RUN)\] };if { [info exists ::env(SPYGLASS_RUN)] || [info exists ::env(CONFORMAL_RUN)] || ([info exists synopsys_program_name] \&\& ($synopsys_program_name == "dc_shell")) };g' lbgns_io_wrapper.upf

## Comment out primary power net vccprtc_3p3 original line and move to end of file
sed -i 's;set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" \\;##rjs: set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" ;g' lbgns_io_wrapper.upf 
sed -i 's;-primary_power_net  "vccprtc_3p3" \\;##rjs: -primary_power_net  "vccprtc_3p3" ;g' lbgns_io_wrapper.upf
sed -i 's;-primary_ground_net "vss";##rjs: -primary_ground_net "vss";g' lbgns_io_wrapper.upf 

sed -i '/source \${UPF_INSTALL_DIR}\/lbgns_io_wrapper_set_voltage.tcl/a ## --- rjstach: manual edit -> move from above down to end of file ' lbgns_io_wrapper.upf
sed -i '/## --- rjstach: manual edit -> move from above down to end of file/a set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" -primary_power_net  "vccprtc_3p3" -primary_ground_net "vss" ' lbgns_io_wrapper.upf 

## add thrmda SRSN -- INOUT pins to pads sometimes do not get recognized by collage
sed -i '/set_related_supply_net -power "vccio_1p05" -ground "vss" -object_list \[get_ports "thrmdc"\]/a \    set_related_supply_net -power "vccio_1p05" -ground "vss" -object_list [get_ports "thrmda"]' lbgns_io_wrapper_set_voltage.tcl
sed -i '/set_related_supply_net -power "vccio_1p05" -ground "vss" -object_list "thrmdc"/a \    set_related_supply_net -power "vccio_1p05" -ground "vss" -object_list "thrmda"' lbgns_io_wrapper_set_voltage.tcl

## HSD#5510291 -- isclk pin related voltage changing to vcca_src_1p05 or vcca_nssc_1p05 -- 
sed -i 's;set_related_supply_net -power "vccmphy_1p05";set_related_supply_net -power "vcca_src_1p05";g' lbgns_io_wrapper_set_voltage.tcl 
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "mphy_gen2pxppllref_clk"\];set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list [get_ports "mphy_gen2pxppllref_clk"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "mphy_gen2pxppllref_clk";set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list "mphy_gen2pxppllref_clk";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "usbpllref_clk"\];set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list [get_ports "usbpllref_clk"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "usbpllref_clk";set_related_supply_net -power "vcca_nssc_1p05" -ground "vss" -object_list "usbpllref_clk";g' lbgns_io_wrapper_set_voltage.tcl

## HSD#5235558 -- WTAP signals from parleg to be chagned to vccioparleg_1p05 domain in the near future -- temp sed for spyglass
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_capturewr_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_capturewr_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_selectwir_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_selectwir_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_shiftwr_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_shiftwr_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_updatewr_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_updatewr_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_wrck_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_wrck_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_wrstb_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_wrstb_lv"];g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list \[get_ports "irtcfwtap_wsi_lv"\];set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list [get_ports "irtcfwtap_wsi_lv"];g' lbgns_io_wrapper_set_voltage.tcl

sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_capturewr_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_capturewr_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_selectwir_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_selectwir_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_shiftwr_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_shiftwr_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_updatewr_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_updatewr_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_wrck_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_wrck_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_wrstb_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_wrstb_lv";g' lbgns_io_wrapper_set_voltage.tcl
sed -i 's;set_related_supply_net -power "vnnprim" -ground "vss" -object_list "irtcfwtap_wsi_lv";set_related_supply_net -power "vccioparleg_1p05" -ground "vss" -object_list "irtcfwtap_wsi_lv";g' lbgns_io_wrapper_set_voltage.tcl

###############################################
## Power Domain modifications for SLP/DC/NLP ##
###############################################
sed -i 's;create_power_domain "pd_rtc_3p3_lbgns_io_wrapper_pd";create_power_domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -include_scope;g' lbgns_io_wrapper.upf
sed -i '/create_power_domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -include_scope/a create_power_domain "pd_io_dswwell_wrapper_pd" -elements {io_dswwell_wrapper}' lbgns_io_wrapper.upf
sed -i '/create_power_domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -include_scope/a create_power_domain "pd_io_pwell_wrapper_pd" -elements {io_pwell_wrapper}' lbgns_io_wrapper.upf
sed -i '/create_power_domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -include_scope/a create_power_domain "pd_io_rtcwell_wrapper_pd" -elements {io_rtcwell_wrapper}' lbgns_io_wrapper.upf

sed -i 's;create_supply_net  -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" "vss";create_supply_net "vss" -domain "pd_rtc_3p3_lbgns_io_wrapper_pd";g' lbgns_io_wrapper.upf
sed -i '/create_supply_net "vss" -domain "pd_rtc_3p3_lbgns_io_wrapper_pd"/a create_supply_net "vss" -domain "pd_io_dswwell_wrapper_pd" -reuse' lbgns_io_wrapper.upf
sed -i '/create_supply_net "vss" -domain "pd_rtc_3p3_lbgns_io_wrapper_pd"/a create_supply_net "vss" -domain "pd_io_pwell_wrapper_pd" -reuse' lbgns_io_wrapper.upf
sed -i '/create_supply_net "vss" -domain "pd_rtc_3p3_lbgns_io_wrapper_pd"/a create_supply_net "vss" -domain "pd_io_rtcwell_wrapper_pd" -reuse' lbgns_io_wrapper.upf

sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vss";create_supply_port "vss" -direction "in";g' lbgns_io_wrapper.upf

#cfio_aza
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpazio_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpazio_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpazio_1p8" -reuse/a create_supply_port -direction "in" "vccpazio_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vnnprim";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vnnprim" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vnnprim" -reuse/a create_supply_port -direction "in" "vnnprim"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpazio";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpazio" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpazio" -reuse/a create_supply_port -direction "in" "vccpazio"' lbgns_io_wrapper.upf

#cfio_clk1
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpclkse_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_3p3" -reuse/a create_supply_port -direction "in" "vccpclkse_3p3"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpclkse_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_1p8" -reuse/a create_supply_port -direction "in" "vccpclkse_1p8"' lbgns_io_wrapper.upf

#cfio_clk2
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpclkse_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpclkse_1p05" -reuse/a create_supply_port -direction "in" "vccpclkse_1p05"' lbgns_io_wrapper.upf

#cfio_cpu
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpcpu_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpcpu_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpcpu_1p05" -reuse/a create_supply_port -direction "in" "vccpcpu_1p05"' lbgns_io_wrapper.upf

#cfio_jtag
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpjtag_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpjtag_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpjtag_1p05" -reuse/a create_supply_port -direction "in" "vccpjtag_1p05"' lbgns_io_wrapper.upf

#cfio_spi
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpspi_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpspi_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpspi_1p8" -reuse/a create_supply_port -direction "in" "vccpspi_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpspi";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpspi" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpspi" -reuse/a create_supply_port -direction "in" "vccpspi"' lbgns_io_wrapper.upf

#cfio_dsw
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccdsw_1p8";create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccdsw_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccdsw_1p8" -reuse/a create_supply_port -direction "in" "vccdsw_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccdsw_1p0";create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccdsw_1p0" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccdsw_1p0" -reuse/a create_supply_port -direction "in" "vccdsw_1p0"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpdsw_3p3";create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccpdsw_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_dswwell_wrapper_pd" "vccpdsw_3p3" -reuse/a create_supply_port -direction "in" "vccpdsw_3p3"' lbgns_io_wrapper.upf

#cfio_gppa
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppa_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppa_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppa_1p8" -reuse/a create_supply_port -direction "in" "vccpgppa_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppa_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppa_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppa_3p3" -reuse/a create_supply_port -direction "in" "vccpgppa_3p3"' lbgns_io_wrapper.upf

#cfio_gppb
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppb_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppb_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppb_1p8" -reuse/a create_supply_port -direction "in" "vccpgppb_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppb_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppb_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppb_3p3" -reuse/a create_supply_port -direction "in" "vccpgppb_3p3"' lbgns_io_wrapper.upf

#cfio_gppc
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppc_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppc_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppc_1p8" -reuse/a create_supply_port -direction "in" "vccpgppc_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppc_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppc_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppc_3p3" -reuse/a create_supply_port -direction "in" "vccpgppc_3p3"' lbgns_io_wrapper.upf

#cfio_gppd
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppd_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppd_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppd_1p8" -reuse/a create_supply_port -direction "in" "vccpgppd_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppd_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppd_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppd_3p3" -reuse/a create_supply_port -direction "in" "vccpgppd_3p3"' lbgns_io_wrapper.upf

#cfio_gppe
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppe_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppe_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppe_1p8" -reuse/a create_supply_port -direction "in" "vccpgppe_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppe_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppe_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppe_3p3" -reuse/a create_supply_port -direction "in" "vccpgppe_3p3"' lbgns_io_wrapper.upf

#cfio_gppf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppf_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppf_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppf_1p8" -reuse/a create_supply_port -direction "in" "vccpgppf_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppf_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppf_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppf_3p3" -reuse/a create_supply_port -direction "in" "vccpgppf_3p3"' lbgns_io_wrapper.upf

#cfio_gppg
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppg_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppg_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppg_1p8" -reuse/a create_supply_port -direction "in" "vccpgppg_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppg_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppg_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppg_3p3" -reuse/a create_supply_port -direction "in" "vccpgppg_3p3"' lbgns_io_wrapper.upf

#cfio_gpph
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgpph_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgpph_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgpph_1p8" -reuse/a create_supply_port -direction "in" "vccpgpph_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgpph_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgpph_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgpph_3p3" -reuse/a create_supply_port -direction "in" "vccpgpph_3p3"' lbgns_io_wrapper.upf

#cfio_gppi
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccphvc_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccphvc_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccphvc_1p8" -reuse/a create_supply_port -direction "in" "vccphvc_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccphvc_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccphvc_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccphvc_3p3" -reuse/a create_supply_port -direction "in" "vccphvc_3p3"' lbgns_io_wrapper.upf

#cfio_gppj
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppj_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppj_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppj_1p8" -reuse/a create_supply_port -direction "in" "vccpgppj_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppj_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppj_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppj_3p3" -reuse/a create_supply_port -direction "in" "vccpgppj_3p3"' lbgns_io_wrapper.upf

#cfio_gppk
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppk_1p8";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppk_1p8" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppk_1p8" -reuse/a create_supply_port -direction "in" "vccpgppk_1p8"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppk_3p3";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppk_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppk_3p3" -reuse/a create_supply_port -direction "in" "vccpgppk_3p3"' lbgns_io_wrapper.upf

#cfio_gppl
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccpgppl_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppl_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccpgppl_1p05" -reuse/a create_supply_port -direction "in" "vccpgppl_1p05"' lbgns_io_wrapper.upf

#hip_rtc
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccioparleg_1p05";create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccioparleg_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccioparleg_1p05" -reuse/a create_supply_port -direction "in" "vccioparleg_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccprtcprim_3p3";create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccprtcprim_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccprtcprim_3p3" -reuse/a create_supply_port -direction "in" "vccprtcprim_3p3"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccrtcwell_1p5";create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccrtcwell_1p5" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccrtcwell_1p5" -reuse/a create_supply_port -direction "out" "vccrtcwell_1p5"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccprtc_3p3";create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccprtc_3p3" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_rtcwell_wrapper_pd" "vccprtc_3p3" -reuse/a create_supply_port -direction "in" "vccprtc_3p3"' lbgns_io_wrapper.upf

#hip_thdiodesoc --- HSD5512358 -- 7/16/15:RJS -- vcc for thdiodesoc changes to vnnprim
#sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccio_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccio_1p05" -reuse;g' lbgns_io_wrapper.upf
#sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccio_1p05" -reuse/a create_supply_port -direction "in" "vccio_1p05"' lbgns_io_wrapper.upf

#hip_tsfsocdtsa
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vccths_1p24";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccths_1p24" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vccths_1p24" -reuse/a create_supply_port -direction "in" "vccths_1p24"' lbgns_io_wrapper.upf

#isclk1
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_nssc_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_nssc_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_nssc_1p05" -reuse/a create_supply_port -direction "in" "vcca_nssc_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_src_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_src_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_src_1p05" -reuse/a create_supply_port -direction "in" "vcca_src_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_xtal_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_xtal_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_xtal_1p05" -reuse/a create_supply_port -direction "in" "vcca_xtal_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_cro_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_cro_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_cro_1p05" -reuse/a create_supply_port -direction "in" "vcca_cro_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_pll0_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pll0_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pll0_1p05" -reuse/a create_supply_port -direction "in" "vcca_pll0_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_pll1_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pll1_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pll1_1p05" -reuse/a create_supply_port -direction "in" "vcca_pll1_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_dig_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_dig_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_dig_1p05" -reuse/a create_supply_port -direction "in" "vcca_dig_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_bclk_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_bclk_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_bclk_1p05" -reuse/a create_supply_port -direction "in" "vcca_bclk_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_dp_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_dp_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_dp_1p05" -reuse/a create_supply_port -direction "in" "vcca_dp_1p05"' lbgns_io_wrapper.upf
sed -i 's;create_supply_port -domain "pd_rtc_3p3_lbgns_io_wrapper_pd" -direction "in" "vcca_pci_1p05";create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pci_1p05" -reuse;g' lbgns_io_wrapper.upf
sed -i '/create_supply_net  -domain "pd_io_pwell_wrapper_pd" "vcca_pci_1p05" -reuse/a create_supply_port -direction "in" "vcca_pci_1p05"' lbgns_io_wrapper.upf

#add new primary power nets for pwell, dsw, and rtc power domains
sed -i '/set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" -primary_power_net  "vccprtc_3p3" -primary_ground_net "vss"/a set_domain_supply_net "pd_io_dswwell_wrapper_pd" -primary_power_net  "vccdsw_1p0"  -primary_ground_net "vss"' lbgns_io_wrapper.upf
sed -i '/set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" -primary_power_net  "vccprtc_3p3" -primary_ground_net "vss"/a set_domain_supply_net "pd_io_pwell_wrapper_pd"   -primary_power_net  "vnnprim"     -primary_ground_net "vss"' lbgns_io_wrapper.upf
sed -i '/set_domain_supply_net "pd_rtc_3p3_lbgns_io_wrapper_pd" -primary_power_net  "vccprtc_3p3" -primary_ground_net "vss"/a set_domain_supply_net "pd_io_rtcwell_wrapper_pd" -primary_power_net  "vccprtc_3p3" -primary_ground_net "vss"' lbgns_io_wrapper.upf

#add in wrapper pins that go to package pins -- Collage does not add these to the set_voltage file
cat lbgns_io_wrapper_set_voltage.tcl lbgns_io_wrapper_design_attributes.txt > lbgns_io_wrapper_set_voltage.tcl.temp
cp lbgns_io_wrapper_set_voltage.tcl.temp lbgns_io_wrapper_set_voltage.tcl



## NLP hacks

#2 - isclk UPF needs fixing: change load upf command to point to local version: HSD#5511294: 11/6/14 update: new UPF
cp $MODEL_ROOT/subIP/hip_isclk_ROOT/rtl/upf/c73* .

## cp -fr $MODEL_ROOT/tools/upf/scripts/ww07_hacked_dotlibs/MR2_cfio_upfs/c73p1lbgisclkfamily.upf .
cp -fr $MODEL_ROOT/subIP/hip_isclk_ROOT/rtl/upf/c73p1lbgisclkfamily.upf .
sed -i 's;echo "-isCLK UPF: ISCLK UPF ENV;## echo "-isCLK UPF: ISCLK UPF ENV;g' c73p1lbgisclkfamily.upf 
sed -i 's;load_upf /nfs/pdx/proj/acd/rowood.26/users/cdreyer/LBG/RTL/RTL_PROD_VISA/isclk-lbg-a0/rtl/upf;load_upf $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;g' c73p1lbgisclkfamily.upf 
sed -i 's;1p05 i;1p05 -ports i;g' c73p1lbgisclkfamily.upf

#sed -i 's;;;g' c73p1lbgisclkfamily.upf 

## cp -fr $MODEL_ROOT/tools/upf/scripts/ww07_hacked_dotlibs/MR2_cfio_upfs/c73p1plllccorehptop.upf .
cp -fr $MODEL_ROOT/subIP/hip_isclk_ROOT/rtl/upf/c73p1plllccorehptop.upf . 
##sed -i 's;load_upf upf;load_upf $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;g' c73p1plllccorehptop.upf
sed -i 's;\s*load_upf\s*\S*c73plllchpc73p1plllc_plldigtop.upf;load_upf $env(MODEL_ROOT)/source/gen/upf/hip_io/c73plllchpc73p1plllc_plldigtop.upf;g' c73p1plllccorehptop.upf

## cp -fr $MODEL_ROOT/tools/upf/scripts/ww07_hacked_dotlibs/MR2_cfio_upfs/c73plllchpc73p1plllc_plldigtop.upf .
cp -fr $MODEL_ROOT/subIP/hip_isclk_ROOT/rtl/upf/c73plllchpc73p1plllc_plldigtop.upf .


sed -i 's;\s*load_upf\s*\S*c73p1lbgisclkfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1lbgisclkfamily.upf;g' lbgns_io_wrapper.upf

##5 - changes to power state definitions so that the same voltage references the same value: for vccio_1p05
#     This requires copying the HIP UPF to a local area, make the change to the port state definition, then changing
#     the pointer in the UPF to load the local version of the UPF
#--5a. copy upf from release area to local area
cp -f $MODEL_ROOT/subIP/hip_ldo_ROOT/rtl/upf/c73p1avrlbgldotop.upf .
cp -f $MODEL_ROOT/subIP/hip_thdiodesoc_ROOT/rtl/upf/thdiodesoc.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppdswfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppazafamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppck1family.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppck2family.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppcpufamily.upf .
cp -f $MODEL_ROOT/tools/upf/ip_upf/ebb/c73p1giolbggpiogppjtagfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppspifamily.upf .
cp -f $MODEL_ROOT/tools/upf/ip_upf/ebb/c73p1giolbggpiogppafamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppbfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppcfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppdfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppefamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppffamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppgfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogpphfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppifamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppjfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_cfio_ROOT/tools/upf/c73p1giolbggpiogppkfamily.upf .
cp -f $MODEL_ROOT/tools/upf/ip_upf/ebb/c73p1giolbggpiogpplfamily.upf .
cp -f $MODEL_ROOT/subIP/hip_rtc_ROOT/rtl/upf/c73p4rtctop.upf .

#--5b. change port state value
sed -i 's;add_port_state vccprim_1p05_lv -state {ON 1.05};add_port_state vccprim_1p05_lv -state {ON 0.94};g' c73p1avrlbgldotop.upf
sed -i 's;add_port_state vccbiuvidsi0gt_1p03 -state {ON 1.0};add_port_state vccbiuvidsi0gt_1p03 -state {ON 0.75};g' thdiodesoc.upf
sed -i 's;add_port_state vcccore1p0_lv -state {ACT_Voltage 1.0 };add_port_state vcccore1p0_lv -state {ACT_Voltage 0.75 };g'   c73p1giolbggpiogpp*family.upf
sed -i 's;add_port_state vcc_1p0_lv  -state {ON 0.9} -state {OFF 0.0};add_port_state vcc_1p0_lv  -state {ON 0.75} -state {OFF 0.0};g' c73p1avrlbgldotop.upf
sed -i 's;add_port_state vccdsw_3p3_uhv  -state {ON 3.3};add_port_state vccdsw_3p3_uhv  -state {ON 3.09};g' c73p1avrlbgldotop.upf
sed -i 's;add_port_state vccprim_1p8_ehv -state {ON 1.8};add_port_state vccprim_1p8_ehv -state {ON 1.66};g' c73p1avrlbgldotop.upf


#--5c. change load_upf command to point to new location of modified UPF
sed -i 's;\s*load_upf\s*\S*thdiodesoc.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/thdiodesoc.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1avrlbgldotop.upf; load_upf $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1avrlbgldotop.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppdswfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppdswfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppazafamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppazafamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppck1family.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppck1family.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppck2family.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppck2family.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppcpufamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppcpufamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppjtagfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppjtagfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppspifamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppspifamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppafamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppafamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppbfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppbfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppcfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppcfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppdfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppdfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppefamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppefamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppffamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppffamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppgfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppgfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogpphfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogpphfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppifamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppifamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppjfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppjfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogppkfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogppkfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p1giolbggpiogpplfamily.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1giolbggpiogpplfamily.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*c73p4rtctop.upf; load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p4rtctop.upf;g' lbgns_io_wrapper.upf
sed -i 's;\s*load_upf\s*\S*tsfsocdtsa.upf; load_upf "$env(MODEL_ROOT)/subIP/hip_tsfsocdtsa_ROOT/upf/tsfsocdtsa.upf;g' lbgns_io_wrapper.upf

#--5d. Remove extra pins from gppl io UPF
sed -i 's;cfio_gpp_l_0_pad_lv;;g' c73p1giolbggpiogpplfamily.upf
sed -i 's;cfio_gpp_l_1_pad_lv;;g' c73p1giolbggpiogpplfamily.upf

#--5e. Add ports for IDVs to all gpios  --HSD#


#--6. copy parxgbe locally to make modifications -- change pointer in lbgns.upf to load_upf from merge_results/lbgns_io_wrapper
cp -f $MODEL_ROOT/subIP/IP_BEL_LAN_SUPER_CLUSTER/design/fpk/tools/upf/outputs/* .
cp -f $MODEL_ROOT/subIP/IP_BEL_LAN_SUPER_CLUSTER/design/fpk/tools/upf/outputs/soc_upf.cfg parxgbe_soc_upf.cfg
cp -f $MODEL_ROOT/subIP/IP_BEL_LAN_SUPER_CLUSTER/design/fpk/tools/upf/outputs/lsc_upf.cfg parxgbe_lsc_upf.cfg

cp -f $MODEL_ROOT/subIP/IP_BEL_LAN_SUPER_CLUSTER/design/kerem/rtl/upf/* .
sed -i 's;\s*load_upf\s*\S*lan_super_cluster_apr.upf;load_upf $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/lan_super_cluster_apr.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.upf
sed -i 's;set UPF_INSTALL_DIR $::env(XGBE_UPF_INSTALL_DIR);set UPF_INSTALL_DIR $env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;g' *.upf
sed -i 's;source ${UPF_INSTALL_DIR}/soc_upf.cfg;source ${UPF_INSTALL_DIR}/parxgbe_soc_upf.cfg;g' *.upf
sed -i 's;source ${UPF_INSTALL_DIR}/lsc_upf.cfg;source ${UPF_INSTALL_DIR}/parxgbe_lsc_upf.cfg;g' *.upf
sed -i 's;load_upf "$::env(MR)/design/kerem/rtl/upf/c73p1krmtop.upf";load_upf "$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1krmtop.upf";g' lan_super_cluster_apr.upf
## sed -i 's;$env(MODEL_ROOT)/upf/c73p1krmtop_ilvlshift.upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper/c73p1krmtop_ilvlshift.upf;g' c73p1krmtop.upf
sed -i 's;${RF_UPF_DIR};$env(MODEL_ROOT)/tools/upf/ip_upf/mem_rf;g' *_apr.upf
sed -i 's;${SRAM_UPF_DIR};$env(MODEL_ROOT)/tools/upf/ip_upf/sram;g' *_apr.upf

sed -i 's;$env(KRM_UPF_ROOT)/upf;$env(MODEL_ROOT)/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;g' c73p1krmtop.upf

##102815 -- HSD#5185264: changing kerem UPF voltage values from 1.8, 1.05, 0.80 to 1.66, 0.94, 0.75 for NLP sims
sed -i 's;{vcckrlcpll_lv_ON  1.05};{vcckrlcpll_lv_ON  0.94};g' c73p1krmtop.upf
sed -i 's;{vcckra_lv_ON  1.05};{vcckra_lv_ON  0.94};g' c73p1krmtop.upf
sed -i 's;{vcckr_lv_ON  1.05};{vcckr_lv_ON  0.94};g' c73p1krmtop.upf
sed -i 's;{vcckr1_hv_ON  1.80};{vcckr1_hv_ON  1.66};g' c73p1krmtop.upf
sed -i 's;{vcckr2_hv_ON  1.80};{vcckr2_hv_ON  1.66};g' c73p1krmtop.upf
sed -i 's;{vcc_lv_ON  0.80};{vcc_lv_ON  0.75};g' c73p1krmtop.upf



## dvander 02/26/15:  Added sed line below at the direction of Sudeep from the AC team.
sed -i 's;synopsys_program_name != "vcs";synopsys_program_name != "NOT_USED";g' cmpe_apr.upf common_apr.upf cpuw_apr.upf ctlan_apr.upf lan_super_cluster_apr.upf mng_apr.upf mp4_apr.upf pcie_apr.upf pe_apr.upf rcu_pre_top_apr.upf rcu_prs_top_apr.upf rcu_pst_top_apr.upf rpb_apr.upf tx_core_apr.upf

#--7. mods for SPI GPIO: HSD#5511565
sed -i 's;spi0_mosi_io_0/vcccore1p0_lv;spi0_mosi_io_01/vcccore1p0_lv spi0_mosi_io_02/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/vcccore1p0_lv;spi0_flash_1_csb1/vcccore1p0_lv spi0_flash_1_csb2/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/vcccore1p0_lv;spi0_io_21/vcccore1p0_lv spi0_io_22/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/vcccore1p0_lv;spi0_flash_0_csb1/vcccore1p0_lv spi0_flash_0_csb2/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/vcccore1p0_lv;spi0_io_31/vcccore1p0_lv spi0_io_32/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/vcccore1p0_lv;spi0_tpm_csb1/vcccore1p0_lv spi0_tpm_csb2/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/vcccore1p0_lv;spi0_miso_io_11/vcccore1p0_lv spi0_miso_io_12/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/vcccore1p0_lv;spi0_clk1/vcccore1p0_lv spi0_clk2/vcccore1p0_lv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_mosi_io_0/vcca1p8_ehv;spi0_mosi_io_01/vcca1p8_ehv spi0_mosi_io_02/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/vcca1p8_ehv;spi0_flash_1_csb1/vcca1p8_ehv spi0_flash_1_csb2/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/vcca1p8_ehv;spi0_io_21/vcca1p8_ehv spi0_io_22/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/vcca1p8_ehv;spi0_flash_0_csb1/vcca1p8_ehv spi0_flash_0_csb2/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/vcca1p8_ehv;spi0_io_31/vcca1p8_ehv spi0_io_32/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/vcca1p8_ehv;spi0_tpm_csb1/vcca1p8_ehv spi0_tpm_csb2/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/vcca1p8_ehv;spi0_miso_io_11/vcca1p8_ehv spi0_miso_io_12/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/vcca1p8_ehv;spi0_clk1/vcca1p8_ehv spi0_clk2/vcca1p8_ehv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_mosi_io_0/vcca3p3_uhv;spi0_mosi_io_01/vcca3p3_uhv spi0_mosi_io_02/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_mosi_io_0/abutcfiocfgpu_b_uhv;spi0_mosi_io_01/abutcfiocfgpu_b_uhv spi0_mosi_io_02/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/vcca3p3_uhv;spi0_flash_1_csb1/vcca3p3_uhv spi0_flash_1_csb2/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/abutcfiocfgpu_b_uhv;spi0_flash_1_csb1/abutcfiocfgpu_b_uhv spi0_flash_1_csb2/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/vcca3p3_uhv;spi0_io_21/vcca3p3_uhv spi0_io_22/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/abutcfiocfgpu_b_uhv;spi0_io_21/abutcfiocfgpu_b_uhv spi0_io_22/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/vcca3p3_uhv;spi0_flash_0_csb1/vcca3p3_uhv spi0_flash_0_csb2/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/abutcfiocfgpu_b_uhv;spi0_flash_0_csb1/abutcfiocfgpu_b_uhv spi0_flash_0_csb2/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/vcca3p3_uhv;spi0_io_31/vcca3p3_uhv spi0_io_32/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/abutcfiocfgpu_b_uhv;spi0_io_31/abutcfiocfgpu_b_uhv spi0_io_32/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/vcca3p3_uhv;spi0_tpm_csb1/vcca3p3_uhv spi0_tpm_csb2/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/abutcfiocfgpu_b_uhv;spi0_tpm_csb1/abutcfiocfgpu_b_uhv spi0_tpm_csb2/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/vcca3p3_uhv;spi0_miso_io_11/vcca3p3_uhv spi0_miso_io_12/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/abutcfiocfgpu_b_uhv;spi0_miso_io_11/abutcfiocfgpu_b_uhv spi0_miso_io_12/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/vcca3p3_uhv;spi0_clk1/vcca3p3_uhv spi0_clk2/vcca3p3_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/abutcfiocfgpu_b_uhv;spi0_clk1/abutcfiocfgpu_b_uhv spi0_clk2/abutcfiocfgpu_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_mosi_io_0/abutcfiocfgpwrup_uhv;spi0_mosi_io_01/abutcfiocfgpwrup_uhv spi0_mosi_io_02/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_mosi_io_0/abutcfiocfgpd_b_uhv;spi0_mosi_io_01/abutcfiocfgpd_b_uhv spi0_mosi_io_02/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/abutcfiocfgpwrup_uhv;spi0_flash_1_csb1/abutcfiocfgpwrup_uhv spi0_flash_1_csb2/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_1_csb/abutcfiocfgpd_b_uhv;spi0_flash_1_csb1/abutcfiocfgpd_b_uhv spi0_flash_1_csb2/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/abutcfiocfgpwrup_uhv;spi0_io_21/abutcfiocfgpwrup_uhv spi0_io_22/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_2/abutcfiocfgpd_b_uhv;spi0_io_21/abutcfiocfgpd_b_uhv spi0_io_22/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/abutcfiocfgpwrup_uhv;spi0_flash_0_csb1/abutcfiocfgpwrup_uhv spi0_flash_0_csb2/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_flash_0_csb/abutcfiocfgpd_b_uhv;spi0_flash_0_csb1/abutcfiocfgpd_b_uhv spi0_flash_0_csb2/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/abutcfiocfgpwrup_uhv;spi0_io_31/abutcfiocfgpwrup_uhv spi0_io_32/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_io_3/abutcfiocfgpd_b_uhv;spi0_io_31/abutcfiocfgpd_b_uhv spi0_io_32/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/abutcfiocfgpwrup_uhv;spi0_tpm_csb1/abutcfiocfgpwrup_uhv spi0_tpm_csb2/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_tpm_csb/abutcfiocfgpd_b_uhv;spi0_tpm_csb1/abutcfiocfgpd_b_uhv spi0_tpm_csb2/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/abutcfiocfgpwrup_uhv;spi0_miso_io_11/abutcfiocfgpwrup_uhv spi0_miso_io_12/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_miso_io_1/abutcfiocfgpd_b_uhv;spi0_miso_io_11/abutcfiocfgpd_b_uhv spi0_miso_io_12/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/abutcfiocfgpwrup_uhv;spi0_clk1/abutcfiocfgpwrup_uhv spi0_clk2/abutcfiocfgpwrup_uhv;g' c73p1giolbggpiogppspifamily.upf
sed -i 's;spi0_clk/abutcfiocfgpd_b_uhv;spi0_clk1/abutcfiocfgpd_b_uhv spi0_clk2/abutcfiocfgpd_b_uhv;g' c73p1giolbggpiogppspifamily.upf

##RJS: 011915: HSD#5511972 -- comment out level_shifter and dco_clk tree assignments from isclk upf
sed -i '/level_shifters/s/create_supply_port/#create_supply_port/g' c73p1lbgisclkfamily.upf
sed -i '/level_shifters/s/connect_supply_net/#connect_supply_net/g' c73p1lbgisclkfamily.upf
sed -i '/dco_clk_inv/s/create_supply_port/#create_supply_port/g' c73p1lbgisclkfamily.upf
sed -i '/dco_clk_inv/s/connect_supply_net/#connect_supply_net/g' c73p1lbgisclkfamily.upf

##RJS: 012115: uncomment create_supply_port lines in isclk UPF for NLP work
#sed -i 's;#create_supply_port                      comp/rcomp_ana/vcca_1p0;create_supply_port comp/rcomp_ana/vcca_1p0;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_dp_1p05;create_supply_port i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_dp_1p05;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_nssc_1p05;create_supply_port i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_nssc_1p05;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_pci_1p05;create_supply_port i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_pci_1p05;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_src_1p05;create_supply_port i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_src_1p05;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccaon;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccaon;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccvref;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccvref;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccaon;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccaon;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccvref;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/isclkcroa/vccvref;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/LPC_DELAY_LINE\[$i\]/isclkcroa/vccaon;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/LPC_DELAY_LINE[$i]/isclkcroa/vccaon;g' c73p1lbgisclkfamily.upf 
#sed -i 's;#create_supply_port                      i_c73p1isclk_xtal_ro_top/xtal_ro/LPC_DELAY_LINE\[$i\]/isclkcroa/vccvref;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/LPC_DELAY_LINE[$i]/isclkcroa/vccvref;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_xtal_ro_top/xtal_ro/xtal_analog/vcc_nom;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/xtal_analog/vcc_nom;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_xtal_ro_top/xtal_ro/xtal_analog/vcc_lv;create_supply_port i_c73p1isclk_xtal_ro_top/xtal_ro/xtal_analog/vcc_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[0\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[0]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[1\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[1]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[2\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[2]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[3\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[3]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[4\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[4]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV\[5\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/bcktp/clkan/POSTDIV[5]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[0\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[0]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[1\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[1]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[2\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[2]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[3\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[3]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[4\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[4]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV\[5\]/pddiv/vcca_1p05_lv;create_supply_port i_c73p1isclk_clksrctop/dcktp/clkan/POSTDIV[5]/pddiv/vcca_1p05_lv;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_bclk_1p05;create_supply_port i_c73p1isclk_bufftop/DBUFANAGRP_TOP/dbuffgroup1/vcca_bclk_1p05;g' c73p1lbgisclkfamily.upf
#sed -i 's;#create_supply_port                       i_c73p1isclk_dbuffcell_12_top/DBUFF_ANA_SPTH/dbuffgroup2/vcca_src_1p05;create_supply_port i_c73p1isclk_dbuffcell_12_top/DBUFF_ANA_SPTH/dbuffgroup2/vcca_src_1p05;g' c73p1lbgisclkfamily.upf

##RJS: 020415:HSD #5512052 --- vccrtcwell_1p5 is connected to hip_avrldo/vccrtc_1p8_ehv -- the port state definies this voltage as 1.5, LBG defines this as 1.3 
# making a local mod to match port state voltages for NNLP to 1.3 volts
sed -i 's;add_port_state vccrtc_1p8_ehv -state {ON 1.5} -state {OFF 0.0};add_port_state vccrtc_1p8_ehv -state {ON 1.30} -state {OFF 0.0};g' c73p1avrlbgldotop.upf

##RJS: 021715:HSD #5512084 -- vccrtcwell_1p5 output from rtc is at a LBG level of 1.30 -- changing hip_rtc upf PST to use this level
sed -i 's;{c73p4rtctop_CrtCwellSusVoltage_1P785000 1.785000};{c73p4rtctop_CrtCwellSusVoltage_1P3000 1.3000};g' c73p4rtctop.upf
sed -i 's;c73p4rtctop_CrtCwellSusVoltage_1P785000;c73p4rtctop_CrtCwellSusVoltage_1P3000;g'  c73p4rtctop.upf

##RJS: 021915 - Changin ISCLK UPF PST voltages from 0.75 to 0.94 (LBG)
sed -i 's;add_port_state 	vcca_nssc_1p05  	-state {isclkon	0.75} -state {isclkoff off};add_port_state 	vcca_nssc_1p05  	-state {isclkon	0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_bclk_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_bclk_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_dp_1p05    	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_dp_1p05    	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_pci_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_pci_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_src_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_src_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_dig_1p05    	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_dig_1p05    	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_pll0_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_pll0_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_pll1_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_pll1_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_cro_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_cro_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf
sed -i 's;add_port_state 	vcca_xtal_1p05   	-state {isclkon 0.75} -state {isclkoff off};add_port_state 	vcca_xtal_1p05   	-state {isclkon 0.94} -state {isclkoff off};g' c73p1lbgisclkfamily.upf


##RJS: 022215 - avrlbgldo.upf does not drive dsw1p0, dsw1p8 and 1p24 LDO ouputs  correctly and voltage levels are not LBG friendly -- Fixing this
##RJS: 010616 - new avrlbgldo.upf corrects the LDO drivers, removing the drivers added below + power switch removal
sed -i 's;add_port_state  vccdsw_1p0_lv -state {ON 1.0} -state {OFF 0.0};add_port_state  vccdsw_1p0_lv -state {ON 0.94} -state {OFF 0.0};g' c73p1avrlbgldotop.upf
sed -i 's;add_port_state  vccdsw_1p8_ehv -state {ON 1.8} -state {OFF 0.0};add_port_state  vccdsw_1p8_ehv -state {ON 1.66} -state {OFF 0.0};g' c73p1avrlbgldotop.upf
sed -i 's;add_port_state  vcchpldo_1p24_hv -state {ON 1.3} -state {OFF 0.0};add_port_state  vcchpldo_1p24_hv -state {ON 1.24} -state {OFF 0.0};g' c73p1avrlbgldotop.upf

#sed -i '/add_port_state  vcchpldo_1p24_hv -state {ON 1.24} -state {OFF 0.0}/a connect_supply_net vcchpldo_1p24_hv -ports hpldo/vcchpldo_1p24_hv' c73p1avrlbgldotop.upf
#sed -i '/add_port_state  vcchpldo_1p24_hv -state {ON 1.24} -state {OFF 0.0}/a connect_supply_net vccdsw_1p8_ehv -ports dswldo/vccdsw_1p8_ehv' c73p1avrlbgldotop.upf
#sed -i '/add_port_state  vcchpldo_1p24_hv -state {ON 1.24} -state {OFF 0.0}/a connect_supply_net vccdsw_1p0_lv  -ports dswldo/vccdsw_1p0_lv' c73p1avrlbgldotop.upf

#sed -i 's;create_power_switch ldo_sw1;#create_power_switch ldo_sw1;g' c73p1avrlbgldotop.upf
#sed -i 's;add_port_state ldo_sw1/out;#add_port_state ldo_sw1/out;g' c73p1avrlbgldotop.upf
#sed -i 's;create_power_switch ldo_sw2;#create_power_switch ldo_sw2;g' c73p1avrlbgldotop.upf
#sed -i 's;add_port_state ldo_sw2/out;#add_port_state ldo_sw2/out;g' c73p1avrlbgldotop.upf
#sed -i 's;create_power_switch ldo_sw3;#create_power_switch ldo_sw3;g' c73p1avrlbgldotop.upf
#sed -i 's;add_port_state ldo_sw3/out;#add_port_state ldo_sw3/out;g' c73p1avrlbgldotop.upf

##RJS: 030215 -- lbg_isclk_a0_prod11 version of UPF does not have ALL of the above changes -- will point to a local copy that does
cp -fr $MODEL_ROOT/tools/upf/scripts/ww07_hacked_dotlibs/c73p1lbgisclkfamily.upf .

# For Spyglass and DC
cp -f lbgns_io_wrapper.upf lbgns_io_wrapper.impl.upf

## for lbg_upf_spy.pl: requires empty *.inc.impl.tcl file to generate fr file (will do for both lbgns, lbgns_io_wrapper)
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/paricc/paricc.inc.impl.tcl lbgns.inc.impl.tcl
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/paricc/paricc.inc.impl.tcl lbgns_io_wrapper.inc.impl.tcl
cp -f lbgns.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/.
cp -f lbgns_io_wrapper.inc.impl.tcl $MODEL_ROOT/source/gen/upf/fc_par/.

##RJS: 010516: New wm20 release changed voltage supply for i_com0_ck_pll1corerefclk from vccaon_1p05 to vccclpllebb_1p05,
## causing the set_voltage for this pin on the lbgns_io_wrapper boundary to change to an unsupported voltage
sed -i 's;vccaupcie2pllebb_1p05;vcca_dig_1p05;g' lbgns_io_wrapper_set_voltage.tcl

## Copy over upf to the NLP compilation area -- namechange to .sim.upf
# Changes  only for VCS/NLP work
#1. comment out VSS lines in upf for tsfsocdtsa, tsremotediodea, hip_rtc_dwprok because RTL models do not have them in the ifdef NO_PWR_PINS section

#sed -i 's;connect_supply_net "vss" -ports "io_pwell_wrapper/hip_tsfsocdtsa/vss";##comment out for NLP## connect_supply_net "vss" -ports "io_pwell_wrapper/hip_tsfsocdtsa/vss";g' lbgns_io_wrapper.upf
sed -i 's;connect_supply_net "vss" -ports "io_pwell_wrapper/hip_tsremotediodea/vss";##comment out for NLP## connect_supply_net "vss" -ports "io_pwell_wrapper/hip_tsremotediodea/vss";g' lbgns_io_wrapper.upf
sed -i 's;connect_supply_net "vss" -ports "io_rtcwell_wrapper/hip_rtc_dpwrok/vss";##comment out for NLP## connect_supply_net "vss" -ports "io_rtcwell_wrapper/hip_rtc_dpwrok/vss";g' lbgns_io_wrapper.upf

cp -f lbgns_io_wrapper.impl.upf $MODEL_ROOT/source/gen/upf/fc_par/.
cp -f lbgns_io_wrapper.upf $MODEL_ROOT/source/gen/upf/fc_par/lbgns_io_wrapper.sim.upf
cp -f lbgns_io_wrapper_set_voltage.tcl $MODEL_ROOT/source/gen/upf/fc_par/.

cp -f parxgbe* $MODEL_ROOT/source/gen/upf/fc_par/.
cp -f lan_super* $MODEL_ROOT/source/gen/upf/fc_par/.

##RJS: 061215: changing load_upf paths from the results area to $MODE_ROOT/source/gen/upf/hip_io -- NLP only
sed -i 's;/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns_io_wrapper.sim.upf
sed -i 's;/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.upf
sed -i 's;\S*c73p1wmhybridx26familyew.upf;"$env(MODEL_ROOT)/source/gen/upf/hip_io/c73p1wmhybridx26familyew.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/parfia.*.upf
sed -i 's;\S*c73p1wmgen3x20familyew.upf;"$env(MODEL_ROOT)/source/gen/upf/hip_io/c73p1wmgen3x20familyew.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/parfia20.*.upf
sed -i 's;\S*c73p1usbtop14pfamilyew.upf;"$env(MODEL_ROOT)/source/gen/upf/hip_io/c73p1usbtop14pfamilyew.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/parxhcib.sim.upf

##### Copy all io upfs in the merge_results/<partitions> to the $MODEL_ROOT/source/gen/upf/hip_io directory --- used for NLP only
cp -f * $MODEL_ROOT/source/gen/upf/hip_io/.
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/parfia/*.upf $MODEL_ROOT/source/gen/upf/hip_io/.
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/parfia20/*.upf $MODEL_ROOT/source/gen/upf/hip_io/.
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/parfuse/*.upf $MODEL_ROOT/source/gen/upf/hip_io/.
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/parxhcib/*.upf $MODEL_ROOT/source/gen/upf/hip_io/.
cp -f $MODEL_ROOT/results/collage/upf/outputs/merge_results/parxhcib/*.cfg $MODEL_ROOT/source/gen/upf/hip_io/.

##### Modify HIP UPFS in the new hip_io directory to point to the new directory
sed -i 's;/results/collage/upf/outputs/merge_results/lbgns_io_wrapper;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/hip_io/*.upf
sed -i 's;/results/collage/upf/outputs/merge_results/parfia;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/hip_io/*.upf
sed -i 's;/results/collage/upf/outputs/merge_results/parfia20;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/hip_io/*.upf
sed -i 's;/results/collage/upf/outputs/merge_results/parfuse;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/hip_io/*.upf
sed -i 's;/results/collage/upf/outputs/merge_results/parxhcib;/source/gen/upf/hip_io;g' $MODEL_ROOT/source/gen/upf/hip_io/*.upf

##------------------------------------------------------------------##
## LBGNS FULL CHIP SPYGLASS upf file creation
##------------------------------------------------------------------##
## Creating a lbgns.upf file with all the mods required to run a 
## fullchip SPYGLASS run: rjs: 102815

cp -f $MODEL_ROOT/source/gen/upf/fc_par/lbgns.upf $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/pargbe.sim.upf;load_upf ${UPF_INSTALL_DIR}/pargbe.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parieacfmia.sim.upf;load_upf ${UPF_INSTALL_DIR}/parieacfmia.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/pardsp.sim.upf;load_upf ${UPF_INSTALL_DIR}/pardsp.slp.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parleg.sim.upf;load_upf ${UPF_INSTALL_DIR}/parleg.spyglass.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpxpa.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpxpa.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parcsmeacfmia.sim.upf;load_upf ${UPF_INSTALL_DIR}/parcsmeacfmia.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpxpb.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpxpb.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf1.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf1.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/lbgns_io_wrapper.sim.upf;load_upf ${UPF_INSTALL_DIR}/lbgns_io_wrapper.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/pardfx.sim.upf;load_upf ${UPF_INSTALL_DIR}/pardfx.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/pardmi.sim.upf;load_upf ${UPF_INSTALL_DIR}/pardmi.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpxpc.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpxpc.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf2.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf2.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
##sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpcix16.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpcix16.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parfuse.sim.upf;load_upf ${UPF_INSTALL_DIR}/parfuse.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parssata.sim.upf;load_upf ${UPF_INSTALL_DIR}/parssata.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpxpd.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpxpd.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf3.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf3.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
##sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpcix8.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpcix8.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parxhcia.sim.upf;load_upf ${UPF_INSTALL_DIR}/parxhcia.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpxpe.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpxpe.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parxhcib.sim.upf;load_upf ${UPF_INSTALL_DIR}/parxhcib.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/paricc.sim.upf;load_upf ${UPF_INSTALL_DIR}/paricc.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parieb.sim.upf;load_upf ${UPF_INSTALL_DIR}/parieb.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parfia.sim.upf;load_upf ${UPF_INSTALL_DIR}/parfia.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parsata.sim.upf;load_upf ${UPF_INSTALL_DIR}/parsata.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parrtc.sim.upf;load_upf ${UPF_INSTALL_DIR}/parrtc.spyglass.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
##sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf8.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf8.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
##sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf9.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf9.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
##sed -i 's;load_upf ${UPF_INSTALL_DIR}/parpsf10.sim.upf;load_upf ${UPF_INSTALL_DIR}/parpsf10.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parieacse.sim.upf;load_upf ${UPF_INSTALL_DIR}/parieacse.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parcsmeb.sim.upf;load_upf ${UPF_INSTALL_DIR}/parcsmeb.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parfia20.sim.upf;load_upf ${UPF_INSTALL_DIR}/parfia20.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/par_ac_cpm_cluster.sim.upf;load_upf ${UPF_INSTALL_DIR}/par_ac_cpm_cluster.slp.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf
sed -i 's;load_upf ${UPF_INSTALL_DIR}/parcsmeacse.sim.upf;load_upf ${UPF_INSTALL_DIR}/parcsmeacse.impl.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf

## Create spyglass version for par_ac_cpm_cluster.sim.upf that comments out the load_upf commands for the
#  i_cpm*_wrap due to memory constraints --- these three load commands cause the SPYGLASS run to
#  run out of memory.

cp -f $MODEL_ROOT/source/gen/upf/fc_par/par_ac_cpm_cluster.sim.upf $MODEL_ROOT/source/gen/upf/fc_par/par_ac_cpm_cluster.slp.upf
sed -i 's;load_upf "$UPF_INSTALL_DIR/i_cpm0_wrap.upf";#load_upf "$UPF_INSTALL_DIR/i_cpm0_wrap.upf";g' $MODEL_ROOT/source/gen/upf/fc_par/par_ac_cpm_cluster.slp.upf  
sed -i 's;load_upf "$UPF_INSTALL_DIR/i_cpm1_wrap.upf";#load_upf "$UPF_INSTALL_DIR/i_cpm1_wrap.upf";g' $MODEL_ROOT/source/gen/upf/fc_par/par_ac_cpm_cluster.slp.upf  
sed -i 's;load_upf "$UPF_INSTALL_DIR/i_cpm2_wrap.upf";#load_upf "$UPF_INSTALL_DIR/i_cpm2_wrap.upf";g' $MODEL_ROOT/source/gen/upf/fc_par/par_ac_cpm_cluster.slp.upf  


## Change setenv command to set commands - setenv not recognized by SPYGLASS
sed -i 's;setenv XGBE;set XGBE;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf

## Don not load LBGLDO UPF for full chip SPyglass runs (use .lib)
sed -i 's;load_upf $env(MODEL_ROOT)/source/gen/upf/hip_io/c73p1avrlbgldotop.upf;#load_upf $env(MODEL_ROOT)/source/gen/upf/hip_io/c73p1avrlbgldotop.upf;g' $MODEL_ROOT/source/gen/upf/fc_par/lbgns.slp.upf 
#########################################################################################################################################################################

cd $MODEL_ROOT/source/gen/upf/fc_par
sed -i 's;subIP/mem_rf_ROOT/rtl/upf;tools/upf/ip_upf/mem_rf;g' *.upf
sed -i 's;subIP/hip_rf_ROOT/rtl/upf;tools/upf/ip_upf/mem_rf;g' *.upf
sed -i 's;subIP/mem_rf_ROOT/rtl/upf;tools/upf/ip_upf/mem_rf;g' *.tcl
sed -i '/mIA486/d' *.sim.upf 

sed -i 's;\"\/\S*subIP;"$env(MODEL_ROOT)/subIP;g' *.sim.upf
sed -i 's;\"\/\S*results\/collage;"$env(MODEL_ROOT)/results/collage;g' *.sim.upf
sed -i 's;\"\/\S*tools;"$env(MODEL_ROOT)/tools;g' *.sim.upf
sed -i 's;\"\/\S*source;"$env(MODEL_ROOT)/source;g' *.sim.upf


cd $MODEL_ROOT
echo  "\n UPF Merge Done \n" |& tee -a ${LOG_FILE_LOCATION}


cd $MODEL_ROOT


### 151125 Uzair: Added the PERL script to automatically diff generated UPF files with latest release UPF files
perl $MODEL_ROOT/tools/upf/scripts/upf_diff.pl 

echo  "\n UPF diff completed. Please review the log and report files \n" |& tee -a ${LOG_FILE_LOCATION}


###   ##------------------------------------------------------------------##
###   ## PARGBE
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARGBE ...." |& tee -a ${LOG_FILE_LOCATION}
###   cd $COLLAGE_WORK/upf/outputs
###   
###   if (-d gbe_upf) then
###       rm -rf gbe_upf
###   endif
###   mkdir gbe_upf
###   cd gbe_upf
###   
###   cp -f -R $MODEL_ROOT/subIP/sip/gbe/tools/upf/* .
###   chmod -R 755 ${COLLAGE_WORK}/upf/outputs/gbe_upf
###   
###   sed -i 's;set GbE_UPF_ROOT_DIR $::env(GBE_ROOT)/tools/upf/;set GbE_UPF_ROOT_DIR $::env{COLLAGE_WORK}/upf/outputs/gbe_upf;g' GbE.upf
###   cp -f $MODEL_ROOT/tools/upf/soc_upf.cfg .
###   cp -f $MODEL_ROOT/tools/upf/soc_upf.cfg SPT_SYN_soc_upf.cfg
###   cp -f $COLLAGE_WORK/upf/outputs/pargbe* .
###   cp -f $COLLAGE_WORK/upf/outputs/upf_global_defs.tcl .
###   
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/gbe/tools/upf/GbE.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/gbe_upf/GbE.upf;g' pargbe.upf
###   ## --- trailing whitespace causing issues - remove them
###   sed -i 's/[ \t]*$//' iso_list/GbE_clamp_iso.list
###   sed -i 's/[ \t]*$//' GbE_pg_wrappers.list
###   sed -i 's/[ \t]*$//' sr_list/GbE_sr.list 
###   ##sed -i 's/top.u_gbeunit_wrapper.//g' sr_list/GbE_sr.list
###   sed -i 's;\.;/;g' sr_list/GbE_sr.list
###   
###   # -- Edit hierarchy paths provided bu GBE path as they do not exist in FC
###   sed -i 's#genblk3/#genblk3.#g' RF_list/RF_path.list
###   sed -i 's#mode_sync/#genblk3.#g' RF_list/RF_path.list
###   sed -i 's#genblk2/#genblk2.#g' SRAM_list/SRAM_path.list
###   
###   setenv UPF_INSTALL_DIR $COLLAGE_WORK/upf/outputs/gbe_upf
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pargbe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pargbe.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## Add LYA SRSN
###   ## sed -i '/Tag to insert LYA SRSN/r '"${MODEL_ROOT}"'/tools/upf/scripts/pargbe_lya_srsn.txt' pargbe.merged.upf
###   
###   cp -f pargbe.merged.upf $COLLAGE_WORK/upf/outputs/pargbe.merged.upf
###   
###   unsetenv UPF_INSTALL_DIR
###   cd ${COLLAGE_WORK}/upf/outputs
###   rm -rf $COLLAGE_WORK/upf/outputs/gbe_upf
###   
###   setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARCSMEA
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARCSMEA ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   if (-d csmea_upf) then
###     rm -rf csmea_upf
###   endif
###   
###   ## -- Copy over contents of CSME UPF for modification
###   mkdir csmea_upf
###   cd csmea_upf
###   cp -f -R ${MODEL_ROOT}/subIP/sip/csme/tools/csme/upf/dnv/csmea.upf .
###   cp -f -R ${MODEL_ROOT}/subIP/sip/csme/tools/csme/upf/dnv/csmea.inc.tcl .
###   cp -f ${COLLAGE_WORK}/upf/outputs/parcsmea.upf .
###   cp -f ${COLLAGE_WORK}/upf/outputs/upf_global_defs.tcl .
###   cp -f ${COLLAGE_WORK}/upf/outputs/parcsmea_set_voltage.tcl .
###   ## Below line might need to be removed - collage bug
###   cp -f ${COLLAGE_WORK}/upf/outputs/parcsmea_csmea1_input_ls_pins.tcl .
###   
###   chmod 755 *.tcl
###   chmod 755 *.upf
###   
###   sed -i 's/vccpwell_lv/vnnprim/g' csmea.upf
###   sed -i 's;source \$::env(IP_ROOT)/tools/csme/upf/csmea.inc.tcl;source '"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmea_upf/csmea.inc.tcl;g' csmea.upf
###   sed -i 's;source \$::env(IP_ROOT)/tools/csme/upf/soc_clt_upf.cfg;source '"${MODEL_ROOT}"'/tools/upf/soc_upf.cfg;g' csmea.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/csme/tools/csme/upf/dnv/csmea.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmea_upf/csmea.upf;g' parcsmea.upf
###   
###   setenv IP_ROOT ${COLLAGE_WORK}/upf/outputs/csmea_upf
###   setenv UPF_INSTALL_DIR  ${COLLAGE_WORK}/upf/outputs/csmea_upf
###   setenv CSME_MIA_RTL_SIM 1
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmea.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmea.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Remap voltage values generated by merge script. 
###   ## -- This is caused due to a limitation in the merge script
###   sed -i 's;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" N/A;"pd_pwell_parcsmea_pd_GATED_0_vnnprim_gated" -min 0.75 0.75;g' parcsmea.merged.upf
###   sed -i 's;"vnnprim" N/A;"vnnprim" -min 0.75 0.75;g' parcsmea.merged.upf
###   sed -i 's;"vss" N/A;"vss" 0.0;g' parcsmea.merged.upf
###   sed -i 's;vccd_1p0;vccsram_1p05;g' parcsmea.merged.upf
###   sed -i 's;"vccsram_1p05" N/A;"vccsram_1p0" -min 0.89 0.89;g' parcsmea.merged.upf
###   sed -i 's;"vccio_1p05" N/A;"vccio_1p05" -min 0.85 0.85;g' parcsmea.merged.upf
###   
###   ## -- MIA RF code needs to be inside a if ... then conditional as MIA RF code is enabled only on SD delivery models
###   ## -- MIA RF code is generally not used as part of validation where it is stubbed out.
###   ## -- Below code is to insert MIA RF code in a conditional line.
###   ## -- Code below is not elegant but gets the job done. I am sure there is a way to do it inside sed but need to research
###   echo '\nif { [ info exists ::env(CSME_MIA_RTL_SIM) ] } {' > parcsmea.miarf.inc.tcl |& tee -a ${LOG_FILE_LOCATION}
###   grep "cfmia/mIA486" parcsmea.merged.upf >> parcsmea.miarf.inc.tcl
###   echo "}\n" >> parcsmea.miarf.inc.tcl |& tee -a ${LOG_FILE_LOCATION}
###   
###   sed -i '/cfmia\/mIA486/d' parcsmea.merged.upf
###   sed -i '/Overridden PST from merge_upf/i ## Conditional for MIA RF\n\source $::env(UPF_INSTALL_DIR)/parcsmea.miarf.inc.tcl\n' parcsmea.merged.upf
###   
###   
###   ## -- Adding conditional selection as this is needed for MIA Based flow from 0.8
###   ## sed -i 's/parcsmea_pwell_wrapper\/csmea1\/csme_cse\/cfmia_aary_pwren_b_rf/\${CSMEA_PFET_EN_PORT_NAME}/g' parcsmea.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parcsmea.selection.txt' parcsmea.merged.upf > parcsmea.merged.upf.tmp
###   mv parcsmea.merged.upf.tmp parcsmea.merged.upf
###   
###   ## -- Adding below isolation to the file based on inputs from Sudhi for 0.7R.
###   ## -- REVIEW and REMOVE
###   sed -i '/set_isolation "parcsmea_pwell_wrapper_csmea1_csme_sram_wrapper_pd_csme_sram_PGD_to_pd_csme_sram_AON"/{N;N;N;N;N; s#elements {#elements {\n    parcsmea_pwell_wrapper/csmea1/csme_sram_wrapper/csme_sram_bist_wrapper1/aary_LV_WSO_sram\n    parcsmea_pwell_wrapper/csmea1/csme_csmea_rom/aary_LV_WSO_rom#}' parcsmea.merged.upf
###   
###   ## Removing vccdsw_1p0 association of host_powergood_resetb as the splitting of the signal still needs cleanup
###   ## -- REVIEW and REMOVE
###   sed -i '/host_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/}' parcsmea.merged.upf
###   
###   ## Add SRAM LYA SRSN signals
###   sed -i '/Tag to insert LYA SRSN/r '"${MODEL_ROOT}"'/tools/upf/scripts/parcsmea_lya_srsn.txt' parcsmea.merged.upf
###   
###   cp -f parcsmea.merged.upf ${COLLAGE_WORK}/upf/outputs/.
###   cp -f parcsmea.miarf.inc.tcl ${COLLAGE_WORK}/upf/outputs/.
###   
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   unsetenv UPF_INSTALL_DIR
###   unsetenv IP_ROOT
###   unsetenv CSME_MIA_RTL_SIM
###   rm -rf csmea_upf
###   
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARCSMEB
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARCSMEB ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   if (-d csmeb_upf) then
###     rm -rf csmeb_upf
###   endif
###   
###   ## -- Copy over contents of parcsmeb
###   mkdir csmeb_upf
###   cd csmeb_upf
###   cp -f -R ${MODEL_ROOT}/subIP/sip/csme/tools/csme/upf/dnv/csmeb.upf .
###   cp -f -R ${MODEL_ROOT}/subIP/sip/csme/tools/csme/upf/dnv/csmeb.vcs.inc.tcl .
###   cp -f -R ${MODEL_ROOT}/subIP/sip/csme/tools/csme/upf/dnv/csmeb.spy.inc.tcl .
###   cp -f ${COLLAGE_WORK}/upf/outputs/parcsmeb.upf .
###   cp -f ${COLLAGE_WORK}/upf/outputs/upf_global_defs.tcl .
###   cp -f ${COLLAGE_WORK}/upf/outputs/parcsmeb_set_voltage.tcl .
###   
###   chmod 755 *.tcl
###   chmod 755 *.upf
###   
###   echo  "\n --->---> Sub Processing PARCSMEB (SBR) ...." |& tee -a ${LOG_FILE_LOCATION}
###   ## -- Copy SBR UPF
###   ##cp -fR ${MODEL_ROOT}/subIP/sip/sbr/tools/upf/router/* .
###   ##sed -i 's;../../../../tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/csmeb_upf;g' sbr_config_ipxact_chs_sbr1_top.upf
###   ##sed -i 's;../../../../tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/csmeb_upf;g' sbr_config_ipxact_chs_sbr3_top.upf
###   ##sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr1_top.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/sbr_config_ipxact_chs_sbr1_top.upf;g' parcsmeb.upf
###   ##sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr3_top.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/sbr_config_ipxact_chs_sbr3_top.upf;g' parcsmeb.upf
###   ##sed -i 's/IP_ROOT/MODEL_ROOT/g' sbr_config_ipxact_chs_sbr1_top.upf
###   ##sed -i 's/IP_ROOT/MODEL_ROOT/g' sbr_config_ipxact_chs_sbr3_top.upf
###   ## -- Processing SBR router IP UPF for paths that do not scale to FC
###   cp -fR $MODEL_ROOT/subIP/sip/sbr/tools/upf/router/* .
###   sed -i 's;$::env(IP_ROOT)/tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/csmeb_upf;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;soc_upf.cfg;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;IP_ROOT;MODEL_ROOT;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr1_top.upf;/tools/collage/work/upf/outputs/csmeb_upf/sbr_config_ipxact_chs_sbr1_top.upf;g' parcsmeb.upf
###   sed -i 's;$::env(IP_ROOT)/tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/csmeb_upf;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;soc_upf.cfg;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;IP_ROOT;MODEL_ROOT;g' sbr_config_ipxact_chs_sbr1_top.upf
###   sed -i 's;/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr1_top.upf;/tools/collage/work/upf/outputs/csmeb_upf/sbr_config_ipxact_chs_sbr1_top.upf;g' parcsmeb.upf
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/csmeb_upf
###   
###   
###   sed -i 's;subIP/sip/psf/tools/upf/csme/;tools/collage/work/upf/outputs/csmeb_upf/;g' parcsmeb.upf
###   
###   ## -- Change needed as vccpwell_lv which is the old voltage rail is being used inside csmeb
###   ## -- This is going to change for 0.8
###   ## -- REVIEW and REMOVE
###   sed -i 's/vccpwell_lv/vnnprim/g' csmeb.upf
###   sed -i 's;source \$::env(IP_ROOT)/tools/csme/upf/csmeb.inc.tcl;source '"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/csmeb.inc.tcl;g' csmeb.upf
###   sed -i 's;source \$::env(IP_ROOT)/tools/csme/upf/soc_clt_upf.cfg;source '"${MODEL_ROOT}"'/tools/upf/soc_upf.cfg;g' csmeb.upf
###   sed -i 's;source $::env(IP_ROOT)/tools/csme/upf/csmeb.vcs.inc.tcl;source '"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/csmeb.vcs.inc.tcl;g' csmeb.upf
###   sed -i 's;source $::env(IP_ROOT)/tools/csme/upf/csmeb.spy.inc.tcl;source '"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/csmeb.spy.inc.tcl;g' csmeb.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/csme/tools/csme/upf/dnv/csmeb.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/csmeb_upf/csmeb.upf;g' parcsmeb.upf
###   
###   setenv IP_ROOT ${COLLAGE_WORK}/upf/outputs/csmeb_upf
###   setenv UPF_INSTALL_DIR  ${COLLAGE_WORK}/upf/outputs/csmeb_upf
###   
###   ## --- Run 1 of merge with ENABLE_SLP_RUN set
###   setenv ENABLE_SLP_RUN 1
###   echo "--->---> sub processing PARCSMEB .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeb.tcl -inc_file -tag slp |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_SLP_RUN
###   
###   echo "--->---> sub processing PARCSMEB .... Running for VCS/DC ......" |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcsmeb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcsmeb.tcl -inc_file -tag impl |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## --- parcsmeb.slp.upf and parcsmeb.impl.upf should be identical except the include. Keeping one
###   cp -f parcsmeb.impl.upf parcsmeb.merged.upf
###   cp -f parcsmeb.inc.impl.tcl parcsmeb.inc.sim.tcl
###   
###   ## --- Add if...else for selection between Spyglass and Implementation including VCS-NLP
###   sed -i '/^source \$::env(UPF_INSTALL_DIR)\/parcsmeb.inc.impl.tcl/d' parcsmeb.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parcsmeb.selection.txt' parcsmeb.merged.upf > parcsmeb.merged.upf.tmp
###   mv parcsmeb.merged.upf.tmp parcsmeb.merged.upf
###   
###   ## Substitute any signal that is mapped from vccio_1p05 to vnnprim as vccio_1p05 is not available inside PARCSMEB
###   sed -i 's;vccio_1p05;vnnprim;g' parcsmeb.merged.upf
###   
###   ##  -- Need to take below line out. USB2 ports all being dsw_1p0 is the cause
###   ## sed -i 's;vccdsw_1p0;vnnprim;g' parcsmeb.merged.upf
###   
###   ## sed -i 's/b05lar30u\*/b05hrn20u\* b05hry20u\* b05hrn23u\* b05hry23u\* b05hrn2cu\* b05hry2cu\* b05hpn23u\* b05hpy23u\* b05lar33u\* b05xar33u\*/g' parcsmeb.merged.upf
###   
###   ## -- Map of set_voltage is needed inside UPF due to a known limitation inside merge script
###   sed -i 's#"parcsmeb_pwell_wrapper_csmeb_pd_PGD1_vnnprim_gated" N/A#"parcsmeb_pwell_wrapper_csmeb_pd_PGD1_vnnprim_gated" -min 0.75 0.75#g' parcsmeb.merged.upf
###   sed -i 's#"parcsmeb_pwell_wrapper_csmeb_pd_PGD2_vnnprim_gated" N/A#"parcsmeb_pwell_wrapper_csmeb_pd_PGD2_vnnprim_gated" -min 0.75 0.75#g' parcsmeb.merged.upf
###   sed -i 's#"parcsmeb_pwell_wrapper_csmeb_pd_PSF4_PGD_vnnprim_gated" N/A#"parcsmeb_pwell_wrapper_csmeb_pd_PSF4_PGD_vnnprim_gated" -min 0.75 0.75#g' parcsmeb.merged.upf
###   sed -i 's#"parcsmeb_pwell_wrapper_csmeb_pd_SBR1_PGD_vnnprim_gated" N/A#"parcsmeb_pwell_wrapper_csmeb_pd_SBR1_PGD_vnnprim_gated" -min 0.75 0.75#g' parcsmeb.merged.upf 
###   sed -i 's#"parcsmeb_pwell_wrapper_csmeb_pd_SBR3_PGD_vnnprim_gated" N/A#"parcsmeb_pwell_wrapper_csmeb_pd_SBR3_PGD_vnnprim_gated" -min 0.75 0.75#g' parcsmeb.merged.upf
###   sed -i 's#"vnnprim" N/A#"vnnprim" -min 0.75 0.75#g' parcsmeb.merged.upf
###   sed -i 's#"vss" N/A#vss 0.0#g' parcsmeb.merged.upf
###   
###   ## -- Remove gated supplies from domains that should not have them
###   ## -- This change is necessiated due to a limitation in IEEE LRM that poses a limitation in merge script
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PSF4_PGD" "vnnprim_sms_pgd_rf_gated0"/d'  parcsmeb.merged.upf
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PSF4_PGD" "vnnprim_smt_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PSF4_PGD" "vnnprim_usbr_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PGD1" "vnnprim_sms_pgd_rf_gated0"/d'  parcsmeb.merged.upf
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PGD1" "vnnprim_smt_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   sed -i '/"parcsmeb_pwell_wrapper_csmeb_pd_PGD2" "vnnprim_usbr_pgd_rf_gated0"/d'  parcsmeb.merged.upf
###   
###   grep "connect_supply_net.*_rf_gated0" parcsmeb.merged.upf > ./parcsmeb.rf_gated.txt
###   
###   sed -i '/connect_supply_net "vnnprim_sms_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   sed -i '/connect_supply_net "vnnprim_smt_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   sed -i '/connect_supply_net "vnnprim_usbr_pgd_rf_gated0"/d' parcsmeb.merged.upf
###   
###   ## -- Change vccdsw_1p0 to vnnprim to accommodate multiple power well connections
###   sed -i '/host_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/}' parcsmeb.merged.upf
###   
###   ## -- Moving PSF from CSME to SPT changed variable PROJ inside PSF causing an issue.
###   ## -- Changing to spt_csme from csme_csme which worked when this was inside csme.
###   ## -- Need to communicate to IP
###   sed -i 's/i_psf20_csme_csme_pgd_visa_wrpr/i_psf20_spt_csme_pgd_visa_wrpr/g' parcsmeb.inc.sim.tcl
###   sed -i 's/i_psf20_csme_csme_pgd_visa_wrpr/i_psf20_spt_csme_pgd_visa_wrpr/g' parcsmeb.inc.slp.tcl
###   
###   sed -i '/Overridden PST from merge_upf/r ./parcsmeb.rf_gated.txt' parcsmeb.merged.upf
###   rm -f parcsmeb.rf_gated.txt
###   
###   ## -- Make a copy of slp version for impl and remove sbe assertion retention
###   sed -i '/sbebase\/sbcport\/enp/d' parcsmeb.inc.slp.tcl
###   sed -i '/sbebase\/sbcport\/epc/d' parcsmeb.inc.slp.tcl
###   sed -i '/sbebase\/sbcport\/inp/d' parcsmeb.inc.slp.tcl
###   sed -i '/sbebase\/sbcport\/ipc/d' parcsmeb.inc.slp.tcl
###   cp parcsmeb.inc.slp.tcl parcsmeb.inc.dc.tcl
###   
###   ## hack register as path provided in 0.8 PSF UPF is not correct
###   sed -i 's#i_fth_registers/PSF_FTH_SAI_CTRL5_reg#i_fth_registers/i_PSF_FTH_SAI_CTRL5/data_out#g' parcsmeb.inc.slp.tcl
###   sed -i 's#i_fth_registers/PSF_FTH_SAI_CTRL5_reg#i_fth_registers/i_PSF_FTH_SAI_CTRL5/data_out#g' parcsmeb.inc.dc.tcl
###   
###   cp -f parcsmeb.merged.upf ${COLLAGE_WORK}/upf/outputs/.
###   cp -f parcsmeb.inc.slp.tcl ${COLLAGE_WORK}/upf/outputs/.
###   cp -f parcsmeb.inc.sim.tcl ${COLLAGE_WORK}/upf/outputs/.
###   cp -f parcsmeb.inc.dc.tcl ${COLLAGE_WORK}/upf/outputs/.
###   
###   
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   unsetenv UPF_INSTALL_DIR
###   unsetenv IP_ROOT
###   #CK rm -rf csmeb_upf
###   ##------------------------------------------------------------------##
###   
###   setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs
###   
###   ##------------------------------------------------------------------##
###   ## PARDFX
###   ##------------------------------------------------------------------##
###   ## Need special handling for all IP's that deliver collage generated UPF
###   echo  "\n ---> Processing PARDFX ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   if (-d dfx_upf) then
###       rm -rf dfx_upf
###   endif
###   mkdir dfx_upf
###   cd dfx_upf
###   
###   cp -f -R ${MODEL_ROOT}/subIP/sip/dfx/tools/upf/* .
###   chmod -R 755 ${COLLAGE_WORK}/upf/outputs/dfx_upf
###   
###   ## now override upf_global_defs.tcl as project specific information needs to be used
###   cp -f ${COLLAGE_WORK}/upf/outputs/upf_global_defs.tcl .
###   cp -f ${COLLAGE_WORK}/upf/outputs/pardfx.upf .
###   cp -f ${COLLAGE_WORK}/upf/outputs/pardfx*.tcl .
###   
###   
###   ## change vccpwell_lv (old) to vnnprim (new)
###   sed -i '/upf_global_defs\.tcl/a\source '"${MODEL_ROOT}"'\/tools\/upf\/soc_upf\.cfg/' mst_dfx_core.upf
###   sed -i 's/vccpwell_lv/vnnprim/g' mst_dfx_core.upf
###   
###   ## -- Sent email to Selva on 0.8 UPF - need to close. Cannot have any that is self
###   sed -i 's/self/parent/g' mst_dfx_core.upf
###   
###   sed -i 's/vccpwell_lv/vnnprim/g' mst_dfx_core_set_voltage.tcl
###   sed -i 's"subIP/sip/dfx/tools/upf/mst_dfx_core"tools/collage/work/upf/outputs/dfx_upf/mst_dfx_core"g' pardfx.upf
###   
###   ## cat mst_dfx_core.upf | sed 's/vccpwell_lv/vnnprim/g' | sed 's/self/parent/g' | sed '/^set_isolation "aon_island_mst_dfx_core_pd_ps_ack_no_iso"/{N;N;N;d}' > mst_dfx_core.upf.tmp
###   ## mv mst_dfx_core.upf.tmp mst_dfx_core.upf
###   ## sed 's/vccpwell_lv/vnnprim/g' mst_dfx_core_set_voltage.tcl > mst_dfx_core_set_voltage.tcl.tmp
###   ## mv mst_dfx_core_set_voltage.tcl.tmp mst_dfx_core_set_voltage.tcl
###   ## sed 's"subIP/sip/dfx/tools/upf/mst_dfx_core"tools/collage/work/upf/outputs/dfx_upf/mst_dfx_core"g' pardfx.upf > pardfx.upf.tmp
###   ## mv pardfx.upf.tmp pardfx.upf
###   
###   setenv UPF_INSTALL_DIR  ${COLLAGE_WORK}/upf/outputs/dfx_upf
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardfx.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardfx.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf pardfx.merged.upf -config $MODEL_ROOT/tools/upf/scripts/munge_upf_pardfx.cfg -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Remove level shifters inserted as they are not supported
###   ## -- These LS will not be required come 0.7R as signals are being re-routed.
###   ## -- REVIEW and REMOVE
###   ## sed -i '/^set_level_shifter "pd_pwell_pardfx_pd_c71p8rtctop1_to_mst_dfx_core1_vccrtcwell1p5_ehv_vnnprim_ls"/{N;N;N;N;N;N;N;N;N;N;d}' pardfx.merged.munged.upf
###   ## sed -i '/set_voltage -object_list "vccrtcwell1p5_ehv"/d' pardfx.merged.munged.upf
###   ## sed -i '/create_supply_net -domain "pd_pwell_pardfx_pd" "vccrtcwell1p5_ehv"/d' pardfx.merged.munged.upf
###   ## sed -i '/create_supply_port -domain "pd_pwell_pardfx_pd" -direction "in" "vccrtcwell1p5_ehv"/d' pardfx.merged.munged.upf
###   ## sed -i '/connect_supply_net "vccrtcwell1p5_ehv" -ports "vccrtcwell1p5_hv"/d' pardfx.merged.munged.upf
###   ## sed -i 's/-power "vccrtcwell1p5_ehv"/-power "vnnprim"/g' pardfx.merged.munged.upf
###   ## sed -i 's/-state "v_0p74 0.74"/-state "v_0p75 0.75"/g' pardfx.merged.munged.upf
###   
###   ## remove vccprim_1.0 SRSN for IO signals io_iprdyb + io_ipreqb
###   ## Need to check with Bhushan and close
###   ## -- REVIEW and REMOVE
###   sed -i '/io_iprdyb/{s/vccio_1p05/vnnprim/}' pardfx.merged.munged.upf
###   sed -i '/io_ipreqb/{s/vccio_1p05/vnnprim/}' pardfx.merged.munged.upf
###   
###   cp -f pardfx.merged.upf ${COLLAGE_WORK}/upf/outputs/pardfx.merged.upf
###   cp -f pardfx.merged.munged.upf ${COLLAGE_WORK}/upf/outputs/pardfx.merged.munged.upf
###   cp -f pardfx.upf_flat.upf ${COLLAGE_WORK}/upf/outputs/.
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   rm -rf dfx_upf
###   unsetenv UPF_INSTALL_DIR
###   ##------------------------------------------------------------------##
###   
###   setenv UPF_INSTALL_DIR ${COLLAGE_WORK}/upf/outputs
###   
###   ##------------------------------------------------------------------##
###   ## PARDSP
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARDSP ...." |& tee -a ${LOG_FILE_LOCATION}
###   ## --  Create a link of soc_upf.cfg file to enable FUSE
###   ln -fs $MODEL_ROOT/tools/upf/soc_upf.cfg $MODEL_ROOT/tools/upf/SPT_SYN_soc_upf.cfg
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardsp.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardsp.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- get all the connect_supply_net's for EBB's
###   grep "connect_supply_net.*vnnprim_r[o|f]_gated[0|1|2|3|4]" pardsp.merged.upf > pardsp.ebb.csn.txt
###   grep -v "connect_supply_net.*vnnprim_r[o|f]_gated[0|1|2|3|4]" pardsp.merged.upf > pardsp.merged.upf.tmp
###   mv pardsp.merged.upf.tmp pardsp.merged.upf
###   
###   ## -- This change is necessiated due to a limitation in IEEE LRM that poses a limitation in merge script
###   ## -- remove ro_gated0 from other domains
###   sed -i '/connect_supply_net "vnnprim_ro_gated0"/d' pardsp.merged.upf
###   sed -i '/connect_supply_net "vnnprim_rf_gated0"/d' pardsp.merged.upf
###   sed -i '/connect_supply_net "vnnprim_rf_gated1"/d' pardsp.merged.upf
###   
###   sed -i '/Overridden PST from merge_upf/r ./pardsp.ebb.csn.txt' pardsp.merged.upf
###   
###   ## -- remove ro_gated0 from other domains
###   sed -i '/"pd_pwell_pardsp_pd_PGD2" "vnnprim_ro_gated0" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD3" "vnnprim_ro_gated0" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD4" "vnnprim_ro_gated0" -resolve "parallel"/d' pardsp.merged.upf
###   
###   ## -- remove rf_gated1 from other domains
###   sed -i '/"pd_pwell_pardsp_pd_PGD2" "vnnprim_rf_gated1" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD3" "vnnprim_rf_gated1" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD4" "vnnprim_rf_gated1" -resolve "parallel"/d' pardsp.merged.upf
###   
###   ## -- remove rf_gated2 from other domains
###   sed -i '/"pd_pwell_pardsp_pd_PGD1" "vnnprim_rf_gated2" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD3" "vnnprim_rf_gated2" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD4" "vnnprim_rf_gated2" -resolve "parallel"/d' pardsp.merged.upf
###   
###   ## -- remove rf_gated3 from other domains
###   sed -i '/"pd_pwell_pardsp_pd_PGD1" "vnnprim_rf_gated3" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD2" "vnnprim_rf_gated3" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD4" "vnnprim_rf_gated3" -resolve "parallel"/d' pardsp.merged.upf
###   
###   ## -- remove rf_gated4 from other domains
###   sed -i '/"pd_pwell_pardsp_pd_PGD1" "vnnprim_rf_gated4" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD2" "vnnprim_rf_gated4" -resolve "parallel"/d' pardsp.merged.upf
###   sed -i '/"pd_pwell_pardsp_pd_PGD3" "vnnprim_rf_gated4" -resolve "parallel"/d' pardsp.merged.upf
###   
###   ## -- sub vccdsw_1p0 which should not exist
###   sed -i 's;vccdsw_1p0;vnnprim;g' pardsp.merged.upf
###   
###   ## -- clean up
###   rm -f pardsp.ebb.csn.txt
###   
###   ## -- Add in connect supply nets for passgate that is placed between SRAM LYA signals and rest of core logic
###   ## -- LYA operates at vccsram_1p05 and LYA has a LS for needs vccsram_1p0 information passed to it.
###   cp -f $MODEL_ROOT/tools/upf/scripts/dsp_passgate.txt .
###   sed -i '/Overridden PST from merge_upf/r ./dsp_passgate.txt' pardsp.merged.upf
###   rm -f dsp_passgate.txt
###   rm -f $MODEL_ROOT/tools/upf/SPT_SYN_soc_upf.cfg
###   
###   ##------------------------------------------------------------------##
###   ## PARISH
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARISH ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   if (-d ish_upf) then
###       rm -rf ish_upf
###   endif
###   mkdir ish_upf
###   cd ish_upf
###   
###   cp -f -R ${MODEL_ROOT}/subIP/sip/ish/source/upf/spt/* .
###   chmod -R 755 ${COLLAGE_WORK}/upf/outputs/ish_upf
###   
###   ## -- Special processing of variables used in UPF needed as ISH uses 
###   ## -- additional variables that are not used in any other partition
###   ## echo " " >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo "## Edited by SPT FC UPF flow" >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_ROM_NOM_STATE "v_rom_0p75"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_ROM_OFF_STATE "v_off"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_RF_NOM_STATE "v_rf_0p75"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_RF_OFF_STATE "v_off"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_RF_NOM  "0.75"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_ROM_NOM "0.75"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_NOM_STATE "v_0p75"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SOC_SUPPLY_OFF_STATE "v_off"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SRAM_SUPPLY_NOM_STATE "v_0p89"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set SRAM_SUPPLY_OFF_STATE "v_off"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   ## echo 'set GND_SUPPLY_NOM_STATE "v_0p0"' >> ish_upf.cfg |& tee -a ${LOG_FILE_LOCATION}
###   
###   cp -f ${MODEL_ROOT}/tools/upf/soc_upf.cfg .
###   cp -f ${COLLAGE_WORK}/upf/outputs/parish.upf .
###   
###   sed -i 's#subIP/sip/ish/upf/spt/ish_rtl_top#tools/collage/work/upf/outputs/ish_upf/ish_rtl_top#g' parish.upf
###   setenv ISH_UPF_ROOT_DIR $COLLAGE_WORK/upf/outputs/ish_upf
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parish.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parish.tcl -print_gated_first |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## Remove below lines from merged UPF file as they are not needed
###   sed -i '/"pd_pwell_parish_pd_GATED_0" "vnnprim_rf_gated" -resolve "parallel"/d' parish.merged.upf
###   sed -i '/"pd_pwell_parish_pd_GATED_0" "vnnprim_rom_gated" -resolve "parallel"/d' parish.merged.upf
###   
###   ## -- Substitute the name as this was hardcoded inside IP UPF
###   sed -i 's/-isolation_power_net "pd2_ish_GATED_vnnprim_gated"/-isolation_power_net "pd_pwell_parish_pd_GATED_0_vnnprim_gated"/g' parish.merged.upf
###   
###   
###   
###   ## -- Below changes are needed as synopsys_program_name is not being passed as the naming in UPF is not working for merge
###   sed -i 's/"pd_pwell_parish_pd_GATED_0_vnnprim_gated" N\/A/"pd_pwell_parish_pd_GATED_0_vnnprim_gated" -min 0.75 0.75/g' parish.merged.upf
###   sed -i 's/"vnnprim" N\/A/"vnnprim" -min 0.75 0.75/g' parish.merged.upf
###   sed -i 's/"vss" N\/A/vss 0.0/g' parish.merged.upf
###    
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parish.merged.upf -config $MODEL_ROOT/tools/upf/scripts/munge_upf_parish.cfg -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Same set of changes on the munged UPF file
###   ## -- Below changes are needed as synopsys_program_name is not being passed as the naming in UPF is not working for merge
###   sed -i 's/"pd_pwell_parish_pd_GATED_0_vnnprim_gated" N\/A/"pd_pwell_parish_pd_GATED_0_vnnprim_gated" -min 0.75 0.75/g' parish.merged.munged.upf
###   sed -i 's/"vnnprim" N\/A/"vnnprim" -min 0.75 0.75/g' parish.merged.munged.upf
###   sed -i 's/"vss" N\/A/vss 0.0/g' parish.merged.munged.upf
###   
###   ## -- Move RF/ROM supplies to account for use before declaration - merge script limitation
###   grep 'connect_supply_net "vnnprim_rf_gated"' parish.merged.munged.upf > parish.csn.txt
###   grep 'connect_supply_net "vnnprim_rom_gated"' parish.merged.munged.upf >> parish.csn.txt
###   sed -i '/connect_supply_net "vnnprim_rom_gated"/d' parish.merged.munged.upf
###   sed -i '/connect_supply_net "vnnprim_rf_gated"/d' parish.merged.munged.upf
###   sed -i '/Overridden PST from munge_upf/r parish.csn.txt' parish.merged.munged.upf
###   rm -f parish.csn.txt
###   
###   ## -- Now move the gated supply net declaration as RF/ROM isolation need it
###   grep -A6 'create_power_domain "pd_pwell_parish_pd_GATED_0" -elements' parish.merged.munged.upf > parish.cpd.txt
###   sed -i '/create_power_domain "pd_pwell_parish_pd_GATED_0" -elements/{N;N;N;N;N;N;d}' parish.merged.munged.upf
###   sed -i '/create_supply_net -domain "parish_pwell_wrapper_ish_spt_top1_pd3_ish_rfrom_GATED" "vss" -reuse/r parish.cpd.txt' parish.merged.munged.upf
###   rm -f parish.cpd.txt
###   
###   sed -i '/create_supply_net -domain "pd_pwell_parish_pd_GATED_0" "pd_pwell_parish_pd_GATED_0_vnnprim_gated"/d' parish.merged.munged.upf
###   sed -i '/set_domain_supply_net "parish_pwell_wrapper_ish_spt_top1_pd3_ish_rfrom_GATED"/i\create_supply_net -domain "pd_pwell_parish_pd_GATED_0" "pd_pwell_parish_pd_GATED_0_vnnprim_gated"' parish.merged.munged.upf
###   
###   ## ## -- Need to check why genblk<> changes for SRAM only. This might be mute as it will get replaced with co-location wrapper (REVIEW)
###   ## ## -- REVIEW and REMOVE
###   ## sed -i 's#genblk1#genblk2#g' parish.merged.munged.upf
###   
###   cp -f parish.merged.upf ${COLLAGE_WORK}/upf/outputs/parish.merged.upf
###   cp -f parish.merged.munged.upf ${COLLAGE_WORK}/upf/outputs/parish.merged.munged.upf
###   cp -f parish.upf_flat.upf ${COLLAGE_WORK}/upf/outputs/parish.upf_flat.upf
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   rm -rf ish_upf
###   unsetenv ISH_UPF_ROOT_DIR
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARLEG
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARLEG ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   echo  "\n --->---> Sub Processing SBR ....." |& tee -a ${LOG_FILE_LOCATION}
###   cd ${COLLAGE_WORK}/upf/outputs
###   if (-d sbr_upf) then
###     rm -rf sbr_upf
###   endif
###   
###   mkdir sbr_upf
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/sbr_upf
###   cd sbr_upf
###   
###   cp -f -R ${MODEL_ROOT}/subIP/sip/sbr/tools/upf/router/* .
###   sed -i 's;../../../../tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/sbr_upf;g' sbr_config_ipxact_chs_sbr0_top.upf
###   
###   cp -f $MODEL_ROOT/tools/upf/soc_upf.cfg .
###   cp -f $COLLAGE_WORK/upf/outputs/parleg* .
###   cp -f $COLLAGE_WORK/upf/outputs/upf_global_defs.tcl .
###   
###   sed -i 's/IP_ROOT/MODEL_ROOT/g' sbr_config_ipxact_chs_sbr0_top.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr0_top.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/sbr_upf/sbr_config_ipxact_chs_sbr0_top.upf;g' parleg.upf
###   cp -f parleg.upf ${COLLAGE_WORK}/upf/outputs/.
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   echo  "\n --->---> Sub Processing SPI ....." |& tee -a ${LOG_FILE_LOCATION}
###   ## Hack needed for SPI as they are using non-template based upf cfg file loading
###   cd ${COLLAGE_WORK}/upf/outputs
###   if (-d spi) then
###     rm -rf spi
###   endif
###   
###   mkdir spi
###   cd spi
###   
###   cp -f -R ${MODEL_ROOT}/subIP/spi_ROOT/tools/upf .
###   chmod -R 755 upf
###   cd upf
###   
###   sed -i 's;set SPI_UPF_ROOT_DIR \$::env(MODEL_ROOT)/tools/upf;set SPI_UPF_ROOT_DIR \$::env{COLLAGE_WORK}/upf/outputs/spi/upf;g' spi.upf
###   sed -i 's;set SPI_UPF_ROOT_DIR \$::env(IP_ROOT)/tools/upf;set SPI_UPF_ROOT_DIR \$::env{COLLAGE_WORK}/upf/outputs/spi/upf;g' spi.upf
###   sed -i 's"source \$SPI_UPF_ROOT_DIR/spi_upf\.cfg"source \$SPI_UPF_ROOT_DIR/spi_upf\.cfg\nsource \$\:\:env\(MODEL_ROOT\)/tools/upf/soc_upf.cfg\n"g' spi.upf
###   
###   sed -i 's;set SPI_SR_LIST_DIR.*$;set SPI_SR_LIST_DIR \$::env{COLLAGE_WORK}/upf/outputs/spi/upf/sr_list;g' spi_upf.cfg
###   
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   sed -i 's;'"${MODEL_ROOT}"'/subIP\/sip/spi/tools/upf/spi\.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/spi/upf/spi\.upf ; g' parleg.upf
###   
###   ## -- There is difference in the isolation strategies between SLP and rest for P2SB.
###   ## -- This is due to a limitation in the tool
###   ## -- Will process all of SLP first and tag it with a different name before processing NLP/DC changes
###   
###   ## Merge PES IP PGD
###   setenv ENABLE_SLP_RUN 1
###   echo "--->---> sub processing PARLEG .... Running for Spyglass ..... (MERGE 1)" |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parleg.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parleg.tcl -inc_file -tag slp |& tee -a ${LOG_FILE_LOCATION}
###   
###   echo "--->---> sub processing PARLEG .... Running for Spyglass .....(MUNGE for isolation)" |& tee -a ${LOG_FILE_LOCATION}
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.slp.upf -config $MODEL_ROOT/tools/upf/scripts/munge_upf_parleg.cfg -inc_file -tag slp -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   
###   echo "--->---> sub processing PARLEG .... Running for Spyglass .....(MUNGE for intermediate LS)" |& tee -a ${LOG_FILE_LOCATION}
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.slp.slp.upf -config $MODEL_ROOT/tools/upf/scripts/parleg_insert_intermediate_ls.tcl -inc_file -tag slp -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   unsetenv ENABLE_SLP_RUN
###   
###   ## -- LPC and SMB retention lists have additional spaces causing issues for merge. Cleaning up
###   sed -i '/parleg_pwell_wrapper\/smb_core1\/$/d' parleg.slp.slp.inc.slp.tcl
###   sed -i '/parleg_pwell_wrapper\/lpc1\/$/d' parleg.slp.slp.inc.slp.tcl
###   
###   mv parleg.slp.slp.slp.upf parleg.merged.slp.upf
###   mv parleg.slp.slp.inc.slp.tcl parleg.merged.slp.tcl
###   
###   sed -i 's/parleg.slp.slp.inc.slp.tcl/parleg.merged.slp.tcl/g' parleg.merged.slp.upf 
###   
###   ## Remove assertion SR elements from SBE from spyglass file
###   sed -i '/sbebase\/sbcport\/ipc/d' parleg.merged.slp.tcl
###   sed -i '/sbebase\/sbcport\/inp/d' parleg.merged.slp.tcl
###   sed -i '/sbebase\/sbcport\/epc/d' parleg.merged.slp.tcl
###   sed -i '/sbebase\/sbcport\/enp/d' parleg.merged.slp.tcl
###   
###   ## Removing vccrtc inserted due to gpiocom1unit talking to PCH signals
###   ## Discussion on going. Might get fixed for 0.7R
###   ## -- REVIEW and REMOVE
###   sed -i '/set_level_shifter "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccrtcwell1p5_ehv_vnnprim_ls"/{N;N;N;N;N;N;N;N;N;d}' parleg.merged.slp.tcl
###   sed -i '/vccrtcwell1p5_ehv/d' parleg.merged.slp.tcl
###   
###   ## -- Map of set_voltage is needed inside UPF due to a known limitation inside merge script
###   sed -i 's#"vccio_1p05" N/A#"vccio_1p05" -min 0.85 0.85#g' parleg.merged.slp.tcl
###   
###   ## Substitute rail which is 1.0 with vccio_1p05. Need to check with Bhushan
###   ## gpp_a_10_clkout_lpc_1_txdata + gpp_a_9_clkout_lpc_0_txdata
###   ## -- REVIEW and REMOVE
###   sed -i '/gpp_a_10_clkout_lpc_1_txdata/{s/vccf24_1p0/vccio_1p05/g}' parleg.merged.slp.tcl
###   sed -i '/gpp_a_9_clkout_lpc_0_txdata/{s/vccf24_1p0/vccio_1p05/g}' parleg.merged.slp.tcl
###   
###   ## Remove 1.0v vccio_1p05 supply inside DSW as it is not needed
###   sed -i '/"pd_dsw_parleg_pd" "vccio_1p05" -reuse/d' parleg.merged.slp.tcl
###   
###   echo "\n --->---> Processing PARLEG for PMC gated supply for ROM ..." |& tee -a ${LOG_FILE_LOCATION}
###   sed -i '/"parleg_pwell_wrapper_pmc_pwell1_pd_pmc_primary" "vnnprim_rom_gated1" -resolve "parallel"/d' parleg.merged.slp.upf
###   grep 'connect_supply_net "vnnprim_rom_gated1"' parleg.merged.slp.upf > parleg.pmc.gated.txt 
###   sed -i '/connect_supply_net "vnnprim_rom_gated1" -ports/d' parleg.merged.slp.upf
###   sed -i '/Overridden PST from munge_upf/r parleg.pmc.gated.txt' parleg.merged.slp.upf
###   rm -f parleg.pmc.gated.txt
###   
###   
###   echo "--->---> sub processing PARLEG .... Running for NLP ..... (MERGE 1)" |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parleg.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parleg.tcl -inc_file -tag impl |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## Munge UPF for clock isolation separation
###   echo "--->---> sub processing PARLEG .... Running for NLP .....(MUNGE for isolation)" |& tee -a ${LOG_FILE_LOCATION}
###   setenv ENABLE_SLP_RUN 0
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.impl.upf -config $MODEL_ROOT/tools/upf/scripts/munge_upf_parleg.cfg -inc_file -tag impl -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Add intermediate LS hierarchy needed in parrtc 
###   ## -- Intermediate LS is needed as libs cells cannot LS from 0.75 to 1.11. The signals are being LS from 0.75 to 0.89
###   ## -- and then from 0.89 to 1.11
###   echo "\n --->---> Generating intermediate LS ..." |& tee -a ${LOG_FILE_LOCATION}
###   
###   echo "--->---> sub processing PARLEG .... Running for NLP .....(MUNGE for intermediate LS)" |& tee -a ${LOG_FILE_LOCATION}
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parleg.impl.impl.upf -config $MODEL_ROOT/tools/upf/scripts/parleg_insert_intermediate_ls.tcl -inc_file -tag impl -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   
###   ## -- LPC and SMB retention lists have additional spaces causing issues for merge. Cleaning up
###   sed -i '/parleg_pwell_wrapper\/smb_core1\/$/d' parleg.impl.impl.inc.impl.tcl
###   sed -i '/parleg_pwell_wrapper\/lpc1\/$/d' parleg.impl.impl.inc.impl.tcl
###   
###   mv parleg.impl.impl.impl.upf parleg.merged.impl.upf
###   mv parleg.impl.impl.inc.impl.tcl parleg.merged.impl.tcl
###   
###   sed -i 's/parleg.impl.impl.inc.impl.tcl/parleg.merged.impl.tcl/g' parleg.merged.impl.upf 
###   
###   ## Removing vccrtc inserted due to gpiocom1unit talking to PCH signals
###   ## Discussion on going. Might get fixed for 0.7R
###   ## -- REVIEW and REMOVE
###   sed -i '/set_level_shifter "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccrtcwell1p5_ehv_vnnprim_ls"/{N;N;N;N;N;N;N;N;N;d}' parleg.merged.impl.upf
###   sed -i '/vccrtcwell1p5_ehv/d' parleg.merged.impl.upf
###   
###   ## -- Map of set_voltage is needed inside UPF due to a known limitation inside merge script
###   sed -i 's#"vccio_1p05" N/A#"vccio_1p05" -min 0.85 0.85#g' parleg.merged.impl.upf
###   
###   ## Substitute rail which is 1.0 with vccio_1p05. Need to check with Bhushan
###   ## gpp_a_10_clkout_lpc_1_txdata + gpp_a_9_clkout_lpc_0_txdata
###   ## -- REVIEW and REMOVE
###   sed -i '/gpp_a_10_clkout_lpc_1_txdata/{s/vccf24_1p0/vccio_1p05/g}' parleg.merged.impl.upf
###   sed -i '/gpp_a_9_clkout_lpc_0_txdata/{s/vccf24_1p0/vccio_1p05/g}' parleg.merged.impl.upf
###   
###   ## Remove 1.0v vccio_1p05 supply inside DSW as it is not needed
###   sed -i '/"pd_dsw_parleg_pd" "vccio_1p05" -reuse/d' parleg.merged.impl.upf
###   
###   echo "\n --->---> Processing PARLEG for PMC gated supply for ROM ..." |& tee -a ${LOG_FILE_LOCATION}
###   sed -i '/"parleg_pwell_wrapper_pmc_pwell1_pd_pmc_primary" "vnnprim_rom_gated1" -resolve "parallel"/d' parleg.merged.impl.upf
###   grep 'connect_supply_net "vnnprim_rom_gated1"' parleg.merged.impl.upf > parleg.pmc.gated.txt 
###   sed -i '/connect_supply_net "vnnprim_rom_gated1" -ports/d' parleg.merged.impl.upf
###   sed -i '/Overridden PST from munge_upf/r parleg.pmc.gated.txt' parleg.merged.impl.upf
###   rm -f parleg.pmc.gated.txt
###   
###   
###   rm -rf ${COLLAGE_WORK}/upf/outputs/spi
###   rm -rf ${COLLAGE_WORK}/upf/outputs/sbr_upf
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARLPSS
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARLPSS ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parlpss.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parlpss.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## bug in 0.7R UPF. HSD filed and ack'ed by LPSS
###   ## -- REVIEW and REMOVE
###   sed -i 's/posedge/low/g' parlpss.merged.upf
###   sed -i 's/negedge/high/g' parlpss.merged.upf
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARDMI
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARDMI ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   echo  "\n --->---> Sub Processing PARDMI for simulation only ...." |& tee -a ${LOG_FILE_LOCATION}
###   setenv SIM_MODE_RETENTION 1
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardmi.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardmi.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv SIM_MODE_RETENTION
###   
###   echo  "\n --->---> Sub Processing PARDMI for DC/Spyglass-LP only ...." |& tee -a ${LOG_FILE_LOCATION}
###   setenv SIM_MODE_RETENTION 0
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf pardmi.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_pardmi.tcl -inc_file -tag impl |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv SIM_MODE_RETENTION
###   
###   mv pardmi.sim.upf pardmi.impl.upf
###   mv pardmi.impl.upf pardmi.merged.upf
###   
###   ## Now remove redundant scan isolation from OPI
###   echo  "\n --->---> Sub Processing PARDMI for redundant isolations ...." |& tee -a ${LOG_FILE_LOCATION}
###   setenv ENABLE_NLP_RUN 1
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf pardmi.merged.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/munge_upf_pardmi.cfg -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_NLP_RUN
###   
###   setenv ENABLE_NLP_RUN 0
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf pardmi.merged.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/munge_upf_pardmi.cfg -inc_file -tag impl |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_NLP_RUN
###   
###   mv pardmi.merged.sim.upf pardmi.merged.impl.upf
###   mv pardmi.merged.impl.upf pardmi.merged.upf
###   
###   mv pardmi.merged.inc.impl.tcl pardmi.inc.impl.tcl
###   mv pardmi.merged.inc.sim.tcl pardmi.inc.sim.tcl
###   
###   ## Insert if..else to select
###   sed -i '/pardmi.inc.sim.tcl/d' pardmi.merged.upf
###   
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/pardmi.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/pardmi.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/pardmi.inc.sim.tcl\n}\n" if $. == 2' pardmi.merged.upf
###   
###   
###   ## -- remove SBE retention that is for simulation only from implementation version
###   sed -i '/pardmi_pwell_wrapper\/pdmi1\/pdmi_sip_core_pgd1\/npeunit_wrapper1\/npeunit1\/npesbe1\/npesbe\/sbebase\/sbcport\/enp/d' pardmi.inc.impl.tcl
###   sed -i '/pardmi_pwell_wrapper\/pdmi1\/pdmi_sip_core_pgd1\/npeunit_wrapper1\/npeunit1\/npesbe1\/npesbe\/sbebase\/sbcport\/epc/d' pardmi.inc.impl.tcl
###   sed -i '/pardmi_pwell_wrapper\/pdmi1\/pdmi_sip_core_pgd1\/npeunit_wrapper1\/npeunit1\/npesbe1\/npesbe\/sbebase\/sbcport\/inp/d' pardmi.inc.impl.tcl
###   sed -i '/pardmi_pwell_wrapper\/pdmi1\/pdmi_sip_core_pgd1\/npeunit_wrapper1\/npeunit1\/npesbe1\/npesbe\/sbebase\/sbcport\/ipc/d' pardmi.inc.impl.tcl
###   
###   
###   sed -i '/pardmi.merged.inc.sim.tcl/d' pardmi.merged.upf
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARPSF1/2/3
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARPSF1/2/3 ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   setenv IP_ROOT ${MODEL_ROOT}/subIP/sip/psf
###   echo  "\n --->---> sub processing PARPSF1 .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
###   setenv ENABLE_SLP_RUN 1
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf1.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf1.tcl -inc_file -tag slp |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_SLP_RUN
###   
###   echo  "\n --->---> sub processing PARPSF1 .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf1.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf1.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- parpsf1.slp.upf and parpsf1.impl.upf should be identical except include. Keeping one
###   cp -f parpsf1.impl.upf parpsf1.merged.upf
###   rm -f parpsf1.impl.upf
###   rm -f parpsf1.slp.upf
###   
###   ## -- Replacing ./ as this is an issue in the PSF UPF files. This will not exist in 0.7R release.
###   sed -i 's;\.\/;;g' parpsf1.merged.upf
###   sed -i 's;\.\/;;g' parpsf1.inc.slp.tcl
###   sed -i 's;\.\/;;g' parpsf1.inc.impl.tcl
###   
###   ## --- Add if...else for selection between Spyglass and Implementation including VCS-NLP
###   sed -i '/^source \$::env(UPF_INSTALL_DIR)\/parpsf1.inc.impl.tcl/d' parpsf1.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parpsf1.selection.txt' parpsf1.merged.upf > parpsf1.merged.upf.tmp
###   mv parpsf1.merged.upf.tmp parpsf1.merged.upf
###   
###   ## Remove redundant scan isolation signals
###   sed -i '/fscan_clkungate\>/d' parpsf1.inc.*.tcl
###   sed -i '/fscan_latchclosed_b\>/d' parpsf1.inc.*.tcl
###   sed -i '/fscan_latchopen\>/d' parpsf1.inc.*.tcl
###   sed -i '/fscan_ram_odis_b\>/d' parpsf1.inc.*.tcl
###   sed -i '/fscan_ram_rddis_b\>/d' parpsf1.inc.*.tcl
###   sed -i '/fscan_ram_wrdis_b\>/d' parpsf1.inc.*.tcl
###   
###   ## Because of removal of redundant signals the strategy becomes empty
###   sed -i '/set_isolation "parpsf1_pwell_wrapper_parpsf1_scanunit_PD_PWELL_PARPSF1_PD_GATED_0_to_PD_PWELL_PARPSF1_PD_1/{N;N;N;N;N;N;d}' parpsf1.merged.upf
###   sed -i '/set_isolation_control "parpsf1_pwell_wrapper_parpsf1_scanunit_PD_PWELL_PARPSF1_PD_GATED_0_to_PD_PWELL_PARPSF1_PD_1/{N;N;N;N;N;d}' parpsf1.merged.upf
###   sed -i '/map_isolation_cell "parpsf1_pwell_wrapper_parpsf1_scanunit_PD_PWELL_PARPSF1_PD_GATED_0_to_PD_PWELL_PARPSF1_PD_1/{N;N;N;d}' parpsf1.merged.upf
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   echo  "\n --->---> sub processing PARPSF2 .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
###   setenv ENABLE_SLP_RUN 1
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf2.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf2.tcl -inc_file -tag slp |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_SLP_RUN
###   
###   echo  "\n --->---> sub processing PARPSF2 .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf2.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf2.tcl -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- parpsf2.slp.upf and parpsf2.impl.upf should be identical except include. Keeping one
###   cp -f parpsf2.impl.upf parpsf2.merged.upf
###   rm -f parpsf2.impl.upf
###   rm -f parpsf2.slp.upf
###   
###   ## -- Replacing ./ as this is an issue in the PSF UPF files. This will not exist in 0.7R release.
###   sed -i 's;\.\/;;g' parpsf2.merged.upf
###   sed -i 's;\.\/;;g' parpsf2.inc.slp.tcl
###   sed -i 's;\.\/;;g' parpsf2.inc.impl.tcl
###   
###   ## (REVIEW)
###   ## -- Replacing all vccio_1p05 to vnnprim.
###   ## -- Signals port_8_MEOM* coming from USB2 PHY is the cause.
###   sed -i 's;vccio_1p05;vnnprim;g' parpsf2.merged.upf
###   
###   ## --- Add if...else for selection between Spyglass and Implementation including VCS-NLP
###   sed -i '/^source \$::env(UPF_INSTALL_DIR)\/parpsf2.inc.impl.tcl/d' parpsf2.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parpsf2.selection.txt' parpsf2.merged.upf > parpsf2.merged.upf.tmp
###   mv parpsf2.merged.upf.tmp parpsf2.merged.upf
###   
###   ## Remove redundant scan isolation signals
###   sed -i '/fscan_latchclosed_b\>/d' parpsf2.inc.*.tcl
###   sed -i '/fscan_latchopen\>/d' parpsf2.inc.*.tcl
###   sed -i '/fscan_ram_odis_b\>/d' parpsf2.inc.*.tcl
###   sed -i '/fscan_ram_rddis_b\>/d' parpsf2.inc.*.tcl
###   sed -i '/fscan_ram_wrdis_b\>/d' parpsf2.inc.*.tcl
###   
###   sed -i '/set_isolation "parpsf2_pwell_wrapper_parpsf2_scanunit_PD_PWELL_PARPSF2_PD_GATED_0_to_PD_PWELL_PARPSF2_PD_1/{N;N;N;N;N;N;d}' parpsf2.merged.upf
###   sed -i '/set_isolation_control "parpsf2_pwell_wrapper_parpsf2_scanunit_PD_PWELL_PARPSF2_PD_GATED_0_to_PD_PWELL_PARPSF2_PD_1/{N;N;N;N;N;d}' parpsf2.merged.upf
###   sed -i '/map_isolation_cell "parpsf2_pwell_wrapper_parpsf2_scanunit_PD_PWELL_PARPSF2_PD_GATED_0_to_PD_PWELL_PARPSF2_PD_1/{N;N;N;d}' parpsf2.merged.upf
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   echo  "\n --->---> sub processing PARPSF3 (SBR) .... " |& tee -a ${LOG_FILE_LOCATION}
###   cd $COLLAGE_WORK/upf/outputs
###   if (-d sbr_upf) then
###       rm -rf sbr_upf
###   endif
###   mkdir sbr_upf
###   chmod -R 755 sbr_upf
###   cd sbr_upf
###   
###   #cp -fR $MODEL_ROOT/subIP/sip/sbr/tools/upf/router/* .
###   #sed -i 's;../../../../tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/sbr_upf;g' sbr_config_ipxact_chs_sbr2_top.upf
###   #sed -i 's/IP_ROOT/MODEL_ROOT/g' sbr_config_ipxact_chs_sbr2_top.upf
###   ## -- Processing SBR router IP UPF for paths that do not scale to FC
###   cp -fR $MODEL_ROOT/subIP/sip/sbr/tools/upf/router/* .
###   sed -i 's;$::env(IP_ROOT)/tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/sbr_upf;g' sbr_config_ipxact_chs_sbr2_top.upf
###   sed -i 's;soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;soc_upf.cfg;g' sbr_config_ipxact_chs_sbr2_top.upf
###   sed -i 's;IP_ROOT;MODEL_ROOT;g' sbr_config_ipxact_chs_sbr2_top.upf
###   
###   sed -i '/map_retention_cell/{s/#//; N; s/#//; N; s/#//}' sbr_config_ipxact_chs_sbr2.upf
###   sed -i 's/retention_regs_sbr2/sr_SBR_sbr2/g' sbr_config_ipxact_chs_sbr2.upf
###   sed -i 's/pd_SBR_sbr2_gated/pd_SBR_sbr2_PGD/g' sbr_config_ipxact_chs_sbr2.upf
###   sed -i '/save_signal/{s/high/low/}' sbr_config_ipxact_chs_sbr2.upf
###   sed -i '/restore_signal/{s/low/high/}' sbr_config_ipxact_chs_sbr2.upf
###   
###   cp -f $COLLAGE_WORK/upf/outputs/parpsf3* .
###   
###   sed -i 's;/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr2_top.upf;/tools/collage/work/upf/outputs/sbr_upf/sbr_config_ipxact_chs_sbr2_top.upf;g' parpsf3.upf
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/sbr_upf
###   #sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr2_top.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/sbr_upf/sbr_config_ipxact_chs_sbr2_top.upf;g' parpsf3.upf
###   cd $COLLAGE_WORK/upf/outputs
###   cp -f $COLLAGE_WORK/upf/outputs/sbr_upf/parpsf3.upf .
###   
###   echo  "\n --->---> sub processing PARPSF3 .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
###   setenv ENABLE_SLP_RUN 1
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf3.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf3.tcl -inc_file -tag slp |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv ENABLE_SLP_RUN
###   
###   echo  "\n --->---> sub processing PARPSF3 .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpsf3.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpsf3.tcl -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- parpsf2.slp.upf and parpsf2.impl.upf should be identical except include. Keeping one
###   cp -f parpsf3.impl.upf parpsf3.merged.upf
###   rm -f parpsf3.impl.upf
###   rm -f parpsf3.slp.upf
###   
###   ## -- Replacing ./ as this is an issue in the PSF UPF files. This will not exist in 0.7R release.
###   sed -i 's;\.\/;;g' parpsf3.merged.upf
###   sed -i 's;\.\/;;g' parpsf3.inc.slp.tcl
###   sed -i 's;\.\/;;g' parpsf3.inc.impl.tcl
###   
###   ## --- Add if...else for selection between Spyglass and Implementation including VCS-NLP
###   sed -i '/^source \$::env(UPF_INSTALL_DIR)\/parpsf3.inc.impl.tcl/d' parpsf3.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parpsf3.selection.txt' parpsf3.merged.upf > parpsf3.merged.upf.tmp
###   mv parpsf3.merged.upf.tmp parpsf3.merged.upf
###   
###   sed -i '/fscan_latchclosed_b\>/d' parpsf3.inc.*.tcl
###   sed -i '/fscan_latchopen\>/d' parpsf3.inc.*.tcl
###   ##xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx##
###   
###   unsetenv IP_ROOT
###   rm -rf $COLLAGE_WORK/upf/outputs/sbr_upf
###   
###   ##------------------------------------------------------------------##
###   ## PARPXPA/B/C/D/E
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARPXPA/B/C/D/E ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Copy over SATA UPF as it needs to be cleaning up before merging
###   cd $COLLAGE_WORK/upf/outputs
###   if (-d pcie_upf) then
###       rm -rf pcie_upf
###   endif
###   mkdir pcie_upf
###   cd pcie_upf
###   
###   cp -f -R $MODEL_ROOT/subIP/sip/pcie/tools/upf/* .
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/pcie_upf
###   dos2unix pcie.upf
###   
###   sed -i 's;info exists $env(ACE_RTL_SIM);info exists ::env(ACE_RTL_SIM);g' pcie.upf
###   cp -f $COLLAGE_WORK/upf/outputs/parpxp* .
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/pcie/tools/upf/pcie.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/pcie_upf/pcie.upf;g' parpxpa.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/pcie/tools/upf/pcie.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/pcie_upf/pcie.upf;g' parpxpb.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/pcie/tools/upf/pcie.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/pcie_upf/pcie.upf;g' parpxpc.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/pcie/tools/upf/pcie.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/pcie_upf/pcie.upf;g' parpxpd.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/pcie/tools/upf/pcie.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/pcie_upf/pcie.upf;g' parpxpe.upf
###   
###   ## -- Take care of SBR4 which moved to PARPXPB
###   echo  "\n --->--> Sub Processing SBR ...." |& tee -a ${LOG_FILE_LOCATION}
###   setenv IP_ROOT $MODEL_ROOT
###   
###   ## -- Processing SBR router IP UPF for paths that do not scale to FC
###   cp -fR $MODEL_ROOT/subIP/sip/sbr/tools/upf/router/* .
###   sed -i 's;$::env(IP_ROOT)/tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/pcie_upf;g' sbr_config_ipxact_chs_sbr4_top.upf
###   sed -i 's;soc_upf_$::env(SIP_LIBRARY_TYPE).cfg;soc_upf.cfg;g' sbr_config_ipxact_chs_sbr4_top.upf
###   sed -i 's;IP_ROOT;MODEL_ROOT;g' sbr_config_ipxact_chs_sbr4_top.upf
###   sed -i 's;/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr4_top.upf;/tools/collage/work/upf/outputs/pcie_upf/sbr_config_ipxact_chs_sbr4_top.upf;g' parpxpd.upf
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/pcie_upf
###   
###   setenv ENABLE_SLP_RUN 0
###   echo  "\n --->--> Merging parpxpa.upf  ...." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpa.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpa.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   echo  "\n --->--> Merging parpxpb.upf  ...." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpb.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpb.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   echo  "\n --->--> Merging parpxpc.upf  ...." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpc.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpc.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   echo  "\n --->--> Merging parpxpd.upf  ...." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpd.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpd.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   echo  "\n --->--> Merging parpxpe.upf  ...." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parpxpe.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parpxpe.tcl -inc_file -tag sim |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Move the merge files to merge files
###   cp parpxpa.sim.upf parpxpa.merged.upf
###   cp parpxpb.sim.upf parpxpb.merged.upf
###   cp parpxpc.sim.upf parpxpc.merged.upf
###   cp parpxpd.sim.upf parpxpd.merged.upf
###   cp parpxpe.sim.upf parpxpe.merged.upf
###   
###   sed -i '/parpxpa.inc.sim.tcl/d' parpxpa.merged.upf
###   sed -i '/parpxpb.inc.sim.tcl/d' parpxpb.merged.upf
###   sed -i '/parpxpc.inc.sim.tcl/d' parpxpc.merged.upf
###   sed -i '/parpxpd.inc.sim.tcl/d' parpxpd.merged.upf
###   sed -i '/parpxpe.inc.sim.tcl/d' parpxpe.merged.upf
###   
###   ## -- Copy inc file for DC/SLP SBE assertion insertion removal
###   foreach instance (parpxpa parpxpb parpxpc parpxpd parpxpe)
###       cp ${instance}.inc.sim.tcl ${instance}.inc.impl.tcl
###       sed -i '/sbebase\/sbcport\/enp/d' ${instance}.inc.impl.tcl
###       sed -i '/sbebase\/sbcport\/epc/d' ${instance}.inc.impl.tcl
###       sed -i '/sbebase\/sbcport\/inp/d' ${instance}.inc.impl.tcl
###       sed -i '/sbebase\/sbcport\/ipc/d' ${instance}.inc.impl.tcl
###   end
###   
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/parpxpa.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/parpxpa.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/parpxpa.inc.sim.tcl\n}\n" if $. == 2' parpxpa.merged.upf
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/parpxpb.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/parpxpb.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/parpxpb.inc.sim.tcl\n}\n" if $. == 2' parpxpb.merged.upf
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/parpxpc.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/parpxpc.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/parpxpc.inc.sim.tcl\n}\n" if $. == 2' parpxpc.merged.upf
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/parpxpd.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/parpxpd.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/parpxpd.inc.sim.tcl\n}\n" if $. == 2' parpxpd.merged.upf
###   perl -pi -e 'print "if { \[ info exists \:\:env\(ENABLE_SLP_RUN\) \] } {\n source \$::env(UPF_INSTALL_DIR)/parpxpe.inc.impl.tcl\n} elseif {[info exists synopsys_program_name] && (\$synopsys_program_name == \"dc_shell\")} {\n source \$::env(UPF_INSTALL_DIR)/parpxpe.inc.impl.tcl\n} else {\n source \$::env(UPF_INSTALL_DIR)/parpxpe.inc.sim.tcl\n}\n" if $. == 2' parpxpe.merged.upf
###   
###   cp -f parpxpa.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parpxpa.inc.sim.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpa.inc.impl.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpb.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parpxpb.inc.sim.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpb.inc.impl.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpc.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parpxpc.inc.sim.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpc.inc.impl.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpd.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parpxpd.inc.sim.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpd.inc.impl.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpe.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parpxpe.inc.sim.tcl $COLLAGE_WORK/upf/outputs
###   cp -f parpxpe.inc.impl.tcl $COLLAGE_WORK/upf/outputs
###   
###   cd $COLLAGE_WORK/upf/outputs
###   #CK rm -rf $COLLAGE_WORK/upf/outputs/pcie_upf
###   
###   unsetenv ENABLE_SLP_RUN
###   unsetenv IP_ROOT
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARSSATA
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARSSATA ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Copy over SSATA UPF as it needs to be cleaning up before merging
###   cd $COLLAGE_WORK/upf/outputs
###   if (-d ssata_upf) then
###       rm -rf ssata_upf
###   endif
###   mkdir ssata_upf
###   cd ssata_upf
###   
###   cp -f -R $MODEL_ROOT/subIP/sip/ssata/tools/upf/* .
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/ssata_upf
###   dos2unix sata.upf
###   
###   sed -i 's;info exists $env(ACE_RTL_SIM);info exists ::env(ACE_RTL_SIM);g' sata.upf
###   cp -f $COLLAGE_WORK/upf/outputs/parssata* .
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/ssata/tools/upf/sata.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/ssata_upf/sata.upf;g' parssata.upf
###   sed -i 's;${UPF_INSTALL_DIR}/parssata_set_voltage.tcl;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/parssata_set_voltage.tcl;g' parssata.upf
###   
###   setenv IP_ROOT ${MODEL_ROOT}/subIP/sip/ssata/tools/upf/spt
###   
###   ## -- Enable the run Spyglass-LP
###   setenv SPYGLASS_LP_RUN 1
###   setenv ENABLE_SLP_RUN 1
###   echo "--->---> sub processing PARSSATA .... Running for Spyglass ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parssata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parssata.tcl  -inc_file -tag slp -set_vars "synopsys_program_name junk" |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv SPYGLASS_LP_RUN
###   unsetenv ENABLE_SLP_RUN
###   
###   setenv SPYGLASS_LP_RUN 0
###   setenv ENABLE_SLP_RUN 0
###   echo "--->---> sub processing PARSSATA .... Running for VCS/DC ....." |& tee -a ${LOG_FILE_LOCATION}
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parssata.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parssata.tcl  -inc_file -tag impl -set_vars "synopsys_program_name dc_shell" |& tee -a ${LOG_FILE_LOCATION}
###   unsetenv SPYGLASS_LP_RUN
###   unsetenv ENABLE_SLP_RUN
###   unsetenv IP_ROOT
###   
###   ## --- parssata.slp.upf and parssata.impl.upf should be identical except the include. Keeping one
###   cp -f parssata.impl.upf parssata.merged.upf
###   rm -f parssata.impl.upf
###   rm -f parssata.slp.upf
###   
###   
###   ## --- Add if...else for selection between Spyglass and Implementation including VCS-NLP
###   sed -i '/^source \$::env(UPF_INSTALL_DIR)\/parssata.inc.impl.tcl/d' parssata.merged.upf
###   
###   sed '1r '"${MODEL_ROOT}"'/tools/upf/scripts/parssata.selection.txt' parssata.merged.upf > parssata.merged.upf.tmp
###   mv parssata.merged.upf.tmp parssata.merged.upf
###   
###   ## -- Replacing ./ as this is an issue in the PSF UPF files. This will not exist in 0.7R release.
###   sed -i 's;\.\/;;g' parssata.merged.upf
###   sed -i 's;\.\/;;g' parssata.inc.slp.tcl
###   sed -i 's;\.\/;;g' parssata.inc.impl.tcl
###   
###   ## Replace isolation control signal having DOT to SLASH (REVIEW and file a bug)_
###   ## sed -i 's#parssata_pwell_wrapper/st2/sata_sip_core_aon1.vpunit_wrapper1.st_pg0_isol_en_b#parssata_pwell_wrapper/st2/sata_sip_core_aon1/vpunit_wrapper1/st_pg0_isol_en_b#g' parssata.merged.upf
###   
###   sed -i '/host_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parssata.merged.upf
###   
###   ## Workaround for an issue with vectors in retention paths in SSATA UPF - 0.8
###   cp -f parssata.inc.slp.tcl parssata.inc.impl.tcl
###   
###   cp -f parssata.merged.upf $COLLAGE_WORK/upf/outputs
###   cp -f parssata.inc.*.tcl $COLLAGE_WORK/upf/outputs
###   
###   
###   cd $COLLAGE_WORK/upf/outputs
###   #CK rm -rf $COLLAGE_WORK/upf/outputs/ssata_upf
###   
###   sed -i '/fscan_byplatrst_b\>/d' parssata.inc.*.tcl
###   
###   
###   ##------------------------------------------------------------------##
###   
###   setenv UPF_INSTALL_DIR ${MODEL_ROOT}//tools/collage/work/upf/outputs
###   
###   

###   
###   
###   ##------------------------------------------------------------------##
###   
###   setenv UPF_INSTALL_DIR ${MODEL_ROOT}//tools/collage/work/upf/outputs
###   
###   ##------------------------------------------------------------------##
###   ## PARCAM
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARCAM ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## -- Copy over CAM UPF as it needs to be cleaning up before merging
###   cd $COLLAGE_WORK/upf/outputs
###   if (-d cam_upf) then
###       rm -rf cam_upf
###   endif
###   mkdir cam_upf
###   cd cam_upf
###   
###   cp -f -R $MODEL_ROOT/subIP/sip/campipe/tools/upf/* .
###   
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/cam_upf
###   sed -i '/tools\/upf\/soc_upf/a\set CIO2_UPF_ROOT_DIR '"$MODEL_ROOT"'/tools/collage/work/upf/outputs/cam_upf' cio2_top.upf
###   
###   cp -f $COLLAGE_WORK/upf/outputs/parcam.upf .
###   cp -f $COLLAGE_WORK/upf/outputs/parcam_set_voltage.tcl .
###   
###   sed -i 's#'"${MODEL_ROOT}"'/subIP/sip/campipe/tools/upf/cio2_top.upf#'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/cam_upf/cio2_top.upf#' parcam.upf
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parcam.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parcam.tcl -set_vars "POWER_SWITCH_CELL b05pwb00ud0b0" |& tee -a ${LOG_FILE_LOCATION}
###   ## -- Fix host_powergood mapping to dsw. This needs to be fixed in the model
###   ## sed -i 's;vccdsw_1p0;vnnprim;g' parcam.merged.upf
###   
###   sed -i 's/pmc_cam_fetn_en_b/pmc_cam_fet_en_b/g' parcam.merged.upf
###   sed -i '/parcam_pwell_wrapper\/cio2_top1\/ $/d' parcam.merged.upf
###   ## -- Change SLASH to DOT
###   sed -i 's#/m32kB#.m32kB#g' parcam.merged.upf
###   
###   ## -- Workaround DA# 973880
###   sed -i 's;sbcidbit_dw0\*;sbcidbit_dw0\[\*\]\*\/\*\/\*;g' parcam.merged.upf
###   sed -i 's;sbcidbit_dw1\*;sbcidbit_dw1\[\*\]\*\/\*\/\*;g' parcam.merged.upf
###   
###   
###   cp -f parcam.merged.upf $COLLAGE_WORK/upf/outputs/.
###   rm -rf $MODEL_ROOT//tools/collage/work/upf/outputs/cam_upf
###   
###   cd $COLLAGE_WORK/upf/outputs
###   ##------------------------------------------------------------------##
###   
###   ##------------------------------------------------------------------##
###   ## PARRTC
###   ##------------------------------------------------------------------##
###   ##------------------------------------------------------------------##
###   ## Special handling of parrtc level shifters
###   ## 1. Signals pmcrtc_ldo_pwrok and pmcrtc_ldo_regen are connected as follows:
###   ## pmcrtcunit_wrapper1 pmcrtc_ldo_pwrok - - - c71p8avrdswvrtop1 i_powerok - - -
###   ## pmcrtcunit_wrapper1 pmcrtc_ldo_regen - - - c71p8avrdswvrtop1 i_regen - - -
###   ## DSW  VR IP Owner stated that these signals have been handled inside the circuit therefore require no LS in PARRTC
###   ## Refer to email from Vishal Sharma
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARRTC ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   ##+++++++++++++++++++++++++++++++++++++++##
###   ## -- Removing level shifters between RTC and DSWVR 
###   ## -- Checked with Vishal Sharma and the understanding is that DSWVR can take in vccrtcwell 1.11 on 
###   ## pmcrtc_ldo_pwrok and pmcrtc_ldo_regen
###   sed -i '/^set PD_RTC_PARRTC_PD_PARRTC_RTCWELL_WRAPPER_TO_C71P8AVRDSWVRTOP1_VCCRTCWELL1P5_HV_VCCDSW_3P3_LS_PINS/{N;N;N;N;d}' parrtc_pd_rtc_output_ls_pins.tcl
###   sed -i '/^set_level_shifter "pd_rtc_parrtc_pd_parrtc_rtcwell_wrapper_to_c71p8avrdswvrtop1_vccrtcwell1p5_ehv_vccdsw_3p3_ls"/{N;N;N;N;N;N;N;N;N;N;d}' parrtc.upf
###   
###   
###   ## Modify set_related_supply for these ports to map to rtc voltage rail
###   sed -i '/pmcrtc_dswldo_pwrok/{s/vccdsw_3p3/vccrtcwell1p5_ehv/}' parrtc_set_voltage.tcl
###   sed -i '/pmcrtc_dswldo_regen/{s/vccdsw_3p3/vccrtcwell1p5_ehv/}' parrtc_set_voltage.tcl
###   
###   sed -i '/create_supply_net -domain "pd_rtc_parrtc_pd" "vccdsw_3p3"/d' parrtc.upf
###   sed -i '/create_supply_port -domain "pd_rtc_parrtc_pd" -direction "in" "vccdsw_3p3"/d' parrtc.upf
###   sed -i '/connect_supply_net "vccdsw_3p3" -ports "vccdsw_3p3"/d' parrtc.upf
###   
###   
###   ## -- Take this port from pch UPF as well. Discussion on going. Need closure.
###   ## -- Before making changes - make a copy
###   if (! -e pch.upf.bak) then
###   	cp -f pch.upf pch.upf.bak
###   endif
###   
###   sed -i '/parrtc\/vccdsw_3p3/d' pch.upf
###   sed -i '/pardfx\/vccrtcwell1p5_ehv/d' pch.upf
###   sed -i '/parscc\/vccrtcwell1p5_ehv/d' pch.upf
###   sed -i '/parleg\/vccrtcwell1p5_ehv/d' pch.upf
###   
###   ## TEMPORARY - Remove following partitions
###   sed -i '/parcam/d' pch.upf
###   ## sed -i '/pardsp/d' pch.upf
###   ##+++++++++++++++++++++++++++++++++++++++##
###   ## Remove unwanted lines  from pch.upf
###   # set VCCPDSW_3P3_UHV_PORTS {
###   #  parrtc/vccpdsw_3p3_uhv
###   #  vccpdsw_3p3_uhv
###   #}
###   #connect_supply_net "vccpdsw_3p3_uhv" -ports ${VCCPDSW_3P3_UHV_PORTS}
###   sed -i '/set VCCPDSW_3P3_UHV_PORTS/d' pch.upf
###   sed -i '/parrtc\/vccpdsw_3p3_uhv/d' pch.upf
###   sed -i '/  vccpdsw_3p3_uhv/,+2 d' pch.upf
###   
###   
###   
###   
###   
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parrtc.upf -config $MODEL_ROOT/tools/upf/scripts/munge_upf_parrtc.cfg -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## Change SRSN for the intermediate LS inserted in PARLEG
###   echo "\n --->---> Generating intermediate LS ..."  |& tee -a ${LOG_FILE_LOCATION}
###   ${MUNGE_SCRIPT_ROOT}/munge_upf.tcl -upf parrtc.munged.upf -config $MODEL_ROOT/tools/upf/scripts/parrtc_insert_intermediate_ls.tcl -verbose |& tee -a ${LOG_FILE_LOCATION}
###   
###   sed -i 's#"vccio_1p05" N/A#"vccio_1p05" -min 0.89 0.89#g' parrtc.munged.munged.upf
###   
###   ##------------------------------------------------------------------##
###   ## PARXHCIA
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARXHCIA ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   setenv IP_ROOT $MODEL_ROOT
###   setenv SIP_VARIATION .
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcia.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcia.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   sed -i 's/vccio_1p05/vnnprim/g' parxhcia.merged.upf
###   
###   ## -- Move the domain connections to accommodate the changes needed to gated supplies
###   sed -n '/Begin merged ungated domains/,/End merged ungated domains/p' parxhcia.merged.upf > parxhcia.csn.txt
###   sed -i '/Begin merged ungated domains/,/End merged ungated domains/d' parxhcia.merged.upf
###   sed -i '/Overridden PST from merge_upf/r ./parxhcia.csn.txt' parxhcia.merged.upf
###   rm -f parxhcia.csn.txt
###   
###   ## -- Take all vnnprim_gated2 supplies and move them such that they do not appear before declaration
###   grep 'connect_supply_net "vnnprim_rf_gated2"' parxhcia.merged.upf > parxhcia.csn.txt
###   sed -i '/connect_supply_net "vnnprim_rf_gated2"/d' parxhcia.merged.upf
###   sed -i '/Insert rf_gated connections using this tag/r ./parxhcia.csn.txt' parxhcia.merged.upf
###   rm -f parxhcia.csn.txt
###   
###   ## -- Remove PGD rails from places where they are not relevant.
###   ## -- This is a limitation in merge upf script
###   ##
###   ## -- remove rf_gated2 from all domains except RF2 PGD as defined by IP
###   ## sed -i '/"parxhcia_pwell_wrapper_usbx_usb3_com1_pd_rf_gated1" "vnnprim_rf_gated1" -reuse/d' parxhcia.merged.upf
###   sed -i '/"pd_pwell_parxhcia_pd_XHCIA_PGD" "vnnprim_rf_gated1" -resolve "parallel"/d' parxhcia.merged.upf
###   sed -i '/"parxhcia_pwell_wrapper_usbx_usb3_com1_pd_rf_gated2" "vnnprim_rf_gated1" -resolve "parallel"/d' parxhcia.merged.upf
###   ##
###   ## -- remove rf_gated2 from all domains except RF2 PGD as defined by IP
###   ## sed -i '/"pd_pwell_parxhcia_pd_XHCIA_PGD" "vnnprim_rf_gated2" -reuse/d' parxhcia.merged.upf
###   sed -i '/"pd_pwell_parxhcia_pd_XHCIA_PGD" "vnnprim_rf_gated2" -resolve "parallel"/d' parxhcia.merged.upf
###   sed -i '/"vnnprim_rf_gated2" -domain "pd_pwell_parxhcia_pd" -resolve "parallel"/d' parxhcia.merged.upf
###   sed -i '/"parxhcia_pwell_wrapper_usbx_usb3_com1_pd_rf_gated1" "vnnprim_rf_gated2" -resolve "parallel"/d' parxhcia.merged.upf
###   ##
###   ## -- Replaced the gated supply with the port at partition
###   ## Need to discuss with Giri
###   sed -i 's#vnnprim_gated1#pd_pwell_parxhcia_pd_XHCIA_PGD_vnnprim_gated#g' parxhcia.merged.upf
###   
###   ## -- remove following temporarily to make progress - 0.8
###   ## -- remove following temporarily to make progress - 0.8
###   sed -i '/set_level_shifter "pd_pwell_parxhcia_pd_pch_to_gpcom1unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;N;N;N;N;N;N;N;N;N;d}' parxhcia.merged.upf
###   sed -i '/set_level_shifter "pd_pwell_parxhcia_pd_c71p8rtctop1_to_exi_core1_vccrtcwell1p5_ehv_vnnprim_ls"/{N;N;N;N;N;N;N;N;N;N;N;d}' parxhcia.merged.upf
###   sed -i '/vccrtcwell1p5_ehv/d' parxhcia.merged.upf
###   sed -i '/exi_pgcb_rst_b/{s/vccrtcwell1p5_ehv/vnnprim/g}' parxhcia.merged.upf
###   sed -i '/vccprtc_3p3/d' parxhcia.merged.upf
###   sed -i '/map_isolation_cell "parxhcia_pwell_wrapper_sip_mmp_d_cluster_top1_core_well_clamp1"/{N;N;s/b05ani02u/b05ori02u/g}' parxhcia.merged.upf
###   
###   ##------------------------------------------------------------------##
###   ## PARXHCIB
###   ##------------------------------------------------------------------##
###   echo  "\n ---> Processing PARXHCIB ...." |& tee -a ${LOG_FILE_LOCATION}
###   
###   echo  "\n --->--> Sub Processing SBR ...." |& tee -a ${LOG_FILE_LOCATION}
###   setenv IP_ROOT $MODEL_ROOT
###   cd $COLLAGE_WORK/upf/outputs
###   if (-d sbr_upf) then
###       rm -rf sbr_upf
###   endif
###   mkdir sbr_upf
###   chmod -R 755 sbr_upf
###   cd sbr_upf
###   
###   ## -- Processing SBR router IP UPF for paths that do not scale to FC
###   cp -fR $MODEL_ROOT/subIP/sip/sbr/tools/upf/router/* .
###   sed -i 's;../../../../tools/upf/router;$::env{COLLAGE_WORK}/upf/outputs/sbr_upf;g' sbr_config_ipxact_chs_sbr5_top.upf
###   
###   ## -- Copy the contents of PARFIA to local directory to adjust hierarchy paths
###   cp -f $MODEL_ROOT/tools/upf/soc_upf.cfg .
###   cp -f $COLLAGE_WORK/upf/outputs/parxhcib* .
###   cp -f $COLLAGE_WORK/upf/outputs/upf_global_defs.tcl .
###   
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/sbr/tools/upf/router/sbr_config_ipxact_chs_sbr5_top.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/sbr_upf/sbr_config_ipxact_chs_sbr5_top.upf;g' parxhcib.upf
###   
###   ## -- since IP_ROOT is set to MODEL_ROOT need to re-calibrate USBX
###   cp -fR $MODEL_ROOT/subIP/sip/usb3/tools/upf/SPTLP/xdci_upf/* .
###   sed -i 's#$::env(SIP_VARIATION)/##g' XDCI.upf
###   sed -i 's;'"${MODEL_ROOT}"'/subIP/sip/usb3/tools/upf/SPTLP/xdci_upf/XDCI.upf;'"${MODEL_ROOT}"'/tools/collage/work/upf/outputs/sbr_upf/XDCI.upf;g' parxhcib.upf
###   
###   chmod -R 755 $COLLAGE_WORK/upf/outputs/sbr_upf
###   
###   ${MERGE_SCRIPT_ROOT}/merge_upf.tcl -upf parxhcib.upf -verbose -config $MODEL_ROOT/tools/upf/scripts/merge_upf_config_parxhcib.tcl  |& tee -a ${LOG_FILE_LOCATION}
###   
###   ## Substitute vnnprim for vccio_1p05 for all signals SRSN that are from the PHY
###   ## Signals are from JTAG family which has a bug that will be addressed in 1.0
###   sed -i 's/vccio_1p05/vnnprim/g' parxhcib.merged.upf
###   
###   cp -f parxhcib.merged.upf $COLLAGE_WORK/upf/outputs/.
###   
###   rm -rf $COLLAGE_WORK/upf/outputs/sbr_upf
###   
###   unsetenv IP_ROOT
###   unsetenv SIP_VARIATION
###   
###   cd $COLLAGE_WORK/upf/outputs
###   
###   ##---------------------------------------------------------------------##
###   ## Special handling for LPSS, PCIE, OPI, ISH, GBE
###   ## as host_pwrgood_rst_b has multi fanout and used by multiple IP's.
###   ## All of these IP's have vccdsw_1p0 which should not be used.
###   ## Working with Collage team to clean this up.
###   ##---------------------------------------------------------------------##
###   echo  "\n ---> Processing LPSS, PCIE, OPI, ISH, GBE for host_pwrgood_rst_b vccdsw_1p0 association. (REMOVE REMOVE, REMOVE)" |& tee -a ${LOG_FILE_LOCATION}
###   sed -i 's/vccdsw_1p0/vnnprim/g' parlpss.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' pardmi.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parish.merged.munged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' pargbe.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parpxpa.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parpxpb.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parpxpc.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parpxpd.merged.upf
###   sed -i 's/vccdsw_1p0/vnnprim/g' parpxpe.merged.upf
###   
###   
###   ##---------------------------------------------------------------------##
###   ## Comment out for UPF debug
###   ##---------------------------------------------------------------------##
###   ## rm -f *.upf_flat.upf
###   ##---------------------------------------------------------------------##
###   
###   ##---------------------------------------------------------------------##
###   ## Special handling of all level shifters in UNKNOWN domain inside spt_io_wrapper.upf file
###   ## This section needs to be reviewed again and removed
###   ## Doing it using brute force way as this code needs to be removed
###   ##---------------------------------------------------------------------##
###   
###   echo  "\n ---> Processing SPT_IO_WRAPPER ..." |& tee -a ${LOG_FILE_LOCATION}
###   cd ${COLLAGE_WORK}/upf/outputs
###   
###   sed -i '/UNKNOWN_pmcpspdrfunit_wrapper1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_pmc_pwell1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_hda1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_pmcpspdrfunit_wrapper1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_pmc_pwell1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_hda1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_mst_dfx_core1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_exi_core1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpgpiodswfamily1_to_exi_core1_vccdsw_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_cltap_wrapper1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_mst_dfx_core1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_exi_core1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_csmeb1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_parcsmeb_scanunit_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_cltap_wrapper1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_mst_dfx_core1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_csmeb1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_exi_core1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8opitop8pfamilyns1_vccf100oc_1p0_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8sptlpclkdis_repeaterhda2top1_to_c71p8pllhdafamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8mphyhyb16familyew1_to_isclk1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_iccunit1_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterhda1top1_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top1_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8atstop1_to_tr_top1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   
###   sed -i '/UNKNOWN_tr_top1_to_c71p8atstop1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_trigger_bscan_block1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_trigger_bscan_block1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_preqbrdyb_bscan_block1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpjtagfamily1_to_preqbrdyb_bscan_block1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8sptlpclkdis_repeaterhda2top1_to_c71p8pllhdafamily1_vnnprim_vccaazpll_1p0_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_clt_dfx_core14_parxhcia_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_parxhcia_scanunit_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_sbr6_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_cltap_wrapper1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_usbx_usb3_com1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8sptlpclkdis_repeaterusbse1top1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_mst_dfx_core1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_usbx_dev_com1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_parxhcia_scanunit_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_clt_dfx_core14_parxhcia_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_sbr6_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_usbx_usb3_com1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_dfx_plmb3_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_usbx_dev_com1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8mphyhyb16familyew1_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8giosptlpcpufamily1_to_cltap_wrapper1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8mphyhyb16familyew1_to_c71p8opitop8pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_csmeb1_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_gpcom0unit_wrapper1_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8sptlpclkdis_repeaterusbse1top5_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top3_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top5_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top2_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top4_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_sbr5_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8usbtop10pfamilyns1_to_sbr5_vccio_1p05_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_pch_to_c71p8mphyhyb16familyew1_vccrtcwell1p5_ehv_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_pch_to_c71p8rtctop1_vccrtcwell1p5_ehv_vccprtc_3p3_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   ## updated by RNAZIR
###   sed -i '/io_rtcwell_wrapper\/c71p8rtctop1\/vss/d' spt_io_wrapper.upf 
###   
###   sed -i '/UNKNOWN_pch_to_isclk1_vnnprim_vcc24ns_1p0_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_isclk1_to_pch_vccf24_1p0_vnnprim_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_pmc_pwell1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   sed -i '/UNKNOWN_c71p8mphyhyb16familyew1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls/{N;N;N;N;N;N;N;N;N;N;d}' spt_io_wrapper.upf
###   
###   
###   
###   ## -- Now insert comments into the file as a reminder
###   echo "\n\n ## Special comments as a reminder. These lines have been removed to enable VCS-NLP elaboration\n" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8mphyhyb16familyew1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pmc_pwell1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pch_to_c71p8mphyhyb16familyew1_vccrtcwell1p5_ehv_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pch_to_c71p8rtctop1_vccrtcwell1p5_ehv_vccprtc_3p3_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pch_to_isclk1_vnnprim_vcc24ns_1p0_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_pch_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pmcpspdrfunit_wrapper1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_sbr5_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_sbr5_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_pmc_pwell1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_hda1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_pmcpspdrfunit_wrapper1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_pmc_pwell1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_hda1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_mst_dfx_core1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_exi_core1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpgpiodswfamily1_to_exi_core1_vccdsw_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_cltap_wrapper1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_mst_dfx_core1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_exi_core1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_csmeb1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_parcsmeb_scanunit_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_cltap_wrapper1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_mst_dfx_core1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_csmeb1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_exi_core1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8opitop8pfamilyns1_vccf100oc_1p0_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8sptlpclkdis_repeaterhda2top1_to_c71p8pllhdafamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8mphyhyb16familyew1_to_isclk1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_iccunit1_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterhda1top1_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top1_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8atstop1_to_tr_top1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_tr_top1_to_c71p8atstop1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_trigger_bscan_block1_to_c71p8giosptlpcpufamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_trigger_bscan_block1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_preqbrdyb_bscan_block1_to_c71p8giosptlpjtagfamily1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpjtagfamily1_to_preqbrdyb_bscan_block1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8sptlpclkdis_repeaterhda2top1_to_c71p8pllhdafamily1_vnnprim_vccaazpll_1p0_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_clt_dfx_core14_parxhcia_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_parxhcia_scanunit_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_sbr6_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_cltap_wrapper1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_usbx_usb3_com1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8sptlpclkdis_repeaterusbse1top1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_mst_dfx_core1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_usbx_dev_com1_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_parxhcia_scanunit_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_clt_dfx_core14_parxhcia_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_sbr6_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_usbx_usb3_com1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_dfx_plmb3_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_usbx_dev_com1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8mphyhyb16familyew1_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8giosptlpcpufamily1_to_cltap_wrapper1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8mphyhyb16familyew1_to_c71p8opitop8pfamilyns1_vnnprim_vccio_1p05_ls">> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8usbtop10pfamilyns1_to_csmeb1_vccio_1p05_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_gpcom0unit_wrapper1_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_c71p8sptlpclkdis_repeaterusbse1top5_to_c71p8usbtop10pfamilyns1_vnnprim_vccio_1p05_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top3_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top5_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top2_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   echo "## set_level_shifter UNKNOWN_isclk1_to_c71p8sptlpclkdis_repeaterusbse1top4_vccf24_1p0_vnnprim_ls" >> spt_io_wrapper.upf |& tee -a ${LOG_FILE_LOCATION}
###   
###   
###   ## -- Remove source of tcl files associated with level shifter pins
###   sed -i '/spt_io_wrapper_c71p8atstop1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8giosptlpcpufamily1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8giosptlpcpufamily1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8giosptlpgpiodswfamily1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8giosptlpjtagfamily1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8giosptlpjtagfamily1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8opitop8pfamilyns1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8pllhdafamily1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_isclk1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_isclk1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8atstop1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8usbtop10pfamilyns1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8usbtop10pfamilyns1_output_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8mphyhyb16familyew1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   sed -i '/spt_io_wrapper_c71p8rtctop1_input_ls_pins.tcl/d' spt_io_wrapper.upf
###   
###   ## -- Special handling to remove the additional power domain created for fuse_array_top
###   ## This is not needed but is created by Collage as fuse_array_top is defined inside pwell
###   
###   sed -i '/create_power_domain "pd_pwell_spt_io_wrapper_pd"/d' spt_io_wrapper.upf
###   sed -i '/create_supply_net  -domain "pd_pwell_spt_io_wrapper_pd"/d' spt_io_wrapper.upf
###   sed -i '/set_domain_supply_net "pd_pwell_spt_io_wrapper_pd"/{N;N;N;d}' spt_io_wrapper.upf
###   
###   ##------------------------------------------------------------------------------------##
###   ## PCH
###   ## Add vccio_1p05 rails to PARLEG and PARRTC as they are needed for intermediate LS insertion
###   ##------------------------------------------------------------------------------------##
###   ## Do not add if already present
###   grep -q "parleg/vccio_1p05" pch.upf
###   if ($? == 1) then
###       sed -i 's#spt_io_wrapper/vccio_1p05#spt_io_wrapper/vccio_1p05\n  parleg/vccio_1p05\n  parrtc/vccio_1p05#g' pch.upf
###   endif
###   
###   ##------------------------------------------------------------------------------------##
###   ## -- Final cleanup and moving of files to central area
###   set CENTRAL_AREA = "${MODEL_ROOT}/source/gen/upf/fc_par"
###   echo "---> UPF Merging Complete. Moving files to central area (${CENTRAL_AREA}..." |& tee -a ${LOG_FILE_LOCATION}
###   echo "but first we pwd so here goes"
###   pwd
###   echo "done pwding"
###   
###   if (-d $CENTRAL_AREA) then
###       rm -rf $CENTRAL_AREA
###   endif
###   mkdir ${CENTRAL_AREA}
###   
###   cp -f parfia.upf $CENTRAL_AREA/parfia.upf
###   cp -f parfia_set_voltage.tcl $CENTRAL_AREA/parfia_set_voltage.tcl
###   sed -i 's;vccdsw_1p0;vnnprim;g' $CENTRAL_AREA/parfia_set_voltage.tcl
###   
###   cp -f pargbe.merged.upf $CENTRAL_AREA/pargbe.upf
###   
###   cp -f paricc.upf $CENTRAL_AREA/paricc.upf
###   
###   cp -f paricc_set_voltage.tcl $CENTRAL_AREA/paricc_set_voltage.tcl
###   
###   cp -f parcam.merged.upf $CENTRAL_AREA/parcam.upf
###   sed -i 's;vccdsw_1p0;vnnprim;g' $CENTRAL_AREA/parcam.upf
###   
###   cp -f parcsmea.merged.upf $CENTRAL_AREA/parcsmea.upf
###   cp -f parcsmea.miarf.inc.tcl $CENTRAL_AREA/parcsmea.miarf.inc.tcl
###   
###   cp -f parcsmeb.merged.upf $CENTRAL_AREA/parcsmeb.upf
###   cp -f parcsmeb.inc.sim.tcl $CENTRAL_AREA/parcsmeb.inc.sim.tcl
###   cp -f parcsmeb.inc.slp.tcl $CENTRAL_AREA/parcsmeb.inc.slp.tcl
###   cp -f parcsmeb.inc.dc.tcl $CENTRAL_AREA/parcsmeb.inc.dc.tcl
###   
###   cp -f pardfx.merged.munged.upf $CENTRAL_AREA/pardfx.upf
###   cp -f pardfx.merged.upf $CENTRAL_AREA/pardfx.upf
###   
###   cp -f pardsp.merged.upf $CENTRAL_AREA/pardsp.upf
###   sed -i 's;vccdsw_1p0;vnnprim;g' $CENTRAL_AREA/pardsp.upf
###   
###   cp -f parish.merged.munged.upf $CENTRAL_AREA/parish.upf
###   
###   cp -f parleg.merged.slp.upf  $CENTRAL_AREA/parleg.slp.upf
###   cp -f parleg.merged.slp.tcl $CENTRAL_AREA/parleg.merged.slp.tcl
###   cp -f parleg.merged.impl.upf $CENTRAL_AREA/parleg.upf
###   cp -f parleg.merged.impl.tcl $CENTRAL_AREA/parleg.merged.impl.tcl
###   
###   cp -f parlpss.merged.upf $CENTRAL_AREA/parlpss.upf
###   
###   cp -f pardmi.merged.upf $CENTRAL_AREA/pardmi.upf
###   cp -f pardmi.inc.sim.tcl $CENTRAL_AREA/pardmi.inc.sim.tcl
###   cp -f pardmi.inc.impl.tcl $CENTRAL_AREA/pardmi.inc.impl.tcl
###   
###   cp -f parpsf1.merged.upf $CENTRAL_AREA/parpsf1.upf
###   cp -f parpsf1.inc.slp.tcl $CENTRAL_AREA/parpsf1.inc.slp.tcl
###   cp -f parpsf1.inc.impl.tcl $CENTRAL_AREA/parpsf1.inc.impl.tcl
###   
###   cp -f parpsf2.merged.upf $CENTRAL_AREA/parpsf2.upf
###   cp -f parpsf2.inc.slp.tcl $CENTRAL_AREA/parpsf2.inc.slp.tcl
###   cp -f parpsf2.inc.impl.tcl $CENTRAL_AREA/parpsf2.inc.impl.tcl
###   
###   cp -f parpsf3.merged.upf $CENTRAL_AREA/parpsf3.upf
###   cp -f parpsf3.inc.slp.tcl $CENTRAL_AREA/parpsf3.inc.slp.tcl
###   cp -f parpsf3.inc.impl.tcl $CENTRAL_AREA/parpsf3.inc.impl.tcl
###   
###   cp -f parpxpa.merged.upf $CENTRAL_AREA/parpxpa.upf
###   cp -f parpxpa.inc.sim.tcl $CENTRAL_AREA/parpxpa.inc.sim.tcl
###   cp -f parpxpa.inc.impl.tcl $CENTRAL_AREA/parpxpa.inc.impl.tcl
###   cp -f parpxpb.merged.upf $CENTRAL_AREA/parpxpb.upf
###   cp -f parpxpb.inc.sim.tcl $CENTRAL_AREA/parpxpb.inc.sim.tcl
###   cp -f parpxpb.inc.impl.tcl $CENTRAL_AREA/parpxpb.inc.impl.tcl
###   cp -f parpxpc.merged.upf $CENTRAL_AREA/parpxpc.upf
###   cp -f parpxpc.inc.sim.tcl $CENTRAL_AREA/parpxpc.inc.sim.tcl
###   cp -f parpxpc.inc.impl.tcl $CENTRAL_AREA/parpxpc.inc.impl.tcl
###   cp -f parpxpd.merged.upf $CENTRAL_AREA/parpxpd.upf
###   cp -f parpxpd.inc.sim.tcl $CENTRAL_AREA/parpxpd.inc.sim.tcl
###   cp -f parpxpd.inc.impl.tcl $CENTRAL_AREA/parpxpd.inc.impl.tcl
###   cp -f parpxpe.merged.upf $CENTRAL_AREA/parpxpe.upf
###   cp -f parpxpe.inc.sim.tcl $CENTRAL_AREA/parpxpe.inc.sim.tcl
###   cp -f parpxpe.inc.impl.tcl $CENTRAL_AREA/parpxpe.inc.impl.tcl
###   
###   cp -f parrtc.munged.munged.upf $CENTRAL_AREA/parrtc.upf
###   
###   
###   cp -f parsata.merged.upf $CENTRAL_AREA/parsata.upf
###   cp -f parsata.inc.impl.tcl $CENTRAL_AREA/parsata.inc.impl.tcl
###   cp -f parsata.inc.slp.tcl $CENTRAL_AREA/parsata.inc.slp.tcl
###   
###   cp -f parxhcia.merged.upf $CENTRAL_AREA/parxhcia.upf
###   sed -i 's;vccdsw_1p0;vnnprim;g' $CENTRAL_AREA/parxhcia.upf
###   
###   cp -f parxhcib.merged.upf $CENTRAL_AREA/parxhcib.upf
###   sed -i 's;vccdsw_1p0;vnnprim;g' $CENTRAL_AREA/parxhcib.upf
###   
###   cp -f parscc.merged.upf $CENTRAL_AREA/parscc.upf
###   
###   cp -f pch.upf $CENTRAL_AREA/pch.upf
###   
###   cp -f spt_io_wrapper.upf $CENTRAL_AREA/spt_io_wrapper.upf
###   cp -f spt_io_wrapper_*.tcl $CENTRAL_AREA/.
###   cp -f upf_global_defs.tcl $CENTRAL_AREA/upf_global_defs.tcl
###   
###   ## -- Change the path to SRAM CSN due to SOC DFX wrapper instantiation at FC
###   ## Taking out till co-location wrapper make it into the 0.7R model
###   echo "Run SRAM path morphing script .... " |& tee -a ${LOG_FILE_LOCATION}
###   ${MODEL_ROOT}/tools/upf/scripts/morph_sram_dfx_paths.pl
###   
###   ##------------------------------------------------------------------------------------##
###   ## Special handling for c71p8pllhda HIP UPF
###   ## $MODEL_ROOT/upf path is used in the top level which does not work SPT
###   ## Below process copies the UPF and changes the path
###   ##------------------------------------------------------------------------------------##
###   #echo "---> Processing c71p8pllhdafamily ..." |& tee -a ${LOG_FILE_LOCATION}
###   #cd ${MODEL_ROOT}/source/gen/upf/hip_power_pins/c71p8pllhdafamily/
###   
###   #if (-d upf) then
###   #    rm -rf upf
###   #endif
###   #mkdir upf
###   #cd upf
###   
###   #cp -f $MODEL_ROOT/subIP/hip/IDGz_HIP_HDPLL_c71p8pllhdafamily/rtl/upf/* .
###   #chmod -R 755 ${MODEL_ROOT}/source/gen/upf/hip_power_pins/c71p8pllhdafamily/upf
###   
###   #sed -i 's;\$env(MODEL_ROOT)/upf/c71phda00_c71p8adpll_digtop.upf;\$env(MODEL_ROOT)/source/gen/upf/hip_power_pins/c71p8pllhdafamily/upf/c71phda00_c71p8adpll_digtop.upf;g' c71p8pllhdafamily.upf
###   
###   #cd ${CENTRAL_AREA}
###   #sed -i 's;'"${MODEL_ROOT}"'/subIP/hip/IDGz_HIP_HDPLL_c71p8pllhdafamily/rtl/upf/c71p8pllhdafamily.upf;'"${MODEL_ROOT}"'/source/gen/upf/hip_power_pins/c71p8pllhdafamily/upf/c71p8pllhdafamily.upf;g' spt_io_wrapper.upf
###   #sed -i '/pardfx\/vccrtcwell1p5_ehv/d' pch.upf
###   #sed -i '/parrtc\/vccdsw_3p3/d' pch.upf
###   
###   echo "about to cp parleg"
###   ## -- Additional steps for PARLEG due to SBE simulation only retention 
###   cp -f parleg.upf parleg.dc.upf
###   cp -f parleg.merged.impl.tcl parleg.merged.dc.tcl
###   sed -i 's/parleg.merged.impl.tcl/parleg.merged.dc.tcl/g' parleg.dc.upf
###   
###   sed -i '/sbebase\/sbcport\/ipc/d' parleg.merged.dc.tcl
###   sed -i '/sbebase\/sbcport\/inp/d' parleg.merged.dc.tcl
###   sed -i '/sbebase\/sbcport\/epc/d' parleg.merged.dc.tcl
###   sed -i '/sbebase\/sbcport\/enp/d' parleg.merged.dc.tcl
###   
###   ## -- This could be a bug in merge script - need to check UPF merge
###   sed -i 's/-threshold 0.0/-threshold 0.05/g'  parleg.upf
###   sed -i 's/-threshold 0.0/-threshold 0.05/g'  parleg.dc.upf
###   sed -i 's/-threshold 0.0/-threshold 0.05/g'  parleg.slp.upf
###   
###   ## -- Remove till bump list gets fixed by Rima for 0.8
###   ## -- These isolations should not exist 
###   sed -i '/set_level_shifter "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;N;N;d}' parleg.upf
###   sed -i '/set_level_shifter "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;N;N;d}' parleg.dc.upf
###   sed -i '/set_level_shifter "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;N;N;d}' parleg.slp.upf
###   sed -i '/map_level_shifter_cell "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;d}' parleg.upf
###   sed -i '/map_level_shifter_cell "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;d}' parleg.dc.upf
###   sed -i '/map_level_shifter_cell "pd_pwell_parleg_pd_pch_to_gpcom0unit_wrapper1_vccprtc_3p3_vnnprim_ls"/{N;N;N;d}' parleg.slp.upf
###   sed -i '/vccprtc_3p3/d' parleg.upf
###   sed -i '/vccprtc_3p3/d' parleg.dc.upf
###   sed -i '/vccprtc_3p3/d' parleg.slp.upf
###   
###   sed -i '/parleg\/vccprtc_3p3/d' pch.upf
###   sed -i '/parxhcia\/vccprtc_3p3/d' pch.upf
###   sed -i '/parxhcia\/vccrtcwell1p5_ehv/d' pch.upf
###   
###   ## -- This needs to be fixed by splitting the signals per power well
###   ## -- (REVIEW and REMOVE)
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parscc.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parcsmea.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' pardfx.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parfia.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parpsf1.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parpsf2.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parpsf3.upf
###   sed -i '/pri_powergood_rst_b_1/{s/vccdsw_1p0/vnnprim/g}' parsata.upf
###   
###   ## -- Adding more to the list. This needs to be fixed. Cannot keep on putting a patch
###   sed -i '/pnb_fdfx_powergood/{s/vccdsw_1p0/vnnprim/g}' parsata.upf
###   
###   ##------------------------------------------------------------------------------------##
###   echo "back to parent directory"
###   ## -- Back to parent directory
###   cd ${COLLAGE_WORK}/upf/outputs

endofscript:


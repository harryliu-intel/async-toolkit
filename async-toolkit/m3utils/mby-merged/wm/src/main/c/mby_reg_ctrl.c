/* vim:ts=4:sw=4:expandtab
 * (No tabs, indent level is 4 spaces)  */
/*****************************************************************************
 * Copyright (c) 2018, Intel Corporation
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *     * Redistributions of source code must retain the above copyright notice,
 *       this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Intel Corporation nor the names of its contributors
 *       may be used to endorse or promote products derived from this software
 *       without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*****************************************************************************/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdint.h>
#include <time.h>
#include <unistd.h>
#include <errno.h>
#include <ctype.h>

#include "mby_model.h"

// For MBY_FFU_HASH_CAM
#include <mby_classifier.h>

typedef struct _fm_mbyRegisterDefault
{
    /* Mask to be applied to register address. */
    fm_uint32   addrMask;

    /* Expected result of applying addrMask to the register address. If
     * result matches, then this table entry applies to the register. */
    fm_uint32   addrResult;

    /* Default value for this word */
    fm_uint32   def;

} fm_mbyRegisterDefault;

static const fm_mbyRegisterDefault mbyRegisterDefaultTable[] =
{
/*   addrMask    addrResult  default         name [word] */
// Auto generated reg defaults begin
    {0xFFFFFFFF, 0x00000018, 0x0000FFFF}, /* CG_ENABLE [0] */
    {0xFFFFFFFF, 0x00000410, 0x0000AE22}, /* VITAL_PRODUCT_DATA [0] */
    {0xFFFFFFFF, 0x00000448, 0x0000001F}, /* LSM_IM [0] */
    {0xFFFFFFFF, 0x00000458, 0x00000E4F}, /* LSM_CFG [0] */
    {0xFFFFFFFF, 0x00000620, 0x00000001}, /* BSM_STOP [0] */
    {0xFFFFFFFF, 0x00040018, 0x00020311}, /* BSM_CODE_CONFIG [0] */
    {0xFFFFFFFF, 0x00040028, 0x00020311}, /* BSM_SCRATCH_CONFIG [0] */
    {0xFFFFFFFF, 0x00040038, 0x00020311}, /* IMN_CDC_SIDE_SWITCH_INT_CONFIG [0] */
    {0xFFFFFFFF, 0x00040048, 0x00020311}, /* IMN_CDC_SIDE_SWITCH_MGMT_CONFIG [0] */
    {0xFFFFFFFF, 0x00040058, 0x00020311}, /* IMN_CDC_SWITCH_SIDE_INT_CONFIG [0] */
    {0xFFFFFFFF, 0x00040068, 0x00020311}, /* IMN_CDC_SWITCH_SIDE_MGMT_CONFIG [0] */
    {0xFFE3FFFF, 0x00400020, 0x00000001}, /* MSEC_IM [0] */
    {0xFFE3FFFF, 0x00409448, 0x00000004}, /* MSEC_GLOBAL_VERSION [0] */
    {0xFFE3FFFF, 0x00409450, 0x01000001}, /* MSEC_GLOBAL_CIPH_ID [0] */
    {0xFFE3FFFF, 0x00409454, 0x0080C200}, /* MSEC_GLOBAL_CIPH_ID [1] */
    {0xFFE3FFFF, 0x00409458, 0x00000001}, /* MSEC_GLOBAL_SW_RESET [0] */
    {0xFFE3DFFF, 0x00410010, 0x00000001}, /* MSEC_TX_LANE_SC0_SA0_CONFID [0] */
    {0xFFE3DFFF, 0x004100A0, 0x00000001}, /* MSEC_TX_LANE_SC0_SA0_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00410110, 0x00000001}, /* MSEC_TX_LANE_SC0_SA1_CONFID [0] */
    {0xFFE3DFFF, 0x004101A0, 0x00000001}, /* MSEC_TX_LANE_SC0_SA1_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00410210, 0x00000001}, /* MSEC_TX_LANE_SC0_SA2_CONFID [0] */
    {0xFFE3DFFF, 0x004102A0, 0x00000001}, /* MSEC_TX_LANE_SC0_SA2_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00410310, 0x00000001}, /* MSEC_TX_LANE_SC0_SA3_CONFID [0] */
    {0xFFE3DFFF, 0x004103A0, 0x00000001}, /* MSEC_TX_LANE_SC0_SA3_NEXT_PN [0] */
    {0xFFE3FFFF, 0x00419408, 0x00004000}, /* MSEC_TX_MAX_PCKT_BYTES [0] */
    {0xFFE3FFFF, 0x00419418, 0x00000001}, /* MSEC_TX_JIT_WM [0] */
    {0xFFE3FFFF, 0x00419480, 0xC0000000}, /* MSEC_TX_PN_LIMIT [0] */
    {0xFFE3FFFF, 0x00419494, 0x00000100}, /* MSEC_TX_DBG [1] */
    {0xFFE3FFFF, 0x004194C0, 0x70000007}, /* MSEC_TX_DBG_PTI [0] */
    {0xFFE3DFFF, 0x004200A0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA0_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004200A8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA0_MIN_PN [0] */
    {0xFFE3DFFF, 0x004200B0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA0_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004200B8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA0_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x004201A0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA1_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004201A8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA1_MIN_PN [0] */
    {0xFFE3DFFF, 0x004201B0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA1_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004201B8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA1_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x004202A0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA2_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004202A8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA2_MIN_PN [0] */
    {0xFFE3DFFF, 0x004202B0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA2_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004202B8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA2_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x004203A0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA3_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004203A8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA3_MIN_PN [0] */
    {0xFFE3DFFF, 0x004203B0, 0x00000001}, /* MSEC_RX_LANE_SC0_SA3_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004203B8, 0x00000001}, /* MSEC_RX_LANE_SC0_SA3_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x004208A0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA0_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004208A8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA0_MIN_PN [0] */
    {0xFFE3DFFF, 0x004208B0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA0_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004208B8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA0_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x004209A0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA1_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004209A8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA1_MIN_PN [0] */
    {0xFFE3DFFF, 0x004209B0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA1_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x004209B8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA1_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x00420AA0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA2_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00420AA8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA2_MIN_PN [0] */
    {0xFFE3DFFF, 0x00420AB0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA2_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00420AB8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA2_UPDATE_MIN_PN [0] */
    {0xFFE3DFFF, 0x00420BA0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA3_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00420BA8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA3_MIN_PN [0] */
    {0xFFE3DFFF, 0x00420BB0, 0x00000001}, /* MSEC_RX_LANE_SC1_SA3_UPDATE_NEXT_PN [0] */
    {0xFFE3DFFF, 0x00420BB8, 0x00000001}, /* MSEC_RX_LANE_SC1_SA3_UPDATE_MIN_PN [0] */
    {0xFFE3FFFF, 0x00429484, 0x00000100}, /* MSEC_RX_DBG [1] */
    {0xFFE3FFFF, 0x004294C0, 0x50000005}, /* MSEC_RX_DBG_PTI [0] */
    {0xFFE3FFFF, 0x00400118, 0x00020311}, /* MSEC_STAT_MEM1_CONFIG [0] */
    {0xFFE3FFFF, 0x00400128, 0x00020311}, /* MSEC_STAT_MEM2_CONFIG [0] */
    {0xFFFE0FFF, 0x00600010, 0xFFFFFFFF}, /* MAC_IM [0] */
    {0xFFFE0FFF, 0x00600014, 0x00000007}, /* MAC_IM [1] */
    {0xFFFE0FFF, 0x00600018, 0xFA082800}, /* MAC_CFG [0] */
    {0xFFFE0FFF, 0x00600028, 0x00020000}, /* MAC_STATUS [0] */
    {0xFFFE0FFF, 0x0060003C, 0x0000000C}, /* MAC_TX_MII_CFG [1] */
    {0xFFFE0FFF, 0x00600040, 0x00004000}, /* MAC_TX_PATH_CFG [0] */
    {0xFFFE0FFF, 0x00600074, 0x0000E400}, /* MAC_RX_PARSER_CFG_2 [1] */
    {0xFFFE3FFF, 0x00600410, 0x00000001}, /* MAC4_IM [0] */
    {0xFFFE3FFF, 0x00600430, 0x00020311}, /* MAC4_STATS_FULL_RX_CONFIG [0] */
    {0xFFFE3FFF, 0x00600450, 0x00020311}, /* MAC4_STATS_FULL_TX_CONFIG [0] */
    {0xFFFE3FFF, 0x00600470, 0x00020311}, /* MAC4_STATS_SNAP_RX_CONFIG [0] */
    {0xFFFE3FFF, 0x00600490, 0x00020311}, /* MAC4_STATS_SNAP_TX_CONFIG [0] */
    {0xFFFE3FFF, 0x00600800, 0x00BF0000}, /* SIA_RX_Q_BOUNDS0 [0] */
    {0xFFFE3FFF, 0x00600808, 0x017F00C0}, /* SIA_RX_Q_BOUNDS1 [0] */
    {0xFFFE3FFF, 0x00600810, 0x023F0180}, /* SIA_RX_Q_BOUNDS2 [0] */
    {0xFFFE3FFF, 0x00600818, 0x02FF0240}, /* SIA_RX_Q_BOUNDS3 [0] */
    {0xFFFE3FFF, 0x00600820, 0x03BF0300}, /* SIA_RX_Q_BOUNDS4 [0] */
    {0xFFFE3FFF, 0x00600828, 0x047F03C0}, /* SIA_RX_Q_BOUNDS5 [0] */
    {0xFFFE3FFF, 0x00600830, 0x053F0480}, /* SIA_RX_Q_BOUNDS6 [0] */
    {0xFFFE3FFF, 0x00600838, 0x05FF0540}, /* SIA_RX_Q_BOUNDS7 [0] */
    {0xFFFE3FFF, 0x00600840, 0x0005C0B8}, /* SIA_RX_Q_CFG [0] */
    {0xFFFE3FFF, 0x00600960, 0x00000008}, /* SIA_RX_TAP_PORT_CFG [0] */
    {0xFFFE3FFF, 0x006009A8, 0x00000003}, /* SIA_RX_IARB_TOKEN_RATE [0] */
    {0xFFFE3FFF, 0x006009B0, 0xAAAA5555}, /* SIA_RX_SCRATCH [0] */
    {0xFFFE3FFF, 0x00600A00, 0xA5000000}, /* SIA_TX_PORT_CTL [0] */
    {0xFFFE3FFF, 0x00600AC0, 0x00000142}, /* SIA_TX_CONTROL [0] */
    {0xFFFE3FFF, 0x00600AD8, 0x007FFFFF}, /* SIA_IM [0] */
    {0xFFFE3FFF, 0x00600C18, 0x00020311}, /* SIA_QRAM_CONFIG [0] */
    {0xFFFE3FFF, 0x00600C28, 0x00020311}, /* SIA_RXRAM_CONFIG [0] */
    {0xFFFE3FFF, 0x00600C38, 0x00020311}, /* SIA_TXMETARAM_CONFIG [0] */
    {0xFFFE3F87, 0x00600D00, 0x00020311}, /* SIA_TXRAM_CONFIG [0] */
    {0xFFFFFFFF, 0x02001210, 0x00000001}, /* PARSER_IM [0] */
    {0xFFFFF007, 0x02002000, 0xFFFF0000}, /* PARSER_KEY_W [0] */
    {0xFFFFF007, 0x02002004, 0xFFFF0000}, /* PARSER_KEY_W [1] */
    {0xFFFFF007, 0x02003000, 0xFFFF0000}, /* PARSER_KEY_S [0] */
    {0xFFFFFFE7, 0x02010040, 0x00020311}, /* PA_PKT_META_FIFO_CONFIG [0] */
    {0xFFFFFF07, 0x02010200, 0x00020311}, /* PA_SEG_DATA_FIFO0_CONFIG [0] */
    {0xFFFFFF07, 0x02010500, 0x00020311}, /* PA_SEG_DATA_FIFO1_CONFIG [0] */
    {0xFFFFFFFF, 0x02010608, 0x00020311}, /* PA_SEG_META_FIFO_CONFIG [0] */
    {0xFFFFFFFF, 0x02010618, 0x00020311}, /* PA_TAIL_INFO_FIFO_CONFIG [0] */
    {0xFFFFFFFF, 0x02010628, 0x00020311}, /* PARSER_NH_CFG_CONFIG [0] */
    {0xFFCC000F, 0x03000000, 0xFFFFFFFF}, /* FFU_TCAM [0] */
    {0xFFCC000F, 0x03000004, 0x000000FF}, /* FFU_TCAM [1] */
    {0xFFCC000F, 0x03000008, 0xFFFFFFFF}, /* FFU_TCAM [2] */
    {0xFFCC000F, 0x0300000C, 0x000000FF}, /* FFU_TCAM [3] */
    {0xFFCFE007, 0x03080004, 0x000FFFFC}, /* FFU_TCAM_CFG [1] */
    {0xFFFFFFFF, 0x03751880, 0x000024FB}, /* FWD_HASHING_CFG [0] */
    {0xFFFFF807, 0x03780800, 0x000000FF}, /* MAP_PORT_DEFAULT [0] */
    {0xFFFFFFC7, 0x03781000, 0xFFE1FFFF}, /* MAP_DGLORT_TCAM [0] */
    {0xFFFFFFC7, 0x03781004, 0x0000003F}, /* MAP_DGLORT_TCAM [1] */
    {0xFFFF000F, 0x03790000, 0xFFFFFFFF}, /* MAP_DOMAIN_TCAM [0] */
    {0xFFFF000F, 0x03790004, 0x00000003}, /* MAP_DOMAIN_TCAM [1] */
    {0xFFFF000F, 0x03790008, 0xFFFFFFFF}, /* MAP_DOMAIN_TCAM [2] */
    {0xFFFF000F, 0x0379000C, 0x00000003}, /* MAP_DOMAIN_TCAM [3] */
    {0xFFFFFC07, 0x037B8400, 0xFFFFFFFF}, /* MAP_SCEN_KEY0 [0] */
    {0xFFFFFC07, 0x037B8404, 0x0FFFFFFF}, /* MAP_SCEN_KEY0 [1] */
    {0xFFFFFC07, 0x037B8800, 0xFFFFFFFF}, /* MAP_SCEN_KEY_INVERT0 [0] */
    {0xFFFFFC07, 0x037B8804, 0x0FFFFFFF}, /* MAP_SCEN_KEY_INVERT0 [1] */
    {0xFFFFFC07, 0x037B8C00, 0xFFFFFFFF}, /* MAP_SCEN_KEY1 [0] */
    {0xFFFFFC07, 0x037B8C04, 0x0FFFFFFF}, /* MAP_SCEN_KEY1 [1] */
    {0xFFFFFC07, 0x037B9000, 0xFFFFFFFF}, /* MAP_SCEN_KEY_INVERT1 [0] */
    {0xFFFFFC07, 0x037B9004, 0x0FFFFFFF}, /* MAP_SCEN_KEY_INVERT1 [1] */
    {0xFFFFF3FF, 0x037C0018, 0x00020311}, /* FFU_HASH_CFG_CONFIG [0] */
    {0xFFFFF3F7, 0x037C0030, 0x00020311}, /* FFU_HASH_LOOKUP_CONFIG [0] */
    {0xFFFFF3F7, 0x037C0050, 0x00020311}, /* FFU_HASH_MISS_CONFIG [0] */
    {0xFFFFF3F7, 0x037C0070, 0x00020311}, /* FFU_KEY_MASK0_CONFIG [0] */
    {0xFFFFF3F7, 0x037C0090, 0x00020311}, /* FFU_KEY_MASK1_CONFIG [0] */
    {0xFFFFF3F7, 0x037C00B0, 0x00020311}, /* FFU_KEY_MASK2_CONFIG [0] */
    {0xFFFFE707, 0x037D0200, 0x00020311}, /* FFU_ACTION_CONFIG [0] */
    {0xFFFFE707, 0x037D0500, 0x00020311}, /* FFU_TCAM_CONFIG [0] */
    {0xFFFFE787, 0x037D0700, 0x00020311}, /* FFU_TCAM_CFG_CONFIG [0] */
    {0xFFFFFFFF, 0x037E2018, 0x00020311}, /* DOMAIN_ACTION0_CONFIG [0] */
    {0xFFFFFFFF, 0x037E2028, 0x00020311}, /* DOMAIN_ACTION1_CONFIG [0] */
    {0xFFFFFFFF, 0x037E2038, 0x00020311}, /* FFU_TCAM_SWP_CONFIG [0] */
    {0xFFFFFE07, 0x037E2400, 0x00020311}, /* HASH_ENTRY_CONFIG [0] */
    {0xFFFFFFC7, 0x037E2680, 0x00020311}, /* MAP_DOMAIN_CONFIG [0] */
    {0xFFFFFFF7, 0x037E26D0, 0x00020311}, /* MAP_DSCP_TC_CONFIG [0] */
    {0xFFF80007, 0x03900000, 0x00000F80}, /* MA_AGING_TABLE [0] */
    {0xFFFFFFFF, 0x03986400, 0xFFFFFFFF}, /* MA_TABLE_AGING_CFG [0] */
    {0xFFFFFFFF, 0x03986404, 0x0000FFFF}, /* MA_TABLE_AGING_CFG [1] */
    {0xFFFFFFFF, 0x03986418, 0x00FFFFFF}, /* ENTRY_COUNT_IM [0] */
    {0xFFFFFFFF, 0x03986430, 0x0000000F}, /* MA_SWEEP_CTL [0] */
    {0xFFFFFFFF, 0x03986450, 0x00000001}, /* MA_TCAM_ERR_IM [0] */
    {0xFFFFFE07, 0x03A18400, 0xFFFFFFFF}, /* GLORT_CAM [0] */
    {0xFFFFFF07, 0x03A23500, 0x0000FFFF}, /* CM_APPLY_LOOPBACK_SUPPRESS [0] */
    {0xFFFFFFFF, 0x03A23918, 0x00000001}, /* CM_APPLY_CPU_TRAP_MASK [0] */
    {0xFFFF80FF, 0x03A30000, 0x12AAAAAA}, /* TRIGGER_CONDITION_CFG [0] */
    {0xFFFF80FF, 0x03A30004, 0x00000003}, /* TRIGGER_CONDITION_CFG [1] */
    {0xFFFF80FF, 0x03A30008, 0x0FE00000}, /* TRIGGER_CONDITION_PARAM [0] */
    {0xFFFF80FF, 0x03A30068, 0x01000000}, /* TRIGGER_ACTION_DMASK [0] */
    {0xFFFFFFF7, 0x03A380D0, 0xFFFFFFFF}, /* TRIGGER_IM [0] */
    {0xFFFFFFF7, 0x03A380D4, 0x0000FFFF}, /* TRIGGER_IM [1] */
    {0xFFFFFFFF, 0x03A380E0, 0x0000FFFF}, /* TRIGGER_RATE_LIM_EMPTY [0] */
    {0xFFFFF007, 0x03A40000, 0x00FFFFFF}, /* FWD_PORT_CFG_2 [0] */
    {0xFFFFFF07, 0x03A41100, 0x03FFFFFF}, /* FWD_PORT_CFG_1 [0] */
    {0xFFFFFFFF, 0x03A41200, 0x0000001F}, /* FWD_SYS_CFG_1 [0] */
    {0xFFFFFFFF, 0x03A41230, 0xAAAAAAAA}, /* FWD_IEEE_RESERVED_MAC_ACTION [0] */
    {0xFFFFFFFF, 0x03A41234, 0xAAAAAAAA}, /* FWD_IEEE_RESERVED_MAC_ACTION [1] */
    {0xFFFFFFFF, 0x03A41238, 0xAAAAAAAA}, /* FWD_IEEE_RESERVED_MAC_ACTION [2] */
    {0xFFFFFFFF, 0x03A4123C, 0xAAAAAAAA}, /* FWD_IEEE_RESERVED_MAC_ACTION [3] */
    {0xFFFFFFFF, 0x03A41370, 0x0000001F}, /* FWD_IM [0] */
    {0xFFFFFFFF, 0x03A41390, 0x00000001}, /* FWD_MA_TABLE_DIRTY_IM [0] */
    {0xFFFFFFF7, 0x03A50020, 0x00020311}, /* ARP_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50038, 0x00020311}, /* ARP_USED_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50048, 0x00020311}, /* EGRESS_MST_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50058, 0x00020311}, /* EGRESS_VID_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50068, 0x00020311}, /* FLOOD_GLORT_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50078, 0x00020311}, /* FWDPORT_CFG2_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50088, 0x00020311}, /* GLORT_DEST_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A50098, 0x00020311}, /* INGRESS_MST_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A500A8, 0x00020311}, /* INGRESS_VID_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A500B8, 0x00020311}, /* MA_AGING_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x03A500C8, 0x00020311}, /* MA_DIRTY_TABLE_CONFIG [0] */
    {0xFFFFFF87, 0x03A50180, 0x00020311}, /* MA_TABLE_HASH_CONFIG [0] */
    {0xFFFFFFF7, 0x03A50210, 0x00020311}, /* MA_TABLE_RAM_CONFIG [0] */
    {0xFFFFFFE7, 0x03A50260, 0x00020311}, /* MA_TABLE_TCAM_CONFIG [0] */
    {0xFFFFFF07, 0x03EA0000, 0x00300000}, /* POL_CFG [0] */
    {0xFFFFFFFF, 0x03F00208, 0x00000003}, /* TAIL_IM [0] */
    {0xFFFFFFFF, 0x03F00818, 0x00020311}, /* POL_DECIS_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00828, 0x00020311}, /* POL_DSCP_CFG_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00838, 0x00020311}, /* POL_IN_EARLY_CONFIG [0] */
    {0xFFFFFF87, 0x03F00900, 0x00020311}, /* POL_STATE_CONFIG [0] */
    {0xFFFFFFE7, 0x03F009C0, 0x00020311}, /* RX_STATS_BANK_BYTE_CONFIG [0] */
    {0xFFFFFFE7, 0x03F00A20, 0x00020311}, /* RX_STATS_BANK_FRAME_CONFIG [0] */
    {0xFFFFFFC7, 0x03F00AC0, 0x00020311}, /* RX_STATS_BANK_VLAN_BYTE_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00B08, 0x00020311}, /* RX_STATS_BANK_VLAN_BYTE_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00B18, 0x00020311}, /* RX_STATS_BANK_VLAN_BYTE_ECC_CONFIG [0] */
    {0xFFFFFFC7, 0x03F00B80, 0x00020311}, /* RX_STATS_BANK_VLAN_FRAME_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00BC8, 0x00020311}, /* RX_STATS_BANK_VLAN_FRAME_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00BD8, 0x00020311}, /* RX_STATS_BANK_VLAN_FRAME_ECC_CONFIG [0] */
    {0xFFFFFFFF, 0x03F00BE8, 0x00020311}, /* SAF_HEAD_CACHE_CONFIG [0] */
    {0xFFFFFF07, 0x04118500, 0x0000000A}, /* MOD_PER_PORT_CFG2 [0] */
    {0xFFFFFFE7, 0x04118800, 0x00008100}, /* MOD_VLAN_ETYPE [0] */
    {0xFFFFFE07, 0x04118E00, 0xFFFFFFFF}, /* MOD_DOMAIN_TCAM_KEY [0] */
    {0xFFFFFE07, 0x04118E04, 0x00000003}, /* MOD_DOMAIN_TCAM_KEY [1] */
    {0xFFFFFE07, 0x0411A200, 0xFFFF0000}, /* MOD_DGLORT_MAP [0] */
    {0xFFFFFFFF, 0x0411C088, 0x88478848}, /* MOD_MPLS_STACK_ET [0] */
    {0xFFFFFFFF, 0x0411C08C, 0x00000003}, /* MOD_MPLS_STACK_ET [1] */
    {0xFFFFFFFF, 0x0411C090, 0x080086DD}, /* MOD_MPLS_RESTORE_ET [0] */
    {0xFFFFFFFF, 0x0411C094, 0x00000002}, /* MOD_MPLS_RESTORE_ET [1] */
    {0xFFFFFFFF, 0x04120210, 0xFFFFFFFF}, /* MOD_IM [0] */
    {0xFFFFFFFF, 0x04120214, 0x0000001F}, /* MOD_IM [1] */
    {0xFFFFFFFF, 0x04FFF018, 0x00020311}, /* MOD_AQM_PROFILE_CONFIG [0] */
    {0xFFFFFF87, 0x04FFF100, 0x00020311}, /* MOD_DESC_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF188, 0x00020311}, /* MOD_DS_EXP_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF198, 0x00020311}, /* MOD_DSCP_MAP_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1A8, 0x00020311}, /* MOD_MASTER_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1B8, 0x00020311}, /* MOD_MCAST_VLAN_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1C8, 0x00020311}, /* MOD_MIRROR_PROFILE_TABLE2_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1D8, 0x00020311}, /* MOD_PER_PORT_CFG1_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1E8, 0x00020311}, /* MOD_PER_PORT_CFG2_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF1F8, 0x00020311}, /* MOD_STATS_BANK_BYTE_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF208, 0x00020311}, /* MOD_STATS_BANK_FRAME_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF218, 0x00020311}, /* MOD_VID1_MAP_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF228, 0x00020311}, /* MOD_VID2_MAP_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF238, 0x00020311}, /* MOD_VLAN_TAG_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF248, 0x00020311}, /* MOD_VPRI1_MAP_CONFIG [0] */
    {0xFFFFFFFF, 0x04FFF258, 0x00020311}, /* MOD_VPRI2_MAP_CONFIG [0] */
    {0xFFFFFFF7, 0x05000020, 0x00020311}, /* EARB_FIXED_SCHEDULE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000038, 0x00020311}, /* ESCHED_CFG1_CONFIG [0] */
    {0xFFFFFFFF, 0x05000048, 0x00020311}, /* ESCHED_CFG2_CONFIG [0] */
    {0xFFFFFFFF, 0x05000058, 0x00020311}, /* ESCHED_DC_CONFIG [0] */
    {0xFFFFFFFF, 0x05000068, 0x00020311}, /* ESCHED_PTR_CONFIG [0] */
    {0xFFFFFFFF, 0x05000078, 0x00020311}, /* MON_DRR_CFG_PERPORT_CONFIG [0] */
    {0xFFFFFFFF, 0x05000088, 0x00020311}, /* MON_DRR_DC_PERQ_CONFIG [0] */
    {0xFFFFFFFF, 0x05000098, 0x00020311}, /* MON_DRR_PEP_PERPORT_CONFIG [0] */
    {0xFFFFFFFF, 0x050000A8, 0x00020311}, /* MON_DRR_Q_PERQ_CONFIG [0] */
    {0xFFFFFFC7, 0x05000100, 0x00020311}, /* MON_ERL_CFG_CONFIG [0] */
    {0xFFFFFF87, 0x05000200, 0x00020311}, /* REFCNT_TXFREE_CNT_CONFIG [0] */
    {0xFFFFFFFF, 0x05000288, 0x00020311}, /* REFCNT_TXFREE_CNT_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000298, 0x00020311}, /* REFCNT_TXFREE_CNT_ECC_CONFIG [0] */
    {0xFFFFFFFF, 0x050002A8, 0x00020311}, /* RXQ_MCAST_DST_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x050002B8, 0x00020311}, /* RXQ_MCAST_LEN_TABLE_CONFIG [0] */
    {0xFFFFFFFF, 0x050002C8, 0x00020311}, /* RXQ_MCAST_OUT_FIFO_CONFIG [0] */
    {0xFFFFFF87, 0x05000380, 0x00020311}, /* RXQ_ST_DATA_CONFIG [0] */
    {0xFFFFFFFF, 0x05000408, 0x00020311}, /* RXQ_ST_DATA_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000418, 0x00020311}, /* RXQ_ST_DATA_ECC_CONFIG [0] */
    {0xFFFFFFFF, 0x05000428, 0x00020311}, /* RXQ_ST_LINK_CONFIG [0] */
    {0xFFFFFF87, 0x05000500, 0x00020311}, /* SSCHED_LINK_STORAGE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000588, 0x00020311}, /* SSCHED_LINK_STORAGE_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000598, 0x00020311}, /* SSCHED_LINK_STORAGE_ECC_CONFIG [0] */
    {0xFFFFFF87, 0x05000680, 0x00020311}, /* SSCHED_SOP_STORAGE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000708, 0x00020311}, /* SSCHED_SOP_STORAGE_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000718, 0x00020311}, /* SSCHED_SOP_STORAGE_ECC_CONFIG [0] */
    {0xFFFFFFC7, 0x05000780, 0x00020311}, /* TXQ_HEAD_PERQ_CONFIG [0] */
    {0xFFFFFF87, 0x05000880, 0x00020311}, /* TXQ_PLINK_STATE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000908, 0x00020311}, /* TXQ_PLINK_STATE_CACHE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000918, 0x00020311}, /* TXQ_PLINK_STATE_ECC_CONFIG [0] */
    {0xFFFFFFFF, 0x05000928, 0x00020311}, /* TXQ_PTOT_STATE_CONFIG [0] */
    {0xFFFFFFFF, 0x05000938, 0x00020311}, /* TXQ_REP_PERQ_CONFIG [0] */
    {0xFFFFFFF7, 0x05000950, 0x00020311}, /* TXQ_TAIL_PERQ_CONFIG [0] */
    {0xFFFFF807, 0x05100000, 0x00007FFF}, /* CM_TX_TC_PRIVATE_WM [0] */
    {0xFFFFF807, 0x05100800, 0x00007FFF}, /* CM_TX_TC_HOG_WM [0] */
    {0xFFFFFE07, 0x05101000, 0x00007FFF}, /* CM_RX_SMP_PRIVATE_WM [0] */
    {0xFFFFFE07, 0x05101200, 0x00007FFF}, /* CM_RX_SMP_HOG_WM [0] */
    {0xFFFFFE07, 0x05101400, 0x3FFFFFFF}, /* CM_RX_SMP_PAUSE_WM [0] */
    {0xFFFFFFC7, 0x05101600, 0x0000021C}, /* CM_SHARED_WM [0] */
    {0xFFFFFFC7, 0x05101700, 0x3FFFFFFF}, /* CM_SOFTDROP_WM [0] */
    {0xFFFFFFF7, 0x05101800, 0x3FFFFFFF}, /* CM_SHARED_SMP_PAUSE_WM [0] */
    {0xFFFFFFFF, 0x05101900, 0x00005E20}, /* CM_GLOBAL_WM [0] */
    {0xFFFFFE07, 0x05101C00, 0x004B0384}, /* CM_AQM_EWMA_CFG [0] */
    {0xFFFFFE07, 0x05101C04, 0x00000010}, /* CM_AQM_EWMA_CFG [1] */
    {0xFFFFFE07, 0x05101E00, 0x00007FFF}, /* CM_AQM_DCTCP_CFG [0] */
    {0xFFFFF807, 0x05103800, 0x00007FFF}, /* CM_TX_TC_NAC_JC_WM [0] */
    {0xFFFFF807, 0x05104000, 0x3FFFFFFF}, /* CM_TX_TC_CPK_WM [0] */
    {0xFFFFFFF7, 0x05104800, 0x3FFFFFFF}, /* CM_RX_SMP_CPK_WM [0] */
    {0xFFFFFFFF, 0x05104900, 0x000109C0}, /* CM_CPK_CGD_DEBOUNCER [0] */
    {0xFFFFFFFF, 0x05104910, 0x000109C0}, /* CM_CPK_TXFC_DEBOUNCER [0] */
    {0xFFFFFFFF, 0x05104930, 0xFFFFFFFF}, /* CM_CPK_CGD_INT_MASK [0] */
    {0xFFFFFFFF, 0x05104934, 0xFFFFFFFF}, /* CM_CPK_CGD_INT_MASK [1] */
    {0xFFFFFE07, 0x05104A00, 0xFFFFFFFF}, /* CM_CPK_CGD_INT_MAP [0] */
    {0xFFFFFE07, 0x05104C00, 0xFFFFFFFF}, /* CM_RX_SIA_CPK_TXFC_MAP [0] */
    {0xFFFFFFF7, 0x05104E00, 0xFFFFFFFF}, /* CM_RX_SMP_CPK_CGD_MAP [0] */
    {0xFFFFFFF7, 0x05104E04, 0xFFFFFFFF}, /* CM_RX_SMP_CPK_CGD_MAP [1] */
    {0xFFFFFFF7, 0x05104F00, 0xFFFFFFFF}, /* CM_RX_SMP_CPK_TXFC_MAP [0] */
    {0xFFFFF807, 0x05105000, 0xFFFFFFFF}, /* CM_TX_TC_CPK_CGD_MAP [0] */
    {0xFFFFF807, 0x05105004, 0xFFFFFFFF}, /* CM_TX_TC_CPK_CGD_MAP [1] */
    {0xFFFFF807, 0x05105800, 0xFFFFFFFF}, /* CM_TX_TC_CPK_TXFC_MAP [0] */
    {0xFFFFFFFF, 0x054E7020, 0x000000FF}, /* RXQ_PRIORITY_CFG [0] */
    {0xFFFFFF07, 0x054E8500, 0x00000032}, /* SSCHED_LOCK_CFG_PERPORT [0] */
    {0xFFFFFF07, 0x054E8800, 0x0000FFFF}, /* ESCHED_CFG_1 [0] */
    {0xFFFFFF07, 0x054E8900, 0x000000FF}, /* ESCHED_CFG_2 [0] */
    {0xFFFFFF07, 0x054E8A00, 0x000000FF}, /* ESCHED_CFG_EN [0] */
    {0xFFFFFF07, 0x054E8D00, 0x00000007}, /* ESCHED_PTR [0] */
    {0xFFFFFF07, 0x054E9104, 0x00020000}, /* ESCHED_NAC_JC_STATE_1 [1] */
    {0xFFFFFF07, 0x054E9204, 0x00020000}, /* ESCHED_NAC_JC_STATE_0 [1] */
    {0xFFFFFF07, 0x054EC000, 0x0000FFFF}, /* MON_DRR_CFG_PERPORT [0] */
    {0xFFFFFF07, 0x054EC400, 0x00000014}, /* MON_ERL_CFG_PERPORT [0] */
    {0xFFFFF807, 0x054ED000, 0xFFFFFFFF}, /* MON_ERL_CFG [0] */
    {0xFFFFF807, 0x054ED004, 0x00001FFF}, /* MON_ERL_CFG [1] */
    {0xFFFFFFFF, 0x054EF010, 0x000001FF}, /* SCHED_IM [0] */
    {0xFFFFFFFF, 0x054F4200, 0x002400F0}, /* EARB_CTRL [0] */
    {0xFFFFFFFF, 0x05800200, 0x00000978}, /* IARB_CTRL [0] */
    {0xFFFFFFF7, 0x05800300, 0x00000005}, /* IARB_PARSER_WINDOW_CFG_PERPORT [0] */
    {0xFFFFFFFF, 0x05800610, 0x00000001}, /* IARB_IM [0] */
// Auto generated reg defaults end
    /* Terminator */
    {0x00000000, 0x00000000, 0x00000000}
};

/*****************************************************************************/
/** isAddrMatched
 * \ingroup intModel
 *
 * \desc            Check if HLP address matches in range of mask and value.
 *
 * \param[in]       addr is the register's address in the HLP register
 *                  space.
 *
 * \param[in]       mask is the mask on address.
 *
 * \param[in]       result is the result to compare too.
 *
 * \return          TRUE if address matches the value.
 * \return          FALSE otherwise
 *
 *****************************************************************************/
static inline fm_bool isAddrMatched(fm_uint32 addr, fm_uint mask, fm_uint result)
{
	if ((addr & mask) == result)
	{
		/* Special case for overlapping addr/mask not capable of
		 * matching the correct entry
		 */
		// TODO still makes sense for MBY at all?
#if 0
		/* 0xFFF3F807, 0x3320000 FFU_HASH_CAM */
		if (((addr & 0xFFF3F800) == MBY_FFU_HASH_CAM(0,0,0,0)) &&
		    (mask != 0xFFF3F807))
		{
			/* matches FFU_HASH_CAM but it is not for
			 * FFU_HASH_CAM entry */
			return FALSE;
		}
#endif
		return TRUE;
	}

	return FALSE;
}

fm_uint32 mbyModelGetRegisterDefault(fm_uint32 addr)
{
    const fm_mbyRegisterDefault *defaults;
    fm_uint32                       rtnValue = 0;

    /**************************************************
     * Search the defaults table to see if this reg
     * has a non-zero default value.
     **************************************************/

    defaults = mbyRegisterDefaultTable;

    while (defaults->addrMask)
    {
        /* Does masked address give the expected result? */
        if (isAddrMatched(addr, defaults->addrMask, defaults->addrResult))
        {
            rtnValue = defaults->def;
            break;
        }

        ++defaults;
    }

    return rtnValue;

}   /* end mbyModelGetRegisterDefault */

static inline fm_uint32 maskLsbOnly(fm_uint32 in)
{
    if (in == 0) return 0;

    fm_uint32 shift = 0;
    fm_uint32 work = in;
    while ((work & 1) == 0)
    {
        ++shift;
        work >>= 1;
    }
    return 1 << shift;
}

void mbyModelLoadDefaults(fm_uint32 regs[MBY_REGISTER_ARRAY_SIZE]) {
    memset(regs, 0, MBY_REGISTER_ARRAY_SIZE*sizeof(fm_uint32));

    const fm_mbyRegisterDefault *defaultPtr = mbyRegisterDefaultTable;

    while (defaultPtr->addrMask)
    {
        /* this contains 1s where the address has "don't care" bits */
        fm_uint32 addrMaskNegHi = ~defaultPtr->addrMask;
        fm_uint32 addrMaskNegLo = maskLsbOnly(addrMaskNegHi);
        /* we increment by this, so make sure it isn't 0 so the loop can terminate */
        if (addrMaskNegLo == 0) addrMaskNegLo = 1;
        for (fm_uint32 d = 0;d <= addrMaskNegHi;d += addrMaskNegLo)
        {
            // TODO see if isAddrMatched should be used (see its TODO)
            fm_uint32 finalAddr = defaultPtr->addrResult + d;
            /* The iteration will do some "illegal" addresses if mask has "gaps", so we need to check */
            if ((finalAddr & defaultPtr->addrMask) == defaultPtr->addrResult)
                regs[finalAddr/4] = defaultPtr->def;
        }

        ++defaultPtr;
    }
}

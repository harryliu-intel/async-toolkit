// Autogenerated Jamon implementation
// C:/Users/mhesseli/Documents/Perforce/rrc-4/reg-main/shared/java/src/./com/fulcrummicro/hw/verification/chip/mgmt/registers/templates/CastMgmtSynth.jamon

package com.fulcrummicro.hw.verification.chip.mgmt.registers.templates;

// 3, 1
import java.lang.Math;
// 4, 1
import java.util.Collection;
// 5, 1
import com.fulcrummicro.util.misc.Utility;
// 6, 1
import com.fulcrummicro.hw.verification.chip.mgmt.registers.*;

public class CastMgmtSynthImpl
  extends com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl
  implements com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtSynth.Intf

{
  private final Collection<RegisterBase> bases;
  private final Collection<Register> regs;
  private final String chip;
  protected static com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtSynth.ImplData __jamon_setOptionalArguments(com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtSynth.ImplData p_implData)
  {
    com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl.__jamon_setOptionalArguments(p_implData);
    return p_implData;
  }
  public CastMgmtSynthImpl(org.jamon.TemplateManager p_templateManager, com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtSynth.ImplData p_implData)
  {
    super(p_templateManager, __jamon_setOptionalArguments(p_implData));
    bases = p_implData.getBases();
    regs = p_implData.getRegs();
    chip = p_implData.getChip();
  }
  
  @Override protected void child_render_2(final java.io.Writer jamonWriter)
    throws java.io.IOException
  {
    // 12, 9
    jamonWriter.write("module chip.");
    // 13, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 13, 23
    jamonWriter.write(".base.register_mgmt_synth;\n\nimport chip.");
    // 15, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 15, 23
    jamonWriter.write(".base.functions.*;\nimport chip.");
    // 16, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 16, 23
    jamonWriter.write(".base.registers.*;\nimport chip.");
    // 17, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 17, 23
    jamonWriter.write(".mgmt.base.MgmtIfCell;\n\nimport chip.");
    // 19, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 19, 23
    jamonWriter.write(".mgmt.channel.IntMgmtGroupChannel;\nimport chip.");
    // 20, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 20, 23
    jamonWriter.write(".mgmt.channel.IntMgmtChannel;\nimport chip.");
    // 21, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 21, 23
    jamonWriter.write(".mgmt.channel.IntMgmtIChannel;\nimport chip.");
    // 22, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 22, 23
    jamonWriter.write(".mgmt.channel.IntMgmtWChannel;\nimport chip.");
    // 23, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 23, 23
    jamonWriter.write(".mgmt.channel.IntMgmtIWChannel;\n\n\n");
    // 34, 1
    for (RegisterBase base : bases )
    {
      // 34, 35
      jamonWriter.write("\n");
      // 35, 1
      for (String group : base.getGroups() )
      {
        // 35, 41
        jamonWriter.write("\n");
        // 36, 1
        
String baseName = base.getName(); if(group != null) baseName += "_" + group.toUpperCase();
String camelCaseBaseName = Utility.underscoreToCamelCase(baseName, true);
int maxAtomicWidth = 1; for(Register reg : base.getRegisters()) {maxAtomicWidth=Math.max(maxAtomicWidth,reg.getAtomicWidth());}
Collection<Register> registers = base.getRegisters("group", group);
int maxSramBits = 1; for(Register reg : registers) {maxSramBits=Math.max(maxSramBits,reg.getImplementationWidth());}
int mgmtDataBits = (group == null) ? 32*maxAtomicWidth : maxSramBits;

        // 43, 9
        jamonWriter.write("define ");
        // 44, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 44, 31
        jamonWriter.write("Management() attributes\n  <+ ");
        // 45, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName(), true)), jamonWriter);
        // 45, 63
        jamonWriter.write("RegisterFields\n");
        // 46, 1
        if (group == null )
        {
          // 46, 22
          for (String g : base.getGroups() )
          {
            // 46, 58
            if (g != null )
            {
              // 46, 75
              jamonWriter.write("  <+ ");
              // 47, 6
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 47, 87
              jamonWriter.write("Management\n");
            }
          }
        }
        // 48, 20
        jamonWriter.write("  <+ AddressSpace <+ MgmtIfCell <+ RegisterFunctions {\n  int ");
        // 50, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 50, 21
        jamonWriter.write("_MGMT_BITS = ");
        // 50, 34
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 50, 52
        jamonWriter.write(";\n  csp {\n");
        // 53, 1
        {
          // 53, 1
          __jamon_innerUnit__registerStructureBase(jamonWriter, registers, camelCaseBaseName );
        }
        // 53, 86
        jamonWriter.write("\n");
        // 54, 1
        if (group == null )
        {
          // 54, 22
          for (String g : base.getGroups() )
          {
            // 54, 58
            if (g != null )
            {
              // 54, 75
              jamonWriter.write("      ");
              // 55, 7
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 55, 88
              jamonWriter.write("Registers ");
              // 55, 98
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g.toLowerCase()), jamonWriter);
              // 55, 119
              jamonWriter.write(";\n");
            }
          }
        }
        // 56, 20
        jamonWriter.write("    );\n\n");
        // 61, 1
        {
          com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam __jamon__var_0 = new com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam(this.getTemplateManager());
          __jamon__var_0.renderNoFlush(jamonWriter, base, registers, camelCaseBaseName );
        }
        // 61, 91
        jamonWriter.write("\n");
        // 64, 1
        for (Register reg : registers )
        {
          // 64, 34
          if (reg.getAlias() == null )
          {
            // 64, 64
            jamonWriter.write("    function is");
            // 65, 16
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 65, 72
            jamonWriter.write("(int(24) -chip_addr) : boolean = (\n      is");
            // 66, 9
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 66, 65
            jamonWriter.write(" = ");
            // 66, 68
            {
              // 66, 68
              __jamon_innerUnit__registerAddressGuardExpr(jamonWriter, reg);
            }
            // 66, 108
            jamonWriter.write("\n    );\n");
          }
        }
        // 68, 14
        jamonWriter.write("\n");
        // 72, 1
        for (Register reg : registers )
        {
          // 72, 34
          if (reg.getAlias() == null )
          {
            // 72, 64
            jamonWriter.write("    function getAtomicWordNumber");
            // 73, 33
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 73, 89
            jamonWriter.write("(int(24) -chip_addr) : int(8) = (\n");
            // 74, 1
            if (reg.getAtomicWidth() >= reg.getEntryWidth() )
            {
              // 74, 52
              jamonWriter.write("      getAtomicWordNumber");
              // 75, 26
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
              // 75, 82
              jamonWriter.write(" = 0\n");
            }
            // 76, 1
            else
            {
              // 76, 8
              jamonWriter.write("      int(4) atomicWordBits = log2(");
              // 77, 36
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 77, 55
              jamonWriter.write("_ATOMIC_WIDTH);\n      int(4) widthBits = log2(");
              // 78, 31
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 78, 50
              jamonWriter.write("_WIDTH);\n      getAtomicWordNumber");
              // 79, 26
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
              // 79, 82
              jamonWriter.write(" = chip_addr{widthBits-1:atomicWordBits}\n");
            }
            // 80, 7
            jamonWriter.write("    );\n");
          }
        }
        // 82, 14
        jamonWriter.write("\n");
        // 86, 1
        for (Register reg : registers )
        {
          // 86, 34
          if ((reg.getAlias() == null) && (reg.getNumEntries() > 1) )
          {
            // 86, 95
            jamonWriter.write("    function getEntryAddress");
            // 87, 29
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 87, 85
            jamonWriter.write("(int(24) -chip_addr) : int(16) = (\n      int(8) entryBits = log2(");
            // 88, 31
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 88, 50
            jamonWriter.write("_ENTRIES");
            // 88, 58
            if (reg.getNumEntries1()>1 )
            {
              // 88, 88
              jamonWriter.write("_0");
            }
            // 88, 96
            jamonWriter.write(");\n      getEntryAddress");
            // 89, 22
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 89, 78
            jamonWriter.write(" = (chip_addr >> log2(");
            // 89, 100
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 89, 119
            jamonWriter.write("_STRIDE");
            // 89, 126
            if (reg.getNumEntries1()>1 )
            {
              // 89, 156
              jamonWriter.write("_0");
            }
            // 89, 164
            jamonWriter.write(")) & ((1<<entryBits) - 1)\n    );\n");
          }
        }
        // 91, 14
        jamonWriter.write("\n");
        // 95, 1
        for (Register reg : registers )
        {
          // 95, 34
          if ((reg.getAlias() == null) && (reg.getNumEntries1() > 1) )
          {
            // 95, 96
            jamonWriter.write("    function getEntry1Address");
            // 96, 30
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 96, 86
            jamonWriter.write("(int(24) -chip_addr) : int(16) = (\n      int(8) entry1Bits = log2(");
            // 97, 32
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 97, 51
            jamonWriter.write("_ENTRIES_1);\n      getEntry1Address");
            // 98, 23
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 98, 79
            jamonWriter.write(" = (chip_addr >> log2(");
            // 98, 101
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 98, 120
            jamonWriter.write("_STRIDE_1)) & ((1<<entry1Bits) - 1)\n    );\n");
          }
        }
        // 100, 14
        jamonWriter.write("\n");
        // 104, 1
        for (Register reg : registers )
        {
          // 104, 34
          if ((reg.getAlias() == null) && (reg.getNumEntries2() > 1) )
          {
            // 104, 96
            jamonWriter.write("    function getEntry2Address");
            // 105, 30
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 105, 86
            jamonWriter.write("(int(24) -chip_addr) : int(16) = (\n      int(8) entry2Bits = log2(");
            // 106, 32
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 106, 51
            jamonWriter.write("_ENTRIES_2);\n      getEntry2Address");
            // 107, 23
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 107, 79
            jamonWriter.write(" = (chip_addr >> log2(");
            // 107, 101
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 107, 120
            jamonWriter.write("_STRIDE_2)) & ((1<<entry2Bits) - 1)\n    );\n");
          }
        }
        // 109, 14
        jamonWriter.write("\n    function rw");
        // 113, 16
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 113, 39
        jamonWriter.write("Registers(int(1) -rw; int -chip_addr; int -+data;\n                               ");
        // 114, 32
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 114, 55
        jamonWriter.write("Registers -+s) = (\n");
        // 115, 1
        if (group == null )
        {
          // 115, 22
          for (String g : base.getGroups() )
          {
            // 115, 58
            if (g != null )
            {
              // 115, 75
              jamonWriter.write("      rw");
              // 116, 9
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 116, 90
              jamonWriter.write("Registers(rw,chip_addr,data,s::");
              // 116, 121
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g.toLowerCase()), jamonWriter);
              // 116, 142
              jamonWriter.write(");\n");
            }
          }
        }
        // 118, 1
        if (!registers.isEmpty() )
        {
          // 118, 29
          jamonWriter.write("      int offset;\n      #[regRange(chip_addr, ");
          // 120, 29
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getFullName()), jamonWriter);
          // 120, 53
          jamonWriter.write(", ");
          // 120, 55
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getName()), jamonWriter);
          // 120, 75
          jamonWriter.write("_SIZE, offset) ->\n        #[");
          // 122, 1
          boolean first = true; 
          // 123, 14
          for (Register reg : registers )
          {
            // 123, 47
            if (reg.getAlias() == null )
            {
              // 124, 1
              String index = ""; 
              // 125, 1
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(first ? "" : "        []"), jamonWriter);
              // 125, 32
              first=false; 
              // 125, 54
              jamonWriter.write("is");
              // 126, 3
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
              // 126, 59
              jamonWriter.write("(chip_addr) ->\n            int(");
              // 128, 17
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
              // 128, 51
              jamonWriter.write(") data_atomic;\n");
              // 129, 18
              if (reg.getEntryWidth() > 1 )
              {
                // 129, 49
                jamonWriter.write("            int(8) atomic_word = getAtomicWordNumber");
                // 130, 53
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
                // 130, 109
                jamonWriter.write("(chip_addr);\n");
              }
              // 131, 18
              else
              {
                // 131, 25
                jamonWriter.write("            int(8) atomic_word = 0;\n");
              }
              // 134, 18
              if (reg.getNumEntries() > 1 )
              {
                // 134, 49
                jamonWriter.write("            int(16) i0 = getEntryAddress");
                // 135, 41
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
                // 135, 97
                jamonWriter.write("(chip_addr);\n");
                // 136, 1
                index = "[i0]"; 
              }
              // 138, 18
              if (reg.getNumEntries1() > 1 )
              {
                // 138, 50
                jamonWriter.write("            int(16) i1 = getEntry1Address");
                // 139, 42
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
                // 139, 98
                jamonWriter.write("(chip_addr);\n");
                // 140, 1
                index = "[i1, i0]"; 
              }
              // 142, 18
              if (reg.getNumEntries2() > 1 )
              {
                // 142, 50
                jamonWriter.write("            int(16) i2 = getEntry2Address");
                // 143, 42
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
                // 143, 98
                jamonWriter.write("(chip_addr);\n");
                // 144, 1
                index = "[i2, i1, i0]"; 
              }
              // 145, 24
              jamonWriter.write("\n");
              // 147, 18
              if (reg.isStructure() )
              {
                // 147, 43
                jamonWriter.write("            int(");
                // 148, 17
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
                // 148, 51
                jamonWriter.write(") reg = pack(s::");
                // 148, 67
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                // 148, 100
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                // 148, 111
                jamonWriter.write(");\n");
              }
              // 149, 18
              else
              {
                // 149, 25
                jamonWriter.write("            int(");
                // 150, 17
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
                // 150, 51
                jamonWriter.write(") reg = s::");
                // 150, 62
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                // 150, 95
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                // 150, 106
                jamonWriter.write(";\n");
              }
              // 151, 24
              jamonWriter.write("            int(");
              // 152, 17
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
              // 152, 51
              jamonWriter.write(") reg_read = reg & ~");
              // 152, 71
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 152, 90
              jamonWriter.write("_WO_MASK;\n\n            [ rw == 0 ->\n");
              // 155, 18
              if (reg.getEntryWidth() > 1 )
              {
                // 155, 49
                jamonWriter.write("              [ ");
                // 157, 20
                for (int i=0; i<Math.ceil(1.0*reg.getEntryWidth()/reg.getAtomicWidth()); i++ )
                {
                  // 157, 100
                  jamonWriter.write("atomic_word == ");
                  // 157, 115
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(i), jamonWriter);
                  // 157, 122
                  jamonWriter.write(" -> ");
                  // 158, 1
                  int max = Math.min(reg.getAtomicWidth()*32*(i+1) - 1, reg.getImplementationWidth()-1); 
                  // 159, 1
                  int min = reg.getAtomicWidth()*32*(i); 
                  // 159, 49
                  jamonWriter.write("data = reg_read{");
                  // 160, 17
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(max), jamonWriter);
                  // 160, 26
                  jamonWriter.write(":");
                  // 160, 27
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(min), jamonWriter);
                  // 160, 36
                  jamonWriter.write("}\n              []");
                }
                // 162, 27
                jamonWriter.write("else -> skip ];\n");
              }
              // 163, 18
              else
              {
                // 163, 25
                jamonWriter.write("              data = reg_read\n");
              }
              // 165, 24
              jamonWriter.write("            [] else ->\n              [ ");
              // 168, 20
              for (int i=0; i<Math.ceil(1.0*reg.getEntryWidth()/reg.getAtomicWidth()); i++ )
              {
                // 168, 100
                jamonWriter.write("atomic_word == ");
                // 168, 115
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(i), jamonWriter);
                // 168, 122
                jamonWriter.write(" -> ");
                // 169, 1
                int max = Math.min(reg.getAtomicWidth()*32*(i+1) - 1, reg.getImplementationWidth()-1); 
                // 170, 1
                int min = reg.getAtomicWidth()*32*(i); 
                // 170, 49
                jamonWriter.write("data_atomic{");
                // 171, 13
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(max), jamonWriter);
                // 171, 22
                jamonWriter.write(":");
                // 171, 23
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(min), jamonWriter);
                // 171, 32
                jamonWriter.write("} = data;\n                <i:");
                // 172, 20
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(min), jamonWriter);
                // 172, 29
                jamonWriter.write("..");
                // 172, 31
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(max), jamonWriter);
                // 172, 40
                jamonWriter.write(":( regWriteBit(i,\n                  ");
                // 173, 19
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 173, 38
                jamonWriter.write("_RW_MASK | ");
                // 173, 49
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 173, 68
                jamonWriter.write("_RV_MASK | ");
                // 173, 79
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 173, 98
                jamonWriter.write("_WO_MASK,\n                  ");
                // 174, 19
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 174, 38
                jamonWriter.write("_RO_MASK,\n                  ");
                // 175, 19
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 175, 38
                jamonWriter.write("_CW_MASK,\n                  ");
                // 176, 19
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 176, 38
                jamonWriter.write("_CW1_MASK,\n                  data_atomic, reg); )>\n              []");
              }
              // 179, 27
              jamonWriter.write("else -> skip ];\n            ];\n");
              // 181, 18
              if (reg.isShadow() )
              {
                // 181, 40
                jamonWriter.write("            #[rw == 1 ->\n");
                // 183, 21
                if (reg.isStructure() )
                {
                  // 183, 46
                  jamonWriter.write("              unpack(s::shadow_");
                  // 184, 32
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                  // 184, 65
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                  // 184, 76
                  jamonWriter.write(", reg);\n");
                }
                // 185, 21
                else
                {
                  // 185, 28
                  jamonWriter.write("              s::shadow_");
                  // 186, 25
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                  // 186, 58
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                  // 186, 69
                  jamonWriter.write(" = reg;\n");
                }
                // 187, 27
                jamonWriter.write("            ]\n");
              }
              // 189, 18
              else
              {
                // 190, 21
                if (reg.isStructure() )
                {
                  // 190, 46
                  jamonWriter.write("            unpack(s::");
                  // 191, 23
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                  // 191, 56
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                  // 191, 67
                  jamonWriter.write(", reg);\n");
                }
                // 192, 21
                else
                {
                  // 192, 28
                  jamonWriter.write("            s::");
                  // 193, 16
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                  // 193, 49
                  org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
                  // 193, 60
                  jamonWriter.write(" = reg;\n");
                }
              }
            }
          }
          // 196, 27
          jamonWriter.write("        ]\n      ]\n");
        }
        // 199, 7
        jamonWriter.write("    );\n\n    function shadowApply");
        // 203, 25
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 203, 48
        jamonWriter.write("Registers(");
        // 203, 58
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 203, 81
        jamonWriter.write("Registers -+s) = (\n");
        // 204, 1
        if (group == null )
        {
          // 204, 22
          for (String g : base.getGroups() )
          {
            // 204, 58
            if (g != null )
            {
              // 204, 75
              jamonWriter.write("      shadowApply");
              // 205, 18
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 205, 99
              jamonWriter.write("Registers(s::");
              // 205, 112
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g.toLowerCase()), jamonWriter);
              // 205, 133
              jamonWriter.write(");\n");
            }
          }
        }
        // 207, 1
        if (!registers.isEmpty() )
        {
          // 208, 14
          for (Register reg : registers )
          {
            // 208, 47
            if (reg.getAlias() == null )
            {
              // 209, 18
              if (reg.isShadow() )
              {
                // 209, 40
                jamonWriter.write("      s::");
                // 210, 10
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                // 210, 43
                jamonWriter.write(" = s::shadow_");
                // 210, 56
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
                // 210, 89
                jamonWriter.write(";\n");
              }
            }
          }
        }
        // 213, 7
        jamonWriter.write("      skip\n    );\n\n");
        // 218, 1
        {
          // 218, 1
          __jamon_innerUnit__registerInitBase(jamonWriter, registers, camelCaseBaseName );
        }
        // 218, 81
        jamonWriter.write("\n");
        // 219, 1
        if (group == null )
        {
          // 219, 22
          for (String g : base.getGroups() )
          {
            // 219, 58
            if (g != null )
            {
              // 219, 75
              jamonWriter.write("      init");
              // 220, 11
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 220, 92
              jamonWriter.write("Registers(s::");
              // 220, 105
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g.toLowerCase()), jamonWriter);
              // 220, 126
              jamonWriter.write(");\n");
            }
          }
        }
        // 221, 20
        jamonWriter.write("    );\n  }\n}\n\n\n");
      }
      // 228, 8
      jamonWriter.write("\n");
    }
    // 229, 8
    jamonWriter.write("\n\n/****************************************************************************/\n/****************************************************************************/\n\n// Versions without data\ndefchan IntMgmtGroupChannelND(int W_A)(\n  e1of2            +RW;\n  e1of4[(W_A+1)/2] +ADDR\n){}\n\ndefchan IntMgmtChannelND()(\n  e1of2            +HIT;\n  e1of2            +RW\n){}\ndefchan IntMgmtIChannelND(int W_I)(\n  e1of2            +HIT;\n  e1of2            +RW;\n  e1of4[(W_I+1)/2] +I\n){}\ndefchan IntMgmtWChannelND(int N_AW)(\n  e1of2             +HIT;\n  e1of2             +RW;\n  e1of4[log4(N_AW)] +AW\n){}\ndefchan IntMgmtIWChannelND(int W_I, N_AW)(\n  e1of2             +HIT;\n  e1of2             +RW;\n  e1of4[(W_I+1)/2]  +I;\n  e1of4[log4(N_AW)] +AW\n){}\n\n");
    // 264, 1
    for (RegisterBase base : bases )
    {
      // 264, 35
      jamonWriter.write("\n");
      // 265, 1
      for (String group : base.getGroups() )
      {
        // 265, 41
        jamonWriter.write("\n");
        // 266, 1
        
String baseName = base.getName(); if(group != null) baseName += "_" + group.toUpperCase();
String camelCaseBaseName = Utility.underscoreToCamelCase(baseName, true);
int maxAtomicWidth = 1; for(Register reg : base.getRegisters()) {maxAtomicWidth=Math.max(maxAtomicWidth,reg.getAtomicWidth());}
Collection<Register> registers = base.getRegisters("group", group);
int maxSramBits = 1; for(Register reg : registers) {maxSramBits=Math.max(maxSramBits,reg.getImplementationWidth());}
int mgmtDataBits = (group == null) ? 32*maxAtomicWidth : maxSramBits;
int wAddr = 24;

        // 275, 74
        jamonWriter.write("define ");
        // 276, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 276, 22
        jamonWriter.write("_MGMT_IN() (\n    e1of2 -RW; e1of4[(");
        // 277, 23
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
        // 277, 34
        jamonWriter.write("+1)/2] -ADDR; e1of4[(");
        // 277, 55
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 277, 73
        jamonWriter.write("+1)/2] -DATA");
        // 278, 14
        for (Register reg : registers )
        {
          // 278, 47
          if (reg.getAlias() == null )
          {
            // 278, 77
            jamonWriter.write(";\n");
            // 279, 1
            
Register.IndexInfo indexInfo = reg.getIndexInfo();
int wD = reg.getImplementationWidth();

            // 283, 18
            if (reg.getEntryWidth() > reg.getAtomicWidth() )
            {
              // 284, 1
              int wW = Double.valueOf(Math.ceil(1.0*reg.getEntryWidth()/reg.getAtomicWidth())).intValue(); 
              // 285, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 285, 58
                jamonWriter.write("    IntMgmtIWChannel(");
                // 286, 22
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wD), jamonWriter);
                // 286, 30
                jamonWriter.write(", ");
                // 286, 32
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 286, 62
                jamonWriter.write(", ");
                // 286, 64
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 286, 72
                jamonWriter.write(")");
              }
              // 287, 22
              else
              {
                // 287, 29
                jamonWriter.write("    IntMgmtWChannel(");
                // 288, 21
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wD), jamonWriter);
                // 288, 29
                jamonWriter.write(", ");
                // 288, 31
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 288, 39
                jamonWriter.write(")");
              }
            }
            // 290, 18
            else
            {
              // 291, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 291, 58
                jamonWriter.write("    IntMgmtIChannel(");
                // 292, 21
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wD), jamonWriter);
                // 292, 29
                jamonWriter.write(", ");
                // 292, 31
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 292, 61
                jamonWriter.write(")");
              }
              // 293, 22
              else
              {
                // 293, 29
                jamonWriter.write("    IntMgmtChannel(");
                // 294, 20
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wD), jamonWriter);
                // 294, 28
                jamonWriter.write(")");
              }
            }
            // 296, 24
            jamonWriter.write(" +");
            // 296, 26
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          }
        }
        // 298, 14
        if (group == null )
        {
          // 298, 35
          for (String g : base.getGroups() )
          {
            // 298, 71
            if (g != null )
            {
              // 298, 88
              jamonWriter.write(";\n");
              // 299, 1
              int mW = 1; for(Register reg : base.getRegisters("group", g)) {mW=Math.max(mW,reg.getImplementationWidth());}  
              // 299, 121
              jamonWriter.write("    IntMgmtGroupChannel(");
              // 300, 25
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
              // 300, 36
              jamonWriter.write(", ");
              // 300, 38
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mW), jamonWriter);
              // 300, 46
              jamonWriter.write(") +");
              // 300, 49
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
            }
          }
        }
        // 301, 33
        jamonWriter.write("\n  ) {\n  subcells {\n");
        // 305, 14
        for (Register reg : registers )
        {
          // 305, 47
          if (reg.getAlias() == null )
          {
            // 306, 1
            
Register.IndexInfo indexInfo = reg.getIndexInfo();

            // 309, 18
            if (reg.getEntryWidth() > reg.getAtomicWidth() )
            {
              // 310, 1
              int wW = Double.valueOf(Math.ceil(1.0*reg.getEntryWidth()/reg.getAtomicWidth())).intValue(); 
              // 311, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 311, 58
                jamonWriter.write("    IntMgmtIWChannelND(");
                // 312, 24
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 312, 54
                jamonWriter.write(", ");
                // 312, 56
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 312, 64
                jamonWriter.write(") ");
                // 312, 66
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), false)), jamonWriter);
                // 312, 123
                jamonWriter.write("_nd(");
                // 313, 1
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 313, 20
                jamonWriter.write(".HIT, ");
                // 313, 26
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 313, 45
                jamonWriter.write(".RW, ");
                // 313, 50
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 313, 69
                jamonWriter.write(".I, ");
                // 313, 73
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 313, 92
                jamonWriter.write(".AW);\n");
              }
              // 314, 22
              else
              {
                // 314, 29
                jamonWriter.write("    IntMgmtWChannelND(");
                // 315, 23
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 315, 31
                jamonWriter.write(") ");
                // 315, 33
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), false)), jamonWriter);
                // 315, 90
                jamonWriter.write("_nd(");
                // 316, 1
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 316, 20
                jamonWriter.write(".HIT, ");
                // 316, 26
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 316, 45
                jamonWriter.write(".RW, ");
                // 316, 50
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 316, 69
                jamonWriter.write(".AW);\n");
              }
            }
            // 318, 18
            else
            {
              // 319, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 319, 58
                jamonWriter.write("    IntMgmtIChannelND(");
                // 320, 23
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 320, 53
                jamonWriter.write(") ");
                // 320, 55
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), false)), jamonWriter);
                // 320, 112
                jamonWriter.write("_nd(");
                // 321, 1
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 321, 20
                jamonWriter.write(".HIT, ");
                // 321, 26
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 321, 45
                jamonWriter.write(".RW, ");
                // 321, 50
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 321, 69
                jamonWriter.write(".I);\n");
              }
              // 322, 22
              else
              {
                // 322, 29
                jamonWriter.write("    IntMgmtChannelND() ");
                // 323, 24
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), false)), jamonWriter);
                // 323, 81
                jamonWriter.write("_nd(");
                // 323, 85
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 323, 104
                jamonWriter.write(".HIT, ");
                // 323, 110
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
                // 323, 129
                jamonWriter.write(".RW);\n");
              }
            }
          }
        }
        // 327, 14
        if (group == null )
        {
          // 327, 35
          for (String g : base.getGroups() )
          {
            // 327, 71
            if (g != null )
            {
              // 327, 88
              jamonWriter.write("    IntMgmtGroupChannelND(");
              // 328, 27
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
              // 328, 38
              jamonWriter.write(") ");
              // 328, 40
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(g, false)), jamonWriter);
              // 328, 85
              jamonWriter.write("_nd(");
              // 328, 89
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 328, 96
              jamonWriter.write(".RW, ");
              // 328, 101
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 328, 108
              jamonWriter.write(".ADDR);\n");
            }
          }
        }
        // 329, 33
        jamonWriter.write("\n    ");
        // 331, 5
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 331, 19
        jamonWriter.write("_MGMT_IN_CTRL ctrl(RW, ADDR");
        // 332, 14
        for (Register reg : registers )
        {
          // 332, 47
          if (reg.getAlias() == null )
          {
            // 332, 77
            jamonWriter.write(",\n      ");
            // 333, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), false)), jamonWriter);
            // 333, 64
            jamonWriter.write("_nd");
          }
        }
        // 335, 14
        if (group == null )
        {
          // 335, 35
          for (String g : base.getGroups() )
          {
            // 335, 71
            if (g != null )
            {
              // 335, 88
              jamonWriter.write(",\n      ");
              // 336, 7
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(g, false)), jamonWriter);
              // 336, 52
              jamonWriter.write("_nd");
            }
          }
        }
        // 337, 33
        jamonWriter.write("    );\n    ");
        // 339, 5
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 339, 19
        jamonWriter.write("_MGMT_IN_DATA data(DATA");
        // 340, 14
        for (Register reg : registers )
        {
          // 340, 47
          if (reg.getAlias() == null )
          {
            // 340, 77
            jamonWriter.write(",\n      ");
            // 341, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 341, 26
            jamonWriter.write(".D");
          }
        }
        // 343, 14
        if (group == null )
        {
          // 343, 35
          for (String g : base.getGroups() )
          {
            // 343, 71
            if (g != null )
            {
              // 343, 88
              jamonWriter.write(",\n      ");
              // 344, 7
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 344, 14
              jamonWriter.write(".DATA");
            }
          }
        }
        // 345, 33
        jamonWriter.write("    );\n  }\n}\n\n\ndefine ");
        // 352, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 352, 22
        jamonWriter.write("_MGMT_IN_CTRL() (\n    e1of2 -RW; e1of4[(");
        // 353, 23
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
        // 353, 34
        jamonWriter.write("+1)/2] -ADDR\n");
        // 354, 14
        for (Register reg : registers )
        {
          // 354, 47
          if (reg.getAlias() == null )
          {
            // 354, 77
            jamonWriter.write(";\n");
            // 355, 1
            
Register.IndexInfo indexInfo = reg.getIndexInfo();

            // 358, 18
            if (reg.getEntryWidth() > reg.getAtomicWidth() )
            {
              // 359, 1
              int wW = Double.valueOf(Math.ceil(1.0*reg.getEntryWidth()/reg.getAtomicWidth())).intValue(); 
              // 360, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 360, 58
                jamonWriter.write("    IntMgmtIWChannelND(");
                // 361, 24
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 361, 54
                jamonWriter.write(", ");
                // 361, 56
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 361, 64
                jamonWriter.write(")");
              }
              // 362, 22
              else
              {
                // 362, 29
                jamonWriter.write("    IntMgmtWChannelND(");
                // 363, 23
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wW), jamonWriter);
                // 363, 31
                jamonWriter.write(")");
              }
            }
            // 365, 18
            else
            {
              // 366, 22
              if (indexInfo.totalEntryBits > 0 )
              {
                // 366, 58
                jamonWriter.write("    IntMgmtIChannelND(");
                // 367, 23
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.totalEntryBits), jamonWriter);
                // 367, 53
                jamonWriter.write(")");
              }
              // 368, 22
              else
              {
                // 368, 29
                jamonWriter.write("    IntMgmtChannelND()");
              }
            }
            // 371, 24
            jamonWriter.write(" +");
            // 371, 26
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          }
        }
        // 373, 14
        if (group == null )
        {
          // 373, 35
          for (String g : base.getGroups() )
          {
            // 373, 71
            if (g != null )
            {
              // 373, 88
              jamonWriter.write(";\n    IntMgmtGroupChannelND(");
              // 374, 27
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
              // 374, 38
              jamonWriter.write(") +");
              // 374, 41
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
            }
          }
        }
        // 375, 33
        jamonWriter.write("\n  )\n  <+ ");
        // 378, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName(), true)), jamonWriter);
        // 378, 63
        jamonWriter.write("RegisterFields <+ ");
        // 378, 81
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 378, 104
        jamonWriter.write("Management\n  <+ AddressSpace <+ MgmtIfCell <+ RegisterFunctions {\n  csp {\n    *[ int(1) rw;\n       int(");
        // 382, 12
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(wAddr), jamonWriter);
        // 382, 23
        jamonWriter.write(") chip_addr;\n       RW?rw, ADDR?chip_addr;\n");
        // 384, 14
        for (Register reg : registers )
        {
          // 384, 47
          if (reg.getAlias() == null )
          {
            // 385, 1
            Register.IndexInfo indexInfo = reg.getIndexInfo(); 
            // 385, 61
            jamonWriter.write("       ");
            // 386, 8
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 386, 27
            jamonWriter.write(".RW!rw,\n");
            // 387, 18
            if (reg.getEntryWidth() > reg.getAtomicWidth() )
            {
              // 387, 68
              jamonWriter.write("       ");
              // 388, 8
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 388, 27
              jamonWriter.write(".AW!( getAtomicWordNumber");
              // 388, 52
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
              // 388, 108
              jamonWriter.write("(chip_addr) ),\n");
            }
            // 390, 18
            if (reg.getNumEntries() > 1 )
            {
              // 390, 49
              jamonWriter.write("       ");
              // 391, 8
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 391, 27
              jamonWriter.write(".I!( ");
              // 392, 22
              if (reg.getNumEntries2() > 1 )
              {
                // 392, 54
                jamonWriter.write("(chip_addr{");
                // 393, 12
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry2UpperIdx), jamonWriter);
                // 393, 42
                jamonWriter.write(":");
                // 393, 43
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry2Idx), jamonWriter);
                // 393, 68
                jamonWriter.write("} << ");
                // 393, 73
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry0Bits + indexInfo.entry1Bits), jamonWriter);
                // 393, 122
                jamonWriter.write(") | ");
              }
              // 395, 22
              if (reg.getNumEntries1() > 1 )
              {
                // 395, 54
                jamonWriter.write("(chip_addr{");
                // 396, 12
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry1UpperIdx), jamonWriter);
                // 396, 42
                jamonWriter.write(":");
                // 396, 43
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry1Idx), jamonWriter);
                // 396, 68
                jamonWriter.write("} << ");
                // 396, 73
                org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry0Bits), jamonWriter);
                // 396, 99
                jamonWriter.write(") | ");
              }
              // 397, 28
              jamonWriter.write("chip_addr{");
              // 397, 38
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry0UpperIdx), jamonWriter);
              // 397, 68
              jamonWriter.write(":");
              // 397, 69
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(indexInfo.entry0Idx), jamonWriter);
              // 397, 94
              jamonWriter.write("} ),\n");
            }
            // 398, 24
            jamonWriter.write("       ");
            // 399, 8
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 399, 27
            jamonWriter.write(".HIT!(");
            // 399, 33
            {
              // 399, 33
              __jamon_innerUnit__registerAddressGuardExpr(jamonWriter, reg);
            }
            // 399, 73
            jamonWriter.write("),\n\n");
          }
        }
        // 402, 14
        if (group == null )
        {
          // 402, 35
          for (String g : base.getGroups() )
          {
            // 402, 71
            if (g != null )
            {
              // 402, 88
              jamonWriter.write("       ");
              // 403, 8
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 403, 15
              jamonWriter.write(".RW!rw, ");
              // 403, 23
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 403, 30
              jamonWriter.write(".ADDR!chip_addr,\n");
            }
          }
        }
        // 404, 33
        jamonWriter.write("       skip\n    ]\n  }\n}\n\ndefine ");
        // 411, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 411, 22
        jamonWriter.write("_MGMT_IN_DATA() (\n    e1of4[(");
        // 412, 12
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 412, 30
        jamonWriter.write("+1)/2] -DATA");
        // 413, 14
        for (Register reg : registers )
        {
          // 413, 47
          if (reg.getAlias() == null )
          {
            // 413, 77
            jamonWriter.write(";\n    e1of4[(");
            // 414, 12
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
            // 414, 46
            jamonWriter.write("+1)/2] +");
            // 414, 54
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          }
        }
        // 416, 14
        if (group == null )
        {
          // 416, 35
          for (String g : base.getGroups() )
          {
            // 416, 71
            if (g != null )
            {
              // 416, 88
              jamonWriter.write(";\n");
              // 417, 1
              int mW = 1; for(Register reg : base.getRegisters("group", g)) {mW=Math.max(mW,reg.getImplementationWidth());}  
              // 417, 121
              jamonWriter.write("    e1of4[(");
              // 418, 12
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mW), jamonWriter);
              // 418, 20
              jamonWriter.write("+1)/2] +");
              // 418, 28
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
            }
          }
        }
        // 419, 33
        jamonWriter.write("\n  ) {\n  csp {\n    *[ int(");
        // 423, 12
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 423, 30
        jamonWriter.write(") d;\n       DATA?d;\n");
        // 425, 14
        for (Register reg : registers )
        {
          // 425, 47
          if (reg.getAlias() == null )
          {
            // 425, 77
            jamonWriter.write("       ");
            // 426, 8
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 426, 27
            jamonWriter.write("!d,\n");
          }
        }
        // 428, 14
        if (group == null )
        {
          // 428, 35
          for (String g : base.getGroups() )
          {
            // 428, 71
            if (g != null )
            {
              // 428, 88
              jamonWriter.write("       ");
              // 429, 8
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 429, 15
              jamonWriter.write("!d,\n");
            }
          }
        }
        // 430, 33
        jamonWriter.write("       skip\n    ]\n  }\n}\n\n\ndefine ");
        // 438, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 438, 22
        jamonWriter.write("_MGMT_OUT() (\n    e1of4[(");
        // 439, 12
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 439, 30
        jamonWriter.write("+1)/2] +DATA");
        // 440, 14
        for (Register reg : registers )
        {
          // 440, 47
          if (reg.getAlias() == null )
          {
            // 440, 77
            jamonWriter.write(";\n    e1of4[(");
            // 441, 12
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
            // 441, 46
            jamonWriter.write("+1)/2] -");
            // 441, 54
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
          }
        }
        // 443, 14
        if (group == null )
        {
          // 443, 35
          for (String g : base.getGroups() )
          {
            // 443, 71
            if (g != null )
            {
              // 443, 88
              jamonWriter.write(";\n");
              // 444, 1
              int mW = 1; for(Register reg : base.getRegisters("group", g)) {mW=Math.max(mW,reg.getImplementationWidth());}  
              // 444, 121
              jamonWriter.write("    e1of4[(");
              // 445, 12
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mW), jamonWriter);
              // 445, 20
              jamonWriter.write("+1)/2] -");
              // 445, 28
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
            }
          }
        }
        // 446, 33
        jamonWriter.write(") {\n  csp {\n    *[ DATA!(");
        // 450, 1
        for (Register reg : registers )
        {
          // 450, 34
          if (reg.getAlias() == null )
          {
            // 450, 64
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 450, 83
            jamonWriter.write("? | ");
          }
        }
        // 451, 1
        if (group == null )
        {
          // 451, 22
          for (String g : base.getGroups() )
          {
            // 451, 58
            if (g != null )
            {
              // 451, 75
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g), jamonWriter);
              // 451, 82
              jamonWriter.write("? | ");
            }
          }
        }
        // 451, 105
        jamonWriter.write("0) ]\n  }\n}\n\n\n\n");
      }
      // 458, 8
      jamonWriter.write("\n");
    }
    // 459, 8
    jamonWriter.write("\n\n\n");
  }
  
  
  // 25, 1
  private void __jamon_innerUnit__e1ofN(final java.io.Writer jamonWriter, final int w)
    throws java.io.IOException
  {
    // 27, 1
    if (w <= 2 )
    {
      // 27, 15
      jamonWriter.write("e1of");
      // 27, 19
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(w*2), jamonWriter);
    }
    // 28, 1
    else
    {
      // 28, 8
      jamonWriter.write("e1of4[");
      // 28, 14
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%.0f", Math.ceil(w/2.0))), jamonWriter);
      // 28, 59
      jamonWriter.write("]");
    }
  }
  
  
}

// Autogenerated Jamon implementation
// C:/Users/mhesseli/Documents/Perforce/rrc-4/reg-main/shared/java/src/./com/fulcrummicro/hw/verification/chip/mgmt/registers/templates/CastRegMapShimRefinements.jamon

package com.fulcrummicro.hw.verification.chip.mgmt.registers.templates;

// 3, 1
import java.util.Collection;
// 4, 1
import java.util.Iterator;
// 5, 1
import com.fulcrummicro.util.misc.Utility;
// 6, 1
import com.fulcrummicro.hw.verification.chip.mgmt.registers.*;

public class CastRegMapShimRefinementsImpl
  extends com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl
  implements com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastRegMapShimRefinements.Intf

{
  private final Collection<RegisterCrossbarPort> crossbarPorts;
  private final String chip;
  protected static com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastRegMapShimRefinements.ImplData __jamon_setOptionalArguments(com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastRegMapShimRefinements.ImplData p_implData)
  {
    com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl.__jamon_setOptionalArguments(p_implData);
    return p_implData;
  }
  public CastRegMapShimRefinementsImpl(org.jamon.TemplateManager p_templateManager, com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastRegMapShimRefinements.ImplData p_implData)
  {
    super(p_templateManager, __jamon_setOptionalArguments(p_implData));
    crossbarPorts = p_implData.getCrossbarPorts();
    chip = p_implData.getChip();
  }
  
  @Override protected void child_render_2(final java.io.Writer jamonWriter)
    throws java.io.IOException
  {
    // 11, 9
    jamonWriter.write("module chip.");
    // 12, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 12, 23
    jamonWriter.write(".mgmt.crossbar.shim.impl;\n\nimport chip.");
    // 14, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 14, 23
    jamonWriter.write(".mgmt.channel.XbusPort;\nimport chip.");
    // 15, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 15, 23
    jamonWriter.write(".mgmt.channel.TargetInternalMgmtInterface;\nimport chip.");
    // 16, 13
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 16, 23
    jamonWriter.write(".mgmt.crossbar.shim.target.TARGET_SHIM_TOP;\nimport deprecated.lib.serial.scan.ChanDft;\n\n");
    // 19, 1
    for (RegisterCrossbarPort xbPort : crossbarPorts )
    {
      // 20, 1
      if (!xbPort.hasBusStops() )
      {
        // 20, 30
        jamonWriter.write("define ");
        // 22, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getName()), jamonWriter);
        // 22, 30
        jamonWriter.write("_TARGET_SHIM (int N_D)(ChanDft  -LS, +RS;\n                                               XbusPort +X;\n                                               TargetInternalMgmtInterface(\n                                                 ");
        // 25, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getNumRegisters()), jamonWriter);
        // 25, 80
        jamonWriter.write(" /*=N_REG*/,\n                                                 ");
        // 26, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntriesAtomic()), jamonWriter);
        // 26, 84
        jamonWriter.write(" /*=MAX_ENTRIES_A*/,\n                                                 ");
        // 27, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(0)), jamonWriter);
        // 27, 79
        jamonWriter.write(" /*=MAX_ENTRIES_0*/,\n                                                 ");
        // 28, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(1)), jamonWriter);
        // 28, 79
        jamonWriter.write(" /*=MAX_ENTRIES_1*/,\n                                                 ");
        // 29, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(2)), jamonWriter);
        // 29, 79
        jamonWriter.write(" /*=MAX_ENTRIES_2*/,\n                                                 N_D) +M)\n  <: TARGET_SHIM_TOP(N_D,\n        ");
        // 32, 9
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getNumRegisters()), jamonWriter);
        // 32, 39
        jamonWriter.write(" /*=N_REG*/,\n        false /*=SUPPORT_PER_MASTER_CACHE*/,\n        ");
        // 34, 9
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntriesAtomic()), jamonWriter);
        // 34, 43
        jamonWriter.write(" /*=MAX_ENTRIES_A*/,\n        ");
        // 35, 9
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(0)), jamonWriter);
        // 35, 38
        jamonWriter.write(" /*=MAX_ENTRIES_0*/,\n        ");
        // 36, 9
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(1)), jamonWriter);
        // 36, 38
        jamonWriter.write(" /*=MAX_ENTRIES_1*/,\n        ");
        // 37, 9
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getMaxEntries(2)), jamonWriter);
        // 37, 38
        jamonWriter.write(" /*=MAX_ENTRIES_2*/,\n        { /* BASE[0..N_REG-1]: */\n");
        // 39, 1
        Iterator<RegisterBase> baseIt = xbPort.getRegisterBases().iterator(); 
        // 40, 1
        while (baseIt.hasNext() )
        {
          // 41, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 43, 1
          while (regIt.hasNext() )
          {
            // 44, 1
            Register reg = regIt.next(); 
            // 44, 39
            jamonWriter.write("          ");
            // 45, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("0x%06x", reg.getAddressOffset()+base.getAbsoluteAddress())), jamonWriter);
            // 45, 90
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 45, 133
              jamonWriter.write(",");
            }
            // 45, 140
            jamonWriter.write(" /* ");
            // 45, 144
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 45, 163
            jamonWriter.write(" */\n");
          }
        }
        // 47, 10
        jamonWriter.write("        },\n        { /* BASE_MASK[0..N_REG-1]: */\n");
        // 50, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 51, 1
        while (baseIt.hasNext() )
        {
          // 52, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 54, 1
          while (regIt.hasNext() )
          {
            // 55, 1
            Register reg = regIt.next(); 
            // 55, 39
            jamonWriter.write("          ");
            // 56, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("0x%06x", reg.getAddressMatchMask() & ((1<<22)-1))), jamonWriter);
            // 56, 81
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 56, 124
              jamonWriter.write(",");
            }
            // 56, 131
            jamonWriter.write("\n");
          }
        }
        // 58, 10
        jamonWriter.write("        },\n        { /* STRIDE_0: */\n");
        // 61, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 62, 1
        while (baseIt.hasNext() )
        {
          // 63, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 65, 1
          while (regIt.hasNext() )
          {
            // 66, 1
            Register reg = regIt.next(); 
            // 66, 39
            jamonWriter.write("          ");
            // 67, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getEntrySpace()), jamonWriter);
            // 67, 36
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 67, 79
              jamonWriter.write(",");
            }
            // 67, 86
            jamonWriter.write("\n");
          }
        }
        // 69, 10
        jamonWriter.write("        },\n        { /* STRIDE_1: */\n");
        // 72, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 73, 1
        while (baseIt.hasNext() )
        {
          // 74, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 76, 1
          while (regIt.hasNext() )
          {
            // 77, 1
            Register reg = regIt.next(); 
            // 77, 39
            jamonWriter.write("          ");
            // 78, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getEntrySpace1()), jamonWriter);
            // 78, 37
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 78, 80
              jamonWriter.write(",");
            }
            // 78, 87
            jamonWriter.write("\n");
          }
        }
        // 80, 10
        jamonWriter.write("        },\n        { /* STRIDE_2: */\n");
        // 83, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 84, 1
        while (baseIt.hasNext() )
        {
          // 85, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 87, 1
          while (regIt.hasNext() )
          {
            // 88, 1
            Register reg = regIt.next(); 
            // 88, 39
            jamonWriter.write("          ");
            // 89, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getEntrySpace2()), jamonWriter);
            // 89, 37
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 89, 80
              jamonWriter.write(",");
            }
            // 89, 87
            jamonWriter.write("\n");
          }
        }
        // 91, 10
        jamonWriter.write("        },\n        { /* ENTRIES_A: */\n");
        // 94, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 95, 1
        while (baseIt.hasNext() )
        {
          // 96, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 98, 1
          while (regIt.hasNext() )
          {
            // 99, 1
            Register reg = regIt.next(); 
            // 99, 39
            jamonWriter.write("          ");
            // 100, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf((reg.getEntryWidth()+reg.getAtomicWidth()-1)/reg.getAtomicWidth()), jamonWriter);
            // 100, 82
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 100, 125
              jamonWriter.write(",");
            }
            // 100, 132
            jamonWriter.write("\n");
          }
        }
        // 102, 10
        jamonWriter.write("        },\n        { /* ENTRIES_0: */\n");
        // 105, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 106, 1
        while (baseIt.hasNext() )
        {
          // 107, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 109, 1
          while (regIt.hasNext() )
          {
            // 110, 1
            Register reg = regIt.next(); 
            // 110, 39
            jamonWriter.write("          ");
            // 111, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries()), jamonWriter);
            // 111, 36
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 111, 79
              jamonWriter.write(",");
            }
            // 111, 86
            jamonWriter.write("\n");
          }
        }
        // 113, 10
        jamonWriter.write("        },\n        { /* ENTRIES_1: */\n");
        // 116, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 117, 1
        while (baseIt.hasNext() )
        {
          // 118, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 120, 1
          while (regIt.hasNext() )
          {
            // 121, 1
            Register reg = regIt.next(); 
            // 121, 39
            jamonWriter.write("          ");
            // 122, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries1()), jamonWriter);
            // 122, 37
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 122, 80
              jamonWriter.write(",");
            }
            // 122, 87
            jamonWriter.write("\n");
          }
        }
        // 124, 10
        jamonWriter.write("        },\n        { /* ENTRIES_2: */\n");
        // 127, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 128, 1
        while (baseIt.hasNext() )
        {
          // 129, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 131, 1
          while (regIt.hasNext() )
          {
            // 132, 1
            Register reg = regIt.next(); 
            // 132, 39
            jamonWriter.write("          ");
            // 133, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries2()), jamonWriter);
            // 133, 37
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 133, 80
              jamonWriter.write(",");
            }
            // 133, 87
            jamonWriter.write("\n");
          }
        }
        // 135, 10
        jamonWriter.write("        },\n        { /* WIDTH: */\n");
        // 138, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 139, 1
        while (baseIt.hasNext() )
        {
          // 140, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 142, 1
          while (regIt.hasNext() )
          {
            // 143, 1
            Register reg = regIt.next(); 
            // 143, 39
            jamonWriter.write("          ");
            // 144, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getEntryWidth()), jamonWriter);
            // 144, 36
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 144, 79
              jamonWriter.write(",");
            }
            // 144, 86
            jamonWriter.write("\n");
          }
        }
        // 146, 10
        jamonWriter.write("        },\n        { /* ATOMIC_WIDTH: */\n");
        // 149, 1
        baseIt = xbPort.getRegisterBases().iterator(); 
        // 150, 1
        while (baseIt.hasNext() )
        {
          // 151, 1
          RegisterBase base = baseIt.next();
       Iterator<Register> regIt = base.getRegisters().iterator(); 
          // 153, 1
          while (regIt.hasNext() )
          {
            // 154, 1
            Register reg = regIt.next(); 
            // 154, 39
            jamonWriter.write("          ");
            // 155, 11
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getAtomicWidth()), jamonWriter);
            // 155, 37
            if (regIt.hasNext() || baseIt.hasNext() )
            {
              // 155, 80
              jamonWriter.write(",");
            }
            // 155, 87
            jamonWriter.write("\n");
          }
        }
        // 157, 10
        jamonWriter.write("        }) {}\n\ndefine ");
        // 160, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(xbPort.getName()), jamonWriter);
        // 160, 30
        jamonWriter.write("_RegisterEnumeration ()() attributes {\n");
        // 161, 1
        int regNum = 0; 
        // 162, 1
        for (RegisterBase base : xbPort.getRegisterBases())
        {
          // 163, 1
          for (Register reg : base.getRegisters() )
          {
            // 163, 46
            jamonWriter.write("    int ");
            // 164, 9
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 164, 28
            jamonWriter.write("_NUM = ");
            // 164, 35
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.valueOf(regNum)), jamonWriter);
            // 164, 63
            jamonWriter.write(";\n");
            // 165, 1
            regNum++;
          }
        }
        // 167, 8
        jamonWriter.write("}\n");
      }
      // 169, 7
      jamonWriter.write("\n");
    }
    // 170, 8
    jamonWriter.write("\n\n");
  }
  
  
}

(* Copyright (c) 2025 Intel Corporation.  All rights reserved.  See the file COPYRIGHT for more information. *)
(* SPDX-License-Identifier: Apache-2.0 *)

INTERFACE CieSpectrum;

(* http://hyperphysics.phy-astr.gsu.edu/hbase/vision/efficacy.html *)

TYPE
  T = RECORD
    lambdaNm     : LONGREAL; (* / [nm]   *)
    photopicEff  : LONGREAL; (* / [1]    *)
    photopicConv : LONGREAL; (* / [lm/W] *)
    scotopicEff  : LONGREAL; (* / [1]    *)
    scotopicConv : LONGREAL; (* / [lm/W] *)
  END;

CONST Data = ARRAY  OF T {
  T { 380.0d0,   0.000039d0,     0.027d0,  0.000589d0,     1.001d0 },
  T { 390.0d0,   0.000120d0,     0.082d0,  0.002209d0,     3.755d0 },
  T { 400.0d0,   0.000396d0,     0.270d0,  0.009290d0,    15.793d0 },
  T { 410.0d0,   0.001210d0,     0.826d0,  0.034840d0,    59.228d0 },
  T { 420.0d0,   0.004000d0,     2.732d0,  0.096600d0,   164.220d0 },
  T { 430.0d0,   0.011600d0,     7.923d0,  0.199800d0,   339.660d0 },
  T { 440.0d0,   0.023000d0,    15.709d0,  0.328100d0,   557.770d0 },
  T { 450.0d0,   0.038000d0,    25.954d0,  0.455000d0,   773.500d0 },
  T { 460.0d0,   0.060000d0,    40.980d0,  0.567000d0,   963.900d0 },
  T { 470.0d0,   0.090980d0,    62.139d0,  0.676000d0,  1149.200d0 },
  T { 480.0d0,   0.139020d0,    94.951d0,  0.793000d0,  1348.100d0 },
  T { 490.0d0,   0.208020d0,   142.078d0,  0.904000d0,  1536.800d0 },
  T { 500.0d0,   0.323000d0,   220.609d0,  0.982000d0,  1669.400d0 },
  T { 507.0d0,   0.444310d0,   303.464d0,  1.000000d0,  1700.000d0 },
  T { 510.0d0,   0.503000d0,   343.549d0,  0.997000d0,  1694.900d0 },
  T { 520.0d0,   0.710000d0,   484.930d0,  0.935000d0,  1589.500d0 },
  T { 530.0d0,   0.862000d0,   588.746d0,  0.811000d0,  1378.700d0 },
  T { 540.0d0,   0.954000d0,   651.582d0,  0.655000d0,  1105.000d0 },
  T { 550.0d0,   0.994950d0,   679.551d0,  0.481000d0,   817.700d0 },
  T { 555.0d0,   1.000000d0,   683.000d0,  0.402000d0,   683.000d0 },
  T { 560.0d0,   0.995000d0,   679.585d0,  0.328800d0,   558.960d0 },
  T { 570.0d0,   0.952000d0,   650.216d0,  0.207600d0,   352.920d0 },
  T { 580.0d0,   0.870000d0,   594.210d0,  0.121200d0,   206.040d0 },
  T { 590.0d0,   0.757000d0,   517.031d0,  0.065500d0,   111.350d0 },
  T { 600.0d0,   0.631000d0,   430.973d0,  0.033150d0,    56.355d0 },
  T { 610.0d0,   0.503000d0,   343.549d0,  0.015930d0,    27.081d0 },
  T { 620.0d0,   0.381000d0,   260.223d0,  0.007370d0,    12.529d0 },
  T { 630.0d0,   0.265000d0,   180.995d0,  0.003335d0,     5.670d0 },
  T { 640.0d0,   0.175000d0,   119.525d0,  0.001497d0,     2.545d0 },
  T { 650.0d0,   0.107000d0,    73.081d0,  0.000677d0,     1.151d0 },
  T { 660.0d0,   0.061000d0,    41.663d0,  0.000313d0,     0.532d0 },
  T { 670.0d0,   0.032000d0,    21.856d0,  0.000148d0,     0.252d0 },
  T { 680.0d0,   0.017000d0,    11.611d0,  0.000072d0,     0.122d0 },
  T { 690.0d0,   0.008210d0,     5.607d0,  0.000035d0,     0.060d0 },
  T { 700.0d0,   0.004102d0,     2.802d0,  0.000018d0,     0.030d0 },
  T { 710.0d0,   0.002091d0,     1.428d0,  0.000009d0,     0.016d0 },
  T { 720.0d0,   0.001047d0,     0.715d0,  0.000005d0,     0.008d0 },
  T { 730.0d0,   0.000520d0,     0.355d0,  0.000003d0,     0.004d0 },
  T { 740.0d0,   0.000249d0,     0.170d0,  0.000001d0,     0.002d0 },
  T { 750.0d0,   0.000120d0,     0.082d0,  0.000001d0,     0.001d0 },
  T { 760.0d0,   0.000060d0,     0.041d0,  0.000000d0,     0.000d0 },
  T { 770.0d0,   0.000030d0,     0.020d0,  0.000000d0,     0.000d0 }
  };

PROCEDURE Interpolate(lambda : LONGREAL) : T;
  (* interpolate the spectrum at the required wavelength in meters *)

PROCEDURE PhotoConv(lambda : LONGREAL) : LONGREAL;
  (* Interpolate(lambda).photopicConv *)
  
END CieSpectrum.

import ("libm3")
import ("parseparams")
import ("wm_support")
import ("wm_net")
import ("hlp")
import ("mby")
import ("mscheme")
import ("modula3scheme")
import ("netobj")
import ("sstubgen")

module ("ModelServer")

%module ("HlpModelServer")
% NO -- CANT PULL THIS IN HERE!  The reason is that this will pull in
% the entire register def of HLP into the Scheme name mangling, which
% is too big for us to handle (at least with any speed).
%
% Instead, if we want to get at the HLP regs from Scheme,
% we have to do so in some roundabout way.  (not as yet defined)
% ... more to come ...
%

interface ("ModelServerClass")
module("MsIosf")
%interface ("MsIosf")
module ("HlpModelServer")

module ("DataPusher")
table ("IntDataPusher", "Integer", "DataPusher")
table ("CardByte", "Cardinal", "Byte")

module ("HlpModel")
module ("MbyModel")

Generic_module("BaseModelServer")
module("MbyModelServer")

interface("BaseModelStage")
interface("Metadata")
Generic_interface("ModelStage")
interface ("MbyModelStage")

module ("MbyParserStage")
interface ("MbyParserMeta")

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

SchemeStubs ("ModelServer")

ExportSchemeStubs("model_server")
importSchemeStubs()              % import ALL scheme stubs

implementation ("Main")

program ("modelserver")

#!/bin/bash

pkgDir=../applications/TestPoint
outDir=../perl-wrapper
outFile=$outDir/SDKScalars.pm

echo Scanning for all SDK Scalars in $pkgDir to generate $outFile

#First part of file
echo '# This file was automatically generated by gen_sdk_scalars
#
# This file is used as a wrapper for importing scalars from SDK package
# as a replacement for "use SDK qw(/^\$/)", which can take some time to load.
#

package SDKScalars;

use base 'Exporter';
use SDK;

our @EXPORT = qw(
$TRUE
$FALSE
$TRIGGER_MATCHCASE_MATCHUNCONDITIONAL
' > $outFile

#Auto generated all scalars being referenced in all the packages
#Doesn't hurt to include all the family and platform scalars
grep -roh --include="*.pm" --exclude="Registers.pm" '$FM[A-Za-z0-9_]*' $pkgDir | sort -u >> $outFile

#Final portion of file
echo '
);
' >> $outFile


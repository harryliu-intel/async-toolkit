// Autogenerated Jamon implementation
// /nfs/sc/proj/ctg/mrl108/rliu68/sw-intel6/cad/java/src/./com/fulcrummicro/hw/verification/chip/mgmt/registers/templates/Cast.jamon

package com.fulcrummicro.hw.verification.chip.mgmt.registers.templates;

// 3, 1
import java.util.Collection;
// 4, 1
import com.fulcrummicro.util.misc.Utility;
// 5, 1
import com.fulcrummicro.hw.verification.chip.mgmt.registers.*;
// 6, 1
import com.fulcrummicro.hw.verification.lib.constants.ConstantsEnum;

public class CastImpl
  extends com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl
  implements com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.Cast.Intf

{
  private final Collection<RegisterBase> bases;
  private final Collection<Register> regs;
  private final String chip;
  protected static com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.Cast.ImplData __jamon_setOptionalArguments(com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.Cast.ImplData p_implData)
  {
    com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastCommonImpl.__jamon_setOptionalArguments(p_implData);
    return p_implData;
  }
  public CastImpl(org.jamon.TemplateManager p_templateManager, com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.Cast.ImplData p_implData)
  {
    super(p_templateManager, __jamon_setOptionalArguments(p_implData));
    bases = p_implData.getBases();
    regs = p_implData.getRegs();
    chip = p_implData.getChip();
  }
  
  @Override protected void child_render_2(final java.io.Writer jamonWriter)
    throws java.io.IOException
  {
    // 12, 9
    jamonWriter.write("module core.neuro.");
    // 13, 19
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(chip), jamonWriter);
    // 13, 29
    jamonWriter.write(".registers;\n\ndefine AddressSpace ()() attributes {\n\n //  Register_Name                            incremental  absolute  base\n");
    // 18, 1
    for (RegisterBase base : bases )
    {
      // 18, 35
      jamonWriter.write(" int ");
      // 19, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", base.getFullName())), jamonWriter);
      // 19, 54
      jamonWriter.write(" = 0x");
      // 19, 59
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", base.getIncrementalAddress())), jamonWriter);
      // 19, 116
      jamonWriter.write("; // 0x");
      // 20, 7
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", base.getAbsoluteAddress())), jamonWriter);
      // 20, 61
      jamonWriter.write(" ");
      // 20, 62
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getParent().getFullName()), jamonWriter);
      // 20, 98
      jamonWriter.write("\n int ");
      // 21, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", base.getName() + "_SIZE")), jamonWriter);
      // 21, 60
      jamonWriter.write(" = 0x");
      // 21, 65
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", base.getSize())), jamonWriter);
      // 21, 108
      jamonWriter.write(";\n");
    }
    // 22, 8
    jamonWriter.write("\n");
    // 27, 1
    for (Register reg : regs )
    {
      // 28, 1
      String postfix = (reg.getNumEntries() > 1) ? "_BASE" : "_ADDR"; 
      // 29, 1
      String entriesPostfix = (reg.getNumEntries1() > 1) ? "_0" : ""; 
      // 29, 74
      jamonWriter.write(" int ");
      // 30, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + postfix)), jamonWriter);
      // 30, 59
      jamonWriter.write(" = 0x");
      // 31, 4
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getAddressSafe())), jamonWriter);
      // 31, 53
      jamonWriter.write("; // 0x");
      // 32, 7
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getAddressOffset())), jamonWriter);
      // 32, 58
      jamonWriter.write(" ");
      // 32, 59
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getBaseName()), jamonWriter);
      // 32, 82
      jamonWriter.write("\n");
      // 33, 1
      if (reg.getNumEntries() > 1 )
      {
        // 33, 32
        jamonWriter.write(" int ");
        // 34, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_BASE_MASK" + entriesPostfix)), jamonWriter);
        // 34, 81
        jamonWriter.write(" = 0x");
        // 35, 4
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getAddressMatchMask())), jamonWriter);
        // 35, 58
        jamonWriter.write(";\n int ");
        // 36, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_STRIDE" + entriesPostfix)), jamonWriter);
        // 36, 78
        jamonWriter.write(" = 0x");
        // 37, 4
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getEntrySpace())), jamonWriter);
        // 37, 52
        jamonWriter.write(";\n");
      }
      // 39, 1
      if (reg.getNumEntries1() > 1 )
      {
        // 39, 33
        jamonWriter.write(" int ");
        // 40, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_STRIDE_1")), jamonWriter);
        // 40, 63
        jamonWriter.write(" = 0x");
        // 41, 4
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getEntrySpace1())), jamonWriter);
        // 41, 53
        jamonWriter.write(";\n");
      }
      // 43, 1
      if (reg.getNumEntries2() > 1 )
      {
        // 43, 33
        jamonWriter.write(" int ");
        // 44, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_STRIDE_2")), jamonWriter);
        // 44, 63
        jamonWriter.write(" = 0x");
        // 45, 4
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%05X", reg.getEntrySpace2())), jamonWriter);
        // 45, 53
        jamonWriter.write(";\n");
      }
      // 46, 7
      jamonWriter.write(" int ");
      // 47, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_BITS")), jamonWriter);
      // 47, 59
      jamonWriter.write(" = ");
      // 47, 62
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumberFieldBits()), jamonWriter);
      // 47, 92
      jamonWriter.write(";\n int ");
      // 48, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_IMPL_BITS")), jamonWriter);
      // 48, 64
      jamonWriter.write(" = ");
      // 48, 67
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getImplementationWidth()), jamonWriter);
      // 48, 101
      jamonWriter.write(";\n int ");
      // 49, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_SRAM_BITS")), jamonWriter);
      // 49, 64
      jamonWriter.write(" = ");
      // 49, 67
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getSramWidth()), jamonWriter);
      // 49, 91
      jamonWriter.write(";\n int ");
      // 50, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_WIDTH")), jamonWriter);
      // 50, 60
      jamonWriter.write(" = ");
      // 50, 63
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getEntryWidth()), jamonWriter);
      // 50, 88
      jamonWriter.write(";\n int ");
      // 51, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_ATOMIC_WIDTH")), jamonWriter);
      // 51, 67
      jamonWriter.write(" = ");
      // 51, 70
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getAtomicWidth()), jamonWriter);
      // 51, 96
      jamonWriter.write(";\n");
      // 54, 1
      if (reg.getNumDefaults() == 1 )
      {
        // 54, 34
        jamonWriter.write(" int ");
        // 55, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_DEFAULT")), jamonWriter);
        // 55, 62
        jamonWriter.write(" = 0x");
        // 55, 67
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%x", reg.getDefault(0))), jamonWriter);
        // 55, 111
        jamonWriter.write(";\n");
      }
      // 56, 1
      else
      {
        // 56, 8
        jamonWriter.write(" int ");
        // 57, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
        // 57, 25
        jamonWriter.write("_DEFAULT[0..");
        // 57, 37
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumDefaults()-1), jamonWriter);
        // 57, 65
        jamonWriter.write("];\n");
        // 58, 1
        for (int i = 0; i < reg.getNumDefaults(); i++ )
        {
          // 58, 50
          jamonWriter.write("     ");
          // 59, 6
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_DEFAULT[" + i + "]")), jamonWriter);
          // 59, 73
          jamonWriter.write(" = 0x");
          // 59, 78
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%x", reg.getDefault(i))), jamonWriter);
          // 59, 122
          jamonWriter.write(";\n");
        }
      }
      // 64, 1
      if (reg.getNumEntries() > 1 )
      {
        // 64, 32
        jamonWriter.write(" int ");
        // 65, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_ENTRIES" + entriesPostfix)), jamonWriter);
        // 65, 79
        jamonWriter.write(" = ");
        // 65, 82
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries()), jamonWriter);
        // 65, 107
        jamonWriter.write(";\n");
      }
      // 67, 1
      if (reg.getNumEntries1() > 1 )
      {
        // 67, 33
        jamonWriter.write(" int ");
        // 68, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_ENTRIES_1")), jamonWriter);
        // 68, 64
        jamonWriter.write(" = ");
        // 68, 67
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries1()), jamonWriter);
        // 68, 93
        jamonWriter.write(";\n");
      }
      // 70, 1
      if (reg.getNumEntries2() > 1 )
      {
        // 70, 33
        jamonWriter.write(" int ");
        // 71, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_ENTRIES_2")), jamonWriter);
        // 71, 64
        jamonWriter.write(" = ");
        // 71, 67
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getNumEntries2()), jamonWriter);
        // 71, 93
        jamonWriter.write(";\n");
      }
      // 72, 7
      jamonWriter.write(" int ");
      // 74, 6
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_STRUCT_ID")), jamonWriter);
      // 74, 64
      jamonWriter.write(" = ");
      // 74, 67
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getStructId()), jamonWriter);
      // 74, 90
      jamonWriter.write(";\n");
    }
    // 75, 8
    jamonWriter.write("\n}\n\n");
    // 82, 1
    for (RegisterBase base : bases )
    {
      // 82, 35
      jamonWriter.write("\n");
      // 83, 1
      String camelCaseBaseName = Utility.underscoreToCamelCase(base.getName(), true); 
      // 84, 1
      jamonWriter.write("define ");
      // 84, 8
      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
      // 84, 31
      jamonWriter.write("RegisterFields ()() attributes {\n\n");
      // 86, 1
      for (Register reg : base.getRegisters() )
      {
        // 87, 1
        for (RegisterField field : reg.fields.values() )
        {
          // 88, 1
          if (field.len == 1 )
          {
            // 88, 23
            jamonWriter.write("  int ");
            // 89, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_b_" + field.desc)), jamonWriter);
            // 89, 71
            jamonWriter.write(" = ");
            // 89, 74
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.pos), jamonWriter);
            // 89, 89
            jamonWriter.write(";\n");
          }
          // 90, 1
          else
          {
            // 90, 8
            jamonWriter.write("  int ");
            // 91, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_l_" + field.desc)), jamonWriter);
            // 91, 71
            jamonWriter.write(" = ");
            // 91, 74
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.pos), jamonWriter);
            // 91, 89
            jamonWriter.write(";\n  int ");
            // 92, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_h_" + field.desc)), jamonWriter);
            // 92, 71
            jamonWriter.write(" = ");
            // 92, 74
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.pos + field.len - 1), jamonWriter);
            // 92, 105
            jamonWriter.write(";\n  int ");
            // 93, 7
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_w_" + field.desc)), jamonWriter);
            // 93, 71
            jamonWriter.write(" = ");
            // 93, 74
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.len), jamonWriter);
            // 93, 89
            jamonWriter.write(";\n");
          }
          // 96, 1
          if (field.typedef != null && !base.getEnums().contains(field.typedef) && (field.currentEntry == field.baseEntry) )
          {
            // 96, 117
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.typedef.toCast()), jamonWriter);
          }
        }
        // 97, 8
        jamonWriter.write("  int ");
        // 98, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_RW_MASK")), jamonWriter);
        // 98, 63
        jamonWriter.write(" = 0x");
        // 98, 68
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getTypeMask(RegisterType.RW).toHexString()), jamonWriter);
        // 98, 120
        jamonWriter.write(";\n  int ");
        // 99, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_RO_MASK")), jamonWriter);
        // 99, 63
        jamonWriter.write(" = 0x");
        // 99, 68
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getTypeMask(RegisterType.RO).toHexString()), jamonWriter);
        // 99, 120
        jamonWriter.write(";\n  int ");
        // 100, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_CW_MASK")), jamonWriter);
        // 100, 63
        jamonWriter.write(" = 0x");
        // 100, 68
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getTypeMask(RegisterType.CW).toHexString()), jamonWriter);
        // 100, 120
        jamonWriter.write(";\n  int ");
        // 101, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_CW1_MASK")), jamonWriter);
        // 101, 64
        jamonWriter.write(" = 0x");
        // 101, 69
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getTypeMask(RegisterType.CW1).toHexString()), jamonWriter);
        // 101, 122
        jamonWriter.write(";\n  int ");
        // 102, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_WO_MASK")), jamonWriter);
        // 102, 63
        jamonWriter.write(" = 0x");
        // 102, 68
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getTypeMask(RegisterType.WO).toHexString()), jamonWriter);
        // 102, 120
        jamonWriter.write(";\n  int ");
        // 103, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(String.format("%-40s", reg.getName() + "_RV_MASK")), jamonWriter);
        // 103, 63
        jamonWriter.write(" = 0x");
        // 103, 68
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getUnusedOrReservedMask().toHexString()), jamonWriter);
        // 103, 117
        jamonWriter.write(";\n");
      }
      // 106, 1
      for (ConstantsEnum e : base.getEnums() )
      {
        // 106, 43
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(e.toCast()), jamonWriter);
      }
      // 106, 66
      jamonWriter.write("\n  csp {\n");
      // 110, 1
      for (RegisterStruct rs : base.getStructs() )
      {
        // 111, 1
        {
          // 111, 1
          __jamon_innerUnit__structure(jamonWriter, rs );
        }
        // 111, 23
        jamonWriter.write("\n");
      }
      // 113, 1
      for (Register reg : base.getRegisters() )
      {
        // 114, 1
        {
          // 114, 1
          __jamon_innerUnit__structure(jamonWriter, reg );
        }
      }
      // 115, 8
      jamonWriter.write("  }\n}\n");
    }
    // 118, 8
    jamonWriter.write("\n\n\n");
    // 140, 1
    for (RegisterBase base : bases )
    {
      // 140, 35
      jamonWriter.write("\n");
      // 141, 1
      for (String group : base.getGroups() )
      {
        // 141, 41
        jamonWriter.write("\n");
        // 142, 1
        
String baseName = base.getName(); if(group != null) baseName += "_" + group.toUpperCase();
String camelCaseBaseName = Utility.underscoreToCamelCase(baseName, true);
int maxAtomicWidth = 1; for(Register reg : base.getRegisters()) {maxAtomicWidth=Math.max(maxAtomicWidth,reg.getAtomicWidth());}
Collection<Register> registers = base.getRegisters("group", group);
int maxSramBits = 1; for(Register reg : registers) {maxSramBits=Math.max(maxSramBits,reg.getImplementationWidth());}
int mgmtDataBits = (group == null) ? 32*maxAtomicWidth : maxSramBits;

        // 149, 9
        jamonWriter.write("define ");
        // 150, 8
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 150, 31
        jamonWriter.write("Management() attributes\n  <+ ");
        // 151, 6
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName(), true)), jamonWriter);
        // 151, 63
        jamonWriter.write("RegisterFields\n");
        // 152, 1
        if (group == null )
        {
          // 152, 22
          for (String g : base.getGroups() )
          {
            // 152, 58
            if (g != null )
            {
              // 152, 75
              jamonWriter.write("  <+ ");
              // 153, 6
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 153, 87
              jamonWriter.write("Management\n");
            }
          }
        }
        // 154, 20
        jamonWriter.write("  <+ AddressSpace \n  <+ core.neuro.v2.register_functions.RegisterFunctions {\n  int ");
        // 157, 7
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(baseName), jamonWriter);
        // 157, 21
        jamonWriter.write("_MGMT_BITS = ");
        // 157, 34
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(mgmtDataBits), jamonWriter);
        // 157, 52
        jamonWriter.write(";\n  csp {\n");
        // 160, 1
        {
          // 160, 1
          __jamon_innerUnit__registerStructureBase(jamonWriter, registers, camelCaseBaseName );
        }
        // 160, 86
        jamonWriter.write("\n");
        // 161, 1
        if (group == null )
        {
          // 161, 22
          for (String g : base.getGroups() )
          {
            // 161, 58
            if (g != null )
            {
              // 161, 75
              jamonWriter.write("      ");
              // 162, 7
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(base.getName() + "_" + g.toUpperCase(), true)), jamonWriter);
              // 162, 88
              jamonWriter.write("Registers ");
              // 162, 98
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(g.toLowerCase()), jamonWriter);
              // 162, 119
              jamonWriter.write(";\n");
            }
          }
        }
        // 163, 20
        jamonWriter.write("    );\n\n");
        // 168, 1
        {
          com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam __jamon__var_0 = new com.fulcrummicro.hw.verification.chip.mgmt.registers.templates.CastMgmtTcam(this.getTemplateManager());
          __jamon__var_0.renderNoFlush(jamonWriter, base, registers, camelCaseBaseName );
        }
        // 168, 91
        jamonWriter.write("\n\n");
        // 172, 1
        for (Register reg : registers )
        {
          // 172, 34
          if (reg.getAlias() == null )
          {
            // 172, 64
            jamonWriter.write("    function addressIs");
            // 173, 23
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 173, 79
            jamonWriter.write("(int(16) -chip_addr) : boolean = (\n      addressIs");
            // 174, 16
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(reg.getName(), true)), jamonWriter);
            // 174, 72
            jamonWriter.write(" = ");
            // 174, 75
            {
              // 174, 75
              __jamon_innerUnit__registerAddressGuardExpr(jamonWriter, reg);
            }
            // 174, 115
            jamonWriter.write("\n    );\n");
          }
        }
        // 176, 14
        jamonWriter.write("\n    function rw");
        // 180, 16
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 180, 39
        jamonWriter.write("Registers(int(1) -rw; int -addr; int -+data;\n                               ");
        // 181, 32
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(camelCaseBaseName), jamonWriter);
        // 181, 55
        jamonWriter.write("Registers -+s) = (\n      int reg;              // packed register value\n      int(32) i, i0, i1, i2, word, offset;  // indices\n      #[regRange(addr, ");
        // 184, 24
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getFullName()), jamonWriter);
        // 184, 48
        jamonWriter.write(", ");
        // 184, 50
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(base.getName()), jamonWriter);
        // 184, 70
        jamonWriter.write("_SIZE, offset) ->\n        #[");
        // 186, 1
        boolean first = true; 
        // 187, 14
        for (Register reg : base.getRegisters() )
        {
          // 187, 57
          if (reg.getAlias() == null )
          {
            // 188, 1
            String index; 
            // 189, 1
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(first ? "" : "        []"), jamonWriter);
            // 189, 32
            first=false; 
            // 190, 18
            if (reg.getNumEntries() == 1 )
            {
              // 190, 75
              jamonWriter.write("addrMatch(offset,\n              ");
              // 192, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 192, 34
              jamonWriter.write("_ADDR,\n              ");
              // 193, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 193, 34
              jamonWriter.write("_BITS,\n              word) ->\n");
              // 195, 1
              index = ""; 
            }
            // 196, 18
            else if (reg.getNumEntries1() == 1 )
            {
              // 196, 55
              jamonWriter.write("addrMatch1D(offset,\n              ");
              // 198, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 198, 34
              jamonWriter.write("_BASE,\n              ");
              // 199, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 199, 34
              jamonWriter.write("_ENTRIES,\n              ");
              // 200, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 200, 34
              jamonWriter.write("_STRIDE,\n              ");
              // 201, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 201, 34
              jamonWriter.write("_BITS,\n              i, word) ->\n");
              // 203, 1
              index = "[i]"; 
            }
            // 204, 18
            else if (reg.getNumEntries2() == 1 )
            {
              // 204, 55
              jamonWriter.write("addrMatch2D(offset,\n              ");
              // 206, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 206, 34
              jamonWriter.write("_BASE,\n              ");
              // 207, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 207, 34
              jamonWriter.write("_ENTRIES_0,\n              ");
              // 208, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 208, 34
              jamonWriter.write("_ENTRIES_1,\n              ");
              // 209, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 209, 34
              jamonWriter.write("_STRIDE_0,\n              ");
              // 210, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 210, 34
              jamonWriter.write("_STRIDE_1,\n              ");
              // 211, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 211, 34
              jamonWriter.write("_BITS,\n              i0, i1, word) ->\n");
              // 213, 1
              index = "[i1, i0]"; 
            }
            // 214, 18
            else
            {
              // 214, 25
              jamonWriter.write("addrMatch3D(offset,\n              ");
              // 216, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 216, 34
              jamonWriter.write("_BASE,\n              ");
              // 217, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 217, 34
              jamonWriter.write("_ENTRIES_0,\n              ");
              // 218, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 218, 34
              jamonWriter.write("_ENTRIES_1,\n              ");
              // 219, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 219, 34
              jamonWriter.write("_ENTRIES_2,\n              ");
              // 220, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 220, 34
              jamonWriter.write("_STRIDE_0,\n              ");
              // 221, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 221, 34
              jamonWriter.write("_STRIDE_1,\n              ");
              // 222, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 222, 34
              jamonWriter.write("_STRIDE_2,\n              ");
              // 223, 15
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
              // 223, 34
              jamonWriter.write("_BITS,\n              i0, i1, i2, word) ->\n");
              // 225, 1
              index = "[i2, i1, i0]"; 
            }
            // 228, 18
            if (reg.isStructure() )
            {
              // 228, 43
              jamonWriter.write("            reg = pack(s::");
              // 229, 27
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
              // 229, 60
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
              // 229, 71
              jamonWriter.write(");\n");
            }
            // 230, 24
            jamonWriter.write("            regReadWrite(rw, word,\n              ");
            // 232, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 232, 34
            jamonWriter.write("_ATOMIC_WIDTH,\n              ");
            // 233, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 233, 34
            jamonWriter.write("_RW_MASK | ");
            // 233, 45
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 233, 64
            jamonWriter.write("_RV_MASK,\n              ");
            // 234, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 234, 34
            jamonWriter.write("_RO_MASK,\n              ");
            // 235, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 235, 34
            jamonWriter.write("_CW_MASK,\n              ");
            // 236, 15
            org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName()), jamonWriter);
            // 236, 34
            jamonWriter.write("_CW1_MASK,\n              data, ");
            // 237, 21
            if (reg.isStructure() )
            {
              // 237, 46
              jamonWriter.write("reg");
            }
            // 237, 49
            else
            {
              // 237, 56
              jamonWriter.write("s::");
              // 237, 59
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
              // 237, 92
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
            }
            // 237, 109
            jamonWriter.write(");\n");
            // 238, 18
            if (reg.isStructure() )
            {
              // 238, 43
              jamonWriter.write("            unpack(s::");
              // 239, 23
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(reg.getName().toLowerCase()), jamonWriter);
              // 239, 56
              org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(index), jamonWriter);
              // 239, 67
              jamonWriter.write(", reg)\n");
            }
          }
        }
        // 241, 27
        jamonWriter.write("        ]\n      ]\n    );\n\n");
        // 247, 1
        {
          // 247, 1
          __jamon_innerUnit__registerInit(jamonWriter, registers, camelCaseBaseName );
        }
        // 247, 77
        jamonWriter.write("\n  }\n}\n");
      }
    }
    // 252, 8
    jamonWriter.write("\n");
  }
  
  
  // 120, 1
  private void __jamon_innerUnit__structure(final java.io.Writer jamonWriter, final RegisterStruct rs)
    throws java.io.IOException
  {
    // 121, 34
    jamonWriter.write("    structure Reg");
    // 122, 18
    org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(Utility.underscoreToCamelCase(rs.getName(), true)), jamonWriter);
    // 122, 73
    jamonWriter.write(" = (\n");
    // 123, 1
    if (rs.getSortedFields() != null )
    {
      // 124, 1
      if ((rs instanceof Register) && ( ((Register)rs).getImplementationWidth() > ((Register)rs).getNumberFieldBits() ) )
      {
        // 124, 118
        jamonWriter.write("      int(");
        // 125, 11
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(((Register)rs).getImplementationWidth() - ((Register)rs).getNumberFieldBits()), jamonWriter);
        // 125, 94
        jamonWriter.write(") RESERVED_IMPLEMENTATION_BITS;\n");
      }
      // 127, 1
      for (RegisterField field : rs.getSortedFields(true) )
      {
        // 127, 56
        jamonWriter.write("      int(");
        // 128, 11
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.len), jamonWriter);
        // 128, 26
        jamonWriter.write(") ");
        // 128, 28
        org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.desc), jamonWriter);
        // 128, 44
        if (field.entries>1 )
        {
          // 128, 67
          jamonWriter.write("[");
          // 128, 68
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.baseEntry), jamonWriter);
          // 128, 89
          jamonWriter.write("..");
          // 128, 91
          org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(field.entries-1), jamonWriter);
          // 128, 112
          jamonWriter.write("]");
        }
        // 128, 119
        jamonWriter.write(";\n");
      }
    }
    // 130, 1
    else
    {
      // 130, 8
      jamonWriter.write("      // ERROR: field overlap\n");
    }
    // 132, 7
    jamonWriter.write("    );\n");
  }
  
  
}

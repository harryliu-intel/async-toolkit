
RELEASE PROCEDURE FOR CELLS FOR FWR AND OTHER BLOCKSCALE PROGRAMS
=================================================================

February 20, 2024

The release procedure has to satisify the requirements of many bosses.
You must do exactly as written here unless it's been discussed in and
approved by an appropriate characterization forum.

Goals
=====

1. Minimize risk for errors

2. Make it possible to see at a glance what releases are available

3. Minimize disk space

4. Have a quick and easy release process

5. No references to "obscure" paths (e.g., links into personal accounts)

6. All releases to have a RELEASE_NOTES file in their top directory

This procedure is defined as of 2/20/2024 and is to be used until further notice.

The following principles are to be adhered to.

1. *All* releases are to be visible from the central release directory

CHAR_RELEASE_DIR=
/nfs/site/disks/zsc9_fwr_lib_char_001/release

2. It is OK to copy small releases into this area (such as for custom
cells), but larger releases (e.g., releases of the full FWR libs) must
be linked using symbolic links

3. Releases are to be numbered with a 3-digit decimal serial number
starting from 000, incrementing consecutively, and have a descriptive
name appended after a dot ".", for example:

035.fwr_tc2_all_cells_0p9u2_2024ww07.6

4. The internal structure of a release is to be as follows:

<release>/
    bundles/
       <bundle_name>/
           cdl
           gds
           lef
           lib
           ndm
           oas

5. Any or all of the paths in a release may be symbolic links


Types of releases
=================

There are two kinds of releases, characterization directories and merged
directories.  The former is the output of a characterization flow (custom or
recharacterization); the latter is the result of merging two characterization
releases.

How to make a characterization release
======================================

0. Make sure you have an existing and successful characterization run
available, with all the resulting collaterals resident in the appropriate
RECHAR_SIS_WORKDIR (siliconsmart.*).

1. Choose a new name in the CHAR_RELEASE_DIR following the rules laid out
above.  For example, if the last release was 032.<something>, the new release
will be called 033.<something>, e.g.,

033.fwr_tc2_0p9u2_2024ww07.6

2. Create a directory in the release area ON THE DISK WHERE THE
CHARACTERIZATION WAS PERFORMED with this name.

For example:

mkdir /nfs/site/disks/zsc9_fwr_lib_char_008/release/033.fwr_tc2_0p9u2_2024ww07.6

(If running characterization on another disk, e.g., char_006, make the appropriate
change to the path so that you are moving the bundles within the same physical
disk.)

3. Move the "bundles" from the characterization flow into this directory,
using mv.  DO NOT USE "cp"!

The end result of this is that THE ACTUAL DATA resides in a char_00*/release area, 
NOT in a personal directory.  The procedure also enables this to be achieved without
copying the data across disks, instead simply using a "mv" command.

For example:

mv /nfs/site/disks/zsc9_fwr_lib_char_008/mnystroe/rechar.8/siliconsmart.tc2/bundles /nfs/site/disks/zsc9_fwr_lib_char_008/release/033.fwr_tc2_0p9u2_2024ww07.6

4. Create the RELEASE_NOTES in the release directory on the char disk:

vi /nfs/site/disks/zsc9_fwr_lib_char_008/release/033.fwr_tc2_0p9u2_2024ww07.6/RELEASE_NOTES

Include notes on PDK, UPF, and source of standard cells used.

5. Link the release into the main release directory:

ln -sf /nfs/site/disks/zsc9_fwr_lib_char_008/release/033.fwr_tc2_0p9u2_2024ww07.6 /nfs/site/disks/zsc9_fwr_lib_char_001/release

6. Send an appropriate email or other announcement as required.  In
this announcement, ONLY reference the release by its well-known name:

/nfs/site/disks/zsc9_fwr_lib_char_001/release/033.fwr_tc2_0p9u2_2024ww07.6

DO NOT REFERENCE OTHER DISKS IN RELEASE ANNOUNCEMENTS.


How to make a merged release
============================

DO NOT MIX MERGING AND CHARACTERIZATION.  ALWAYS MERGE ONLY EXISTING RELEASES!

This means that if you have an existing release, e.g.,

033.fwr_tc2_0p9u2_2024ww07.6

which contains characterization results for a number of standard cells,
and you wish to add characterization results for custom cells to this, then

1. FIRST create a new release for the custom cells

For example:

034.tc2_custom_cells_0p9u2_2024ww08.2

2. SECONDLY create a new release for the merged release

For example:

035.fwr_tc2_all_cells_0p9u2_2024ww07.6

3. THIRDLY create the RELEASE_NOTES file

Explain which characterization releases are being linked together in
this file.

4. LASTLY link the appropriate files into the new merged area.  Use "ln -s"
or "ln -sf" to make the links.

The directory structure might then look like this:

035.fwr_tc2_all_cells_0p9u2_2024ww07.6/
   RELEASE_NOTES
   bundles/
      base_ulvt  -> ${CHAR_RELEASE_DIR}/033.fwr_tc2_0p9u2_2024ww07.6/bundles/base_ulvt
      base_lvt   -> ${CHAR_RELEASE_DIR}/033.fwr_tc2_0p9u2_2024ww07.6/bundles/base_lvt
      [etc.]
      fwr_custom -> ${CHAR_RELEASE_DIR}/034.tc2_custom_cells_0p9u2_2024ww08.2/bundles/fwr_custom

5. Even more LASTLY, check permissions on the released area.  A "sane" set of permissions is (octal) 2770:

scef393112> ls -ld .
drwxrws--- 51 mnystroe i1278 20480 Mar 24 16:34 .
scef393112> 

One way of accomplishing this is by running

find . -type d -exec chmod 2770 {} \; 

from the top-level of the release.

How to make changes to the release procedure
============================================

Call a meeting with all concerned parties, including the entire
characterization team.  Include Intel Labs as well as a representative
from the SD team, at minimum.  Discuss the changes, update this file,
and check it in to the rechar repository.
